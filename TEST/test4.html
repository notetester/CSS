<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="css/megabox.min.css">
    <script src="js/hmac-sha256.js"></script>
    <script src="js/enc-base64-min.js"></script>
    <script type="text/javascript">
        /*전역변수
        아이디
        패스워드  입력 완료 체크 변수 필요
        */
        var sValidateLoginIdAt = 'N';	//로그인ID  입력 검증 여부
        var sValidateLoginPwdAt = 'N';	//로그인PWD 입력 검증 여부
        var submitIng = false;
        var sCookieVal = "";	//쿠키값
        /*
        window.fbAsyncInit = function() {
            FB.init({
                appId            : '',
                  autoLogAppEvents : true,
                  xfbml            : true,
                  version          : ''
           });
        };
        
        var naverLogin = new naver.LoginWithNaverId({
            clientId: '',
            callbackUrl: location.href,
            isPopup: false,
            callbackHandle: false
            // callback 페이지가 분리되었을 경우에 callback 페이지에서는 callback처리를 해줄수 있도록 설정합니다.
        });
        */

        $(function () {
            /*로그인 버튼 비활성*/
            $("#btnLogin").attr("disabled", true);

            /*쿠키조회 pc 아이디값 입력 및 자동로그인 체크*/
            sCookieVal = fn_getCookie('loginId');
            if (!(sCookieVal == null || sCookieVal == "")) {
                $("#ibxLoginId").val(sCookieVal);
                $("input:checkbox[id='chkIdSave']").prop("checked", true);
                fn_validateInputVal("loginId", sCookieVal);
            }

            /*이벤트*/
            /*로그인*/
            $("#btnLogin").click(function () {
                var sLoginId = $("#ibxLoginId").val();
                var sLloginPwd = $("#ibxLoginPwd").val();

                // 		//아이디 생성규칙 확인
                // 		if(!fn_validateInputVal("loginId" ,$("#ibxLoginId").val(), 'Y')) {
                // 			$("#ibxLoginId").focus();
                // 			return;
                // 		}
                // 		//패스워드 생성규칙확인
                // 		if(!fn_validateInputVal("loginPwd",$("#ibxLoginPwd").val(), 'Y')) {
                // 			$("#ibxLoginPwd").focus();
                // 			return;
                // 		}

                $('#error-text').text('');

                //아이디 저장 버튼 체크시 쿠키 설정
                if ($("input:checkbox[id='chkIdSave']").is(":checked")) {
                    fn_setCookie('loginId', $("#ibxLoginId").val(), 730);
                }
                //아이디 저장 체크 안했을때 쿠키 삭제
                else if (!$("input:checkbox[id='chkIdSave']").is(":checked")) {
                    fn_deleteCookie('loginId');
                }

                fn_selectMbLogin(sLoginId, sLloginPwd);	//로그인
            });

            /*아이디 입력시 체크 */
            $("#ibxLoginId").on("keyup", function (e) {
                if (fn_validateInputVal("loginId", $(this).val())) {
                    if (e.keyCode == 13) { $("#btnLogin").click(); }
                } else {
                    if (e.keyCode == 13) { $("#ibxLoginPwd").focus(); }
                }

                return;
            });

            /*비밀번호 입력체크 */
            $("#ibxLoginPwd").on("keyup", function (e) {
                if (fn_validateInputVal("loginPwd", $(this).val())) {
                    if (e.keyCode == 13) { $("#btnLogin").click(); }
                }
                return;
            });


            // 페이스북 로그인
            $('.login-facebook').on('click', function (e) {
                e.preventDefault();

                var type = $(this).data('type');

                FB.login(function (response) {
                    if (response.authResponse.userID) {
                        $.ajaxMegaBox({
                            url: '/on/oh/ohg/MbLogin/selectMbSimpleLogin.rest',
                            data: JSON.stringify({ simpleLoginId: response.authResponse.userID, type: type }),
                            success: function (data) {
                                if (data.result) {
                                    AppHandler.Common.goMain();  // 메인페이지로 이동
                                } else {
                                    AppHandler.Common.alert('본 서비스는 메가박스 회원인 경우에만  이용하실 수 있습니다.\n회원가입 후 이용 부탁 드립니다.');
                                }
                            }
                        });
                    }
                });
            });
        });

        //쿠키설정
        function fn_setCookie(cname, cvalue, exdays) {
            var d = new Date();
            d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
            var expires = "expires=" + d.toUTCString();
            document.cookie = cname + "=" + cvalue + "; " + expires + ";path=/";
        }

        //쿠키조회
        function fn_getCookie(name) {
            var value = document.cookie.match('(^|;) ?' + name + '=([^;]*)(;|$)');
            return value ? value[2] : null;

        }

        //쿠키삭제
        function fn_deleteCookie(name) {
            var d = new Date();
            d.setTime(d.getDate() - 1);
            var expires = "expires=" + d.toUTCString();
            document.cookie = name + "=;" + expires + ";path=/";
        }


        //입력 문자 체크
        function fn_validateInputVal(type, sVal, submitAt) {
            if (type == "loginId") {		  //아이디

                if (sVal == "") {
                    sValidateLoginIdAt = 'N';
                }
                // 		if (!/((?=.{8,})(?=.*[0-9])(?=.*[a-zA-Z]).*$)/g.test(sVal)) {
                // 			$('#error-text').text('아이디는 영문,숫자 조합 8자리 이상 12자리 이하 입니다.');
                // 			sValidateLoginIdAt = 'N';
                // 		}
                // 		else if (/((?=.{8,})(?=.*[~!@#$%^&*+=-]).*$)/g.test(sVal)) {
                // 			$('#error-text').text('아이디는 영문,숫자 조합 8자리 이상 12자리 이하 입니다.');
                // 			sValidateLoginIdAt = 'N';
                // 		}
                else {
                    $('#error-text').text('');
                    sValidateLoginIdAt = 'Y';
                }
            }
            else if (type == "loginPwd") { //패스워드
                if (sVal == "") {
                    sValidateLoginPwdAt = 'N';
                }
                // 		if (!/((?=.{10,})(?=.*[0-9])(?=.*[a-zA-Z]).*$)|((?=.{10,})(?=.*[~!@#$%^&*+=-])(?=.*[a-zA-Z]).*$)|((?=.{10,})(?=.*[!@#$%^&*+=-])(?=.*[0-9]).*$)/g.test(sVal)) {
                // 			$('#error-text').text('비밀번호는 영문,숫자,특수기호 중 2가지 이상 조합하여 10자리 이상 16자리 이하 입니다.');
                // 			sValidateLoginPwdAt = 'N';
                // 		}
                else {
                    $('#error-text').text('');
                    sValidateLoginPwdAt = 'Y';
                }
            }

            if (submitAt != 'Y') {
                if (sValidateLoginIdAt == 'Y' && sValidateLoginPwdAt == 'Y') {
                    $("#btnLogin").attr("disabled", false);	//버튼활성화
                }
                else {
                    $("#btnLogin").attr("disabled", true);	//버튼비활성화
                }
            }

            if (sValidateLoginIdAt == 'N' || sValidateLoginPwdAt == 'N') {
                return false;
            }

            return true;
        }


        //패스워드 3개월 초과시 다음에 하기 버튼 누를경우 비밀번호 변경일자 오늘날자로 셋팅
        //비번 재설정은 3개월 미변경시, 변경 안하면 로그인 할때마다 alert 나옴 20190507
        function fn_updatePwdUptDt(sLoginId) {
            var paramData = { loginId: sLoginId };
            $.ajaxMegaBox({
                url: "/on/oh/ohg/MbLogin/updateMbPwdReSet.rest",
                type: "POST",
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                data: JSON.stringify(paramData),
                success: function (data, textStatus, jqXHR) {
                    //메인 화면으로 이동
                    $(location).attr('href', '/main');
                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(xhr.status);
                    alert(err.message);
                }
            });
        }

        //로그인
        function fn_selectMbLogin(sLoginId, sLloginPwd, snsLoginAt, redisKey) {

            if (submitIng) return;

            /* 폼데이터 초기화 */
            $('#loginForm input[name=certType]').val();								//본인인증 모듈 코드값 초기화
            var sMenuId = $('input[name=menuId]').val();							//호출화면id
            var sMappingId = $('input[name=mappingId]').val();						//리턴URL
            var sSnsLogin = typeof snsLoginAt == 'undefined' ? "N" : snsLoginAt;	//sns로그인 여부

            var validLoginId = sLoginId != null ? sLoginId.replace(/ /gi, "") : "";
            var validLoginPwd = sLloginPwd != null ? sLloginPwd.replace(/ /gi, "") : "";

            if (validLoginPwd != "simpleLogin") {
                if (validLoginId == "" || validLoginPwd == "") {
                    gfn_alertMsgBoxSize('로그인 정보를 입력해 주세요.', 400, 250);	//로그인 정보를 입력해 주세요.
                    return;
                }
            }

            var paramData = {
                loginId: sLoginId
                , loginPwd: sLloginPwd
                , menuId: sMenuId
                , mappingId: sMappingId
                , snsLogin: sSnsLogin
                , redisKey: redisKey
            };

            $.ajaxMegaBox({
                url: "/on/oh/ohg/MbLogin/selectMbLoginInfo.rest",
                data: JSON.stringify(paramData),
                //async: false,
                success: function (data, textStatus, jqXHR) {
                    var revStr = data.revStr;
                    var redisKey = data.redisKey;
                    var pwdErrCnt = data.pwdErrCnt + 1;
                    var loginPwdLstUptDt = data.loginPwdLstUptDt;
                    var pwdUptDayco = data.pwdUptDayco;
                    var menuId = data.menuId;
                    var mappingId = data.mappingId;
                    var marketRcvStr = data.marketRcvStr
                    var loginIdStar = data.loginIdStar;

                    //비밀번호 5회 오류	//본인인증 수단 선택 M-ME-DA-01
                    if (revStr == "acctLock") {
                        $('#loginForm input[name=redisKey]').attr('value', redisKey);
                        $('#loginForm input[name=certType]').attr('value', 'SCRC05');
                        var options = {};
                        options.msg = '로그인정보가 5회 이상 잘못 입력되었습니다.\n회원인증 후 새로운 비밀번호를 설정해 주세요.';	//비밀번호 5회 이상 잘못 입력되었습니다.\n본인인증 후 새로운 비밀번호를 설정해 주세요.
                        options.callback = fn_mvPage;
                        options.param = { confirm: '/on/oh/ohg/MbLogin/viewMbSimpleCertPage.rest' };	//간편인증페이지
                        options.minWidth = 400;
                        options.minHeight = 250;
                        gfn_alertMsgBox(options);
                        return;
                    }
                    //비밀번호 변경9개월 초과 //비밀번호 재설정 M-ME-FI-04	비밀번호변경 9개월 체크 하지 않음. 무조건 3개월 연장
                    // 			else if (revStr == "loginPwdUpt9mm") {
                    // 				$('input[name=loginId]').attr('value',loginId);
                    // // 				mbLayer.toggle({id:revStr, msg:'회원님의 개인정보 보호를 위해 3개월마다 비밀번호 변경 안내해드리고 있습니다.\n마지막 변경일 : '+loginPwdLstUptDt+'('+pwdUptDayco+'일전)', btn:'비밀번호 변경', callback:fn_mvPage, param:'/pw-register', minHeight:200, type:'single' });
                    // 				var options      = {};
                    // 				options.msg      = '회원님의 개인정보 보호를 위해 3개월마다 비밀번호 변경 안내해드리고 있습니다.\n마지막 변경일 : '+loginPwdLstUptDt+'('+pwdUptDayco+'일전)';
                    // 				options.okBtnTxt = "비밀번호 변경";
                    // 				options.callback = fn_mvPage;
                    // 				options.param    = {confirm:'/pw-register'};
                    // 				options.minWidth  = 400;
                    // 				options.minHeight = 250;
                    // 				gfn_alertMsgBox(options);
                    // 				return;
                    // 			}
                    //비밀번호 변경3개월 초과	//다음에하기, 비밀번호 재설정 M-ME-FI-04
                    else if (revStr == "loginPwdUpt3mm") {
                        $('#loginForm input[name=redisKey]').attr('value', redisKey);
                        var options = {};
                        options.msg = '회원님의 개인정보 보호를 위해 3개월마다 비밀번호 변경안내를 시행하고 있습니다.\n안전한 서비스 이용을 위해 비밀번호 변경 후 이용바랍니다.\n지금 변경 하시겠습니까?\n\n마지막 변경일 : ' + loginPwdLstUptDt + '(' + pwdUptDayco + '일전)';
                        options.confirmFn = fn_mvPage;
                        options.cancelFn = fn_loginSuccessEvent;
                        options.okBtnTxt = "비밀번호 재설정";
                        options.cancelBtnTxt = "다음에 하기";
                        options.minWidth = 400;
                        options.minHeight = 300;
                        options.param = { confirm: "/pw-register" };
                        gfn_confirmMsgBox(options);
                        return;
                        // 				if(confirm('회원님의 개인정보 보호를 위해 3개월마다 비밀번호 변경안내를 시행하고 있습니다.\n안전한 서비스 이용을 위해 비밀번호 변경 후 이용바랍니다.\n지금 변경 하시겠습니까?\n\n마지막 변경일 : '+loginPwdLstUptDt+'('+pwdUptDayco+'일전)')){
                        // 					$('input[name=loginId]').attr('value',loginId);
                        // 					fn_mvPage('/pw-register');
                        // 					return;
                        // 				}
                        // 				else {
                        // 					fn_mvPage("/main");	//메인페이지로 이동
                        // 					return;
                        // 				}
                    }
                    //마케팅 수신일 2년 초과	//todo 다음에하기, 수신동의 설정 내정보 수정화면 개발후연결
                    else if (revStr == "marketRcv") {
                        var options = {};
                        options.msg = '마케팅 수신 동의일로부터 2년이 경과되어, 수신에 대한 재동의 안내를 시행하고 있습니다. \n메가박스의 다양한 소식 및 이벤트를 받고 싶으시면 수신동의 재설정이 필요합니다.  \n수신동의 재설정을 진행 하시겠습니까?\n\n[수신동의 정보]\n' + marketRcvStr + '';
                        //options.msg        = '마케팅 수신 동의일로부터 2년이 경과되어, 수신에 대한 재동의 안내를 시행하고 있습니다. \n메가박스의 다양한 소식 및 이벤트를 받고 싶으시면 수신동의 재설정이 필요합니다.  \n수신동의 재설정을 진행 하시겠습니까?\n\n[수신동의 정보]\n&#39;+lstSmsRcvAgreeDt+&#39;'.replaceAll('\n','<br/>');
                        options.confirmFn = fn_mvPage;
                        options.cancelFn = fn_loginSuccessEvent;
                        options.okBtnTxt = "수신동의 설정";
                        options.cancelBtnTxt = "다음에 하기";
                        options.param = { confirm: "/on/oh/ohh/Mypage/userAdditInfoPage.do?marketRcvReAgree=Y" };
                        options.minWidth = 400;
                        options.minHeight = 300;
                        gfn_confirmMsgBox(options);
                        return;
                    }
                    //관리자에의한 패스워드 초기화 //비밀번호 재설정 M-ME-FI-04	관리자에 의한 패스워드 초기화는 없다.
                    // 			else if (revStr == "loginPwdReset") {
                    // // 				mbLayer.toggle({id:revStr, msg:'비밀번호 재설정이 완료되었습니다. 다시 로그인해 주시기 바랍니다.', btn:'확인', callback:fn_mvPage, param:'/pw-register', minHeight:200, type:'single' });
                    // 				var options = {};
                    // 				options.msg = '비밀번호 재설정이 완료되었습니다. 다시 로그인해 주시기 바랍니다.';
                    // 				options.callback  = fn_mvPage;
                    // 				options.param = {confirm:'/pw-register'};
                    // 				options.minWidth  = 400;
                    // 				options.minHeight = 250;
                    // 				gfn_alertMsgBox(options);
                    // 				return;
                    // 			}
                    //휴면계정복구 안내	//TODO 다음에하기, 휴면계정복구 본인인증 수단 선택 M-ME-DA-01
                    else if (revStr == "mbSchIdGuideDormAcct") {
                        $('#loginForm input[name=certType]').attr('value', 'SCRC03');
                        $('#loginForm input[name=redisKey]').attr('value', redisKey);
                        var options = {};
                        options.msg = '회원님의 아이디는 [' + loginIdStar + '] 메가박스 온라인 서비스를 1년이상 이용하지 않아 휴면계정으로 전환되었습니다. 휴면계정 복구 후 서비스 이용이 가능합니다.\n휴면계정 복구를 진행하시겠습니까?';
                        options.okBtnTxt = "휴면계정복구";
                        options.callback = fn_mvPage;
                        options.param = { confirm: "/member-check" };
                        options.minWidth = 400;
                        options.minHeight = 300;
                        gfn_alertMsgBox(options);
                        return;
                    }
                    //탈퇴회원안내
                    else if (revStr == "quitMb") {
                        gfn_alertMsgBoxSize('회원탈퇴 후 1개월 이내 재가입할 수 없습니다.\n메가박스 고객센터로 문의해 주세요', 400, 250);	//회원탈퇴 후 1개월 이내 재가입할 수 없습니다. 메가박스 고객센터로 문의해 주세요
                        return;
                    }
                    //loginPwdFail 패스워드실패안내, mbJoinReq 회원가입안내, mbInfoSearchUnable 탈퇴회원안내
                    else if (revStr == "loginPwdFail" || revStr == "mbJoinReq" || revStr == "mbInfoSearchUnable") {
                        // 				$('.alert').text('로그인 정보가 잘못되었습니다. (로그인 '+pwdErrCnt+'/5회 실패)');	2020-02-06 메가박스 차세대 이행/안정화 결함대장 28번
                        $("#ibxLoginId").val("");
                        $("#ibxLoginPwd").val("");
                        gfn_alertMsgBoxSize('아이디 또는 비밀번호가 맞지 않습니다.\n로그인 정보를 다시 확인바랍니다.', 400, 250);	//msg.ch.ohg.ME031=아이디 또는 비밀번호가 맞지 않습니다.\\n로그인 정보를 다시 확인바랍니다.
                        $("#btnLogin").attr("disabled", true);	//버튼비활성화
                        sValidateLoginPwdAt = 'N';
                        return;
                    }

                    if (typeof loginPopupCallScn === "undefined") {
                        loginPopupCallScn = "";
                    }
                    // 		    console.log("this : "+loginPopupCallScn);
                    //화면이동
                    if (menuId != "" && menuId != null) {  //화면으로 띄웠을떄
                        fn_mvPage(mappingId);
                        return;
                    }
                    else {

                        fn_loginSuccessEvent();

                    }
                    return;
                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(xhr.status);
                    alert(err.message);
                },
                beforeSend: function () {
                    submitIng = true;
                },
                complete: function () {
                    submitIng = false;
                }
            });

            function fn_loginSuccessEvent() {

                var bokdLoginAt = $('#loginForm input[name=bokdLoginAt]').val();
                var reloadYn = $('#loginForm input[name=reloadYn]').val();
                var validDataRevisnYn = $('#loginForm input[name=validDataRevisnYn]').val();				//데이터 보정 여부

                if (bokdLoginAt == "Y") {
                    //예매로그인일경우
                    //오입력값을 체크한다.
                    $('.before').hide();
                    $('.after').show();
                    $('.after .notice').show();
                    $('#layer_login_select button.btn-modal-close').trigger("click");
                    fn_validDataRevisn(JSON.parse($('#loginForm input[name=bokdLoginParam]').val()));
                }
                else {
                    if (reloadYn == "N") {

                        $('.before').hide();
                        $('.after').show();
                        $('.after .notice').show();
                        $('#layer_login_select button.btn-modal-close').trigger("click");
                        if (validDataRevisnYn == "Y") {
                            fn_validDataRevisn();
                        }
                    } else {

                        //화면 리로드
                        //location.reload();
                        //post submit시 브라우저 경고창 관련
                        window.document.location.href = window.document.URL;


                        ////////////////////////////////////////////
                        // TODO 빵원쿠폰일 경우에만 처리되도록 수정 //
                        ////////////////////////////////////////////
                        $(".btn-modal-close").click();
                        ////////////////////////////////////////////
                        ////////////////////////////////////////////
                    }
                }
            }

            //페이지 이동 submit
            function fn_mvPage(page) {
                // 		console.log("MbLoginScriptDV.fn_mvPage : "+page);

                var rtnParam = $("#loginForm [name=rtnParam]").val();

                if (rtnParam.trim() != "") {

                    var arr;
                    var html = '<input type="hidden" name="#1" value="#2" />';

                    $.each(rtnParam.split(','), function (i, val) {

                        arr = val.split(':');
                        arr[0] = arr[0].trim();
                        arr[1] = arr[1].trim();
                        arr[2] = '[name=' + arr[0] + ']';

                        if ($("#loginForm").find(arr[2]).length > 0) {
                            $("#loginForm").find(arr[2]).val(arr[1]);
                        } else {
                            $("#loginForm").append(html.replace('#1', arr[0]).replace('#2', arr[1]));
                        }
                    });
                }

                $("#loginForm").attr("method", "post");
                $("#loginForm").attr("action", page);
                $("#loginForm input[name=preUrl]").val(document.location.pathname)
                $("#loginForm").submit();
            }
        }
        /* 비회원 */
        var sValidateNonMbNmAt = "N";
        var sValidateNonMbByymmddAt = "N";
        var sValidateNonMbTelnoAt = "N";

        var sValidateMblpCharCertNo = "N";

        var sValidateNonMbPwdAt = "N";
        var sValidateNonMbPwdConfirmAt = "N";
        var sValidateNonMbPwdEqualAt = "N";
        var sValidateNonMbBokdPersonInfoProc = "N";
        var sValidateMblpCertNoSuccess = "N";

        var AuthTimer;
        var bokdCnfmAt = "N";

        //이벤트
        $(function () {
            if (typeof $("#ibxNonMbPwdConfirm").val() == 'undefined') {
                bokdCnfmAt = "Y";
            }
            fn_validateNonMbInputVal();
            /*비회원 로그인 버튼 비활성화*/
            $("#btnMbLogin").attr("disabled", true);

            /*비회원 정보 확인 버튼 비활성화*/
            $("#btnChkNonMbLogin").attr("disabled", true);
            $("#btnNonMbLogin").attr("disabled", true);

            /* 이름 숫자를 제외한 입력 여부판단 */
            $("#ibxNonMbNm").on("keyup", function (e) {
                var partton = /[^ㄱ-힣a-zA-Z]/g;
                if (partton.test($(this).val())) {
                    var value = $(this).val().replace(/[^ㄱ-힣a-zA-Z]/g, "");
                    $(this).val(value);
                }
                if (fn_validateNonMbInputVal()) {
                    if (e.keyCode == 13) { $("#btnChkNonMbLogin").click(); }
                } else {
                    if (e.keyCode == 13) { $("#ibxNonMbByymmdd").focus() };
                }
            });
            $("#ibxNonMbNm").focusout(function () {
                var partton = /[^ㄱ-힣a-zA-Z]/g;
                if (partton.test($(this).val())) {
                    var value = $(this).val().replace(/[^ㄱ-힣a-zA-Z]/g, "");
                    $(this).val(value);
                }
                fn_validateNonMbInputVal();
            });

            /* 생년월일 숫자만 입력 여부판단 */
            $("#ibxNonMbByymmdd").on("keyup", function (e) {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));
                if (fn_validateNonMbInputVal()) {
                    if (e.keyCode == 13) { $("#btnChkNonMbLogin").click(); }
                } else {
                    if (e.keyCode == 13) { $("#ibxNonMbTelno").focus(); }
                }
            });
            $("#ibxNonMbByymmdd").focusout(function () {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));
                fn_validateNonMbInputVal();
            });

            /* 휴대폰번호 숫자만 입력 여부판단 */
            $("#ibxNonMbTelno").on("keyup", function (e) {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));

                //휴대폰 번호
                if ($("#ibxNonMbTelno").val() != "") {
                    var frontNm = $("#ibxNonMbTelno").val().substr(0, 2);
                    if (frontNm != '01') {
                        $('#mblpInput-error-text').text('휴대폰번호를 정확히 입력해주세요.');
                        ibxNonMbTelno = 'N';
                        return false;
                    }
                    else if ($("#ibxNonMbTelno").val().length < 10) {
                        $('#mblpInput-error-text').text('휴대폰번호를 정확히 입력해주세요.');
                        sValidateNonMbTelnoAt = 'N';
                        return false;
                    }
                    else {
                        sValidateNonMbTelnoAt = 'Y';
                        $('#mblpInput-error-text').text('');
                    }
                }
                else {
                    sValidateNonMbTelnoAt = 'N';
                }

                //console.log("sValidateNonMbTelnoAt", sValidateNonMbTelnoAt);
                //console.log("sValidateMblpCertNoSuccess", sValidateMblpCertNoSuccess);

                //인증번호 전송 버튼 활성화
                if (sValidateNonMbTelnoAt == 'Y' && sValidateMblpCertNoSuccess == 'N') {
                    $("#nonMbCertNoSend").attr("disabled", false);
                    $("#nonMbCertNoSend").removeClass("disabled");
                    if (window.fn_validateJoinInfoRegInputVal) {
                        //sValidateMblpCertNoSuccess = "Y";
                        fn_validateJoinInfoRegInputVal();
                    }
                }
                else {
                    $("#nonMbCertNoSend").attr("disabled", true);
                    $("#nonMbCertNoSend").addClass("disabled");
                    if (window.fn_validateJoinInfoRegInputVal) {
                        //sValidateMblpCertNoSuccess = "N";
                        fn_validateJoinInfoRegInputVal();
                    }
                }

                if (e.keyCode != 9) {
                    if (typeof AuthTimer != 'undefined') {
                        AuthTimer.fnStop();
                        $('#timer').html("3:00");
                        $('#nonMbCertNoSend').html("인증요청");
                        sValidateMblpCertNoSuccess = "N";
                        $('#nonMbCertRow').show();
                        $('#mblpCharCertNo').val("");
                        $("#nonMbCertNoSend").removeClass("disabled");
                        $("#nonMbCertNoSend").attr("disabled", false);
                        $("#btnMblpCharCert").attr("disabled", true);
                        $("#btnMblpCharCert").addClass("disabled");
                        if (fn_validateNonMbInputVal()) {
                            if (e.keyCode == 13) { $("#btnChkNonMbLogin").click(); }
                        } else {
                            if (e.keyCode == 13) { $("#nonMbCertNoSend").click(); }
                        }
                    }
                    else {
                        if (fn_validateNonMbInputVal()) {
                            if (e.keyCode == 13) { $("#btnChkNonMbLogin").click(); }
                        } else {
                            if (e.keyCode == 13) { $("#ibxNonMbPwd").focus(); }
                        }
                    }
                }
            });
            $("#ibxNonMbTelno").focusout(function () {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));
                fn_validateNonMbInputVal();
            });

            /* 인증번호 숫자만 입력 여부 판단*/
            $("#mblpCharCertNo").on("keyup", function (e) {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));

                if ($("#mblpCharCertNo").val().length >= 4) {
                    $("#btnMblpCharCert").removeClass("disabled");
                    $("#btnMblpCharCert").attr("disabled", false);
                }
                else {
                    $("#btnMblpCharCert").attr("disabled", true);
                    $("#btnMblpCharCert").addClass("disabled");
                }

                if (e.keyCode == 13) { $("#btnMblpCharCert").click(); }
            });
            $("#mblpCharCertNo").focusout(function () {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));
                if ($("#mblpCharCertNo").val().length >= 4) {
                    $("#btnMblpCharCert").removeClass("disabled");
                    $("#btnMblpCharCert").attr("disabled", false);
                }
                else {
                    $("#btnMblpCharCert").attr("disabled", true);
                    $("#btnMblpCharCert").addClass("disabled");
                }
            });

            /* 비밀번호 숫자만 입력 여부판단 */
            $("#ibxNonMbPwd").on("keyup", function (e) {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));
                if (fn_validateNonMbInputVal()) {
                    if (e.keyCode == 13) { $("#btnChkNonMbLogin").click(); }
                } else {
                    if (e.keyCode == 13) { $("#ibxNonMbPwdConfirm").focus(); }
                }
            });
            $("#ibxNonMbPwd").focusout(function () {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));
                fn_validateNonMbInputVal();
            });

            /* 비밀번호 확인 숫자만 입력 여부판단 */
            $("#ibxNonMbPwdConfirm").on("keyup", function (e) {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));
                if (fn_validateNonMbInputVal()) {
                    if (e.keyCode == 13) { $("#btnChkNonMbLogin").click(); }
                }
            });
            $("#ibxNonMbPwdConfirm").focusout(function () {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));
                fn_validateNonMbInputVal();
            });

            //체크박스 변경여부
            $("#chkNonMbBokdPersonInfoProcTrue").change(function () {
                if ($('#chkNonMbBokdPersonInfoProcTrue').is(":checked")) {
                    fn_validateNonMbInputVal();
                }
                else {
                    fn_validateNonMbInputVal();
                }
            });

            $("#chkNonMbBokdPersonInfoProcFalse").change(function () {
                if ($('#chkNonMbBokdPersonInfoProcFalse').is(":checked")) {
                    fn_validateNonMbInputVal();
                }
                else {
                    fn_validateNonMbInputVal();
                }
            });

            /*이벤트*/
            /* 인증번호 전송 버튼 클릭*/
            $("#nonMbCertNoSend").click(function () {
                if ($("#nonMbCertNoSend").hasClass("disabled")) {
                    return;
                }

                var sRedisKey = $('#loginForm input[name=nonMbCertRedisKey]').val();
                var sNonMbTelno = $('#ibxNonMbTelno').val();
                var paramData = {
                    redisKey: sRedisKey
                    , nonMbTelno: sNonMbTelno
                };

                $('#nonMbCert-error-text').text('');

                $.ajaxMegaBox({
                    url: "/on/oh/ohg/MbLogin/selectNonMbCertNoSend.rest",
                    type: "POST",
                    contentType: "application/json;charset=UTF-8",
                    dataType: "json",
                    data: JSON.stringify(paramData),
                    success: function (data, textStatus, jqXHR) {
                        $('input[name=nonMbCertRedisKey]').attr('value', data.resultMap.redisKey);

                        if (data.resultMap.successAt == "N") {
                            //비회원로그인-예매
                            var bokdLoginAt = $('#loginForm input[name=bokdLoginAt]').val();
                            if (bokdLoginAt == "Y") {
                                //예매로그인일경우
                                //인증시간이 만료된 경우
                                if (data.resultMap.msg == "ME061") {
                                    gfn_alertMsgBoxSize('인증시간이 만료되었습니다. 인증번호를 재전송 후 입력바랍니다.', 400, 250);	//인증시간이 만료되었습니다. 인증번호를 재전송 후 입력바랍니다.
                                }
                                //동일번호로 3회 이상 요청하는경우
                                else if (data.resultMap.msg == "ME062") {
                                    //오입력값을 체크한다.
                                    $('.before').hide();
                                    $('.after').show();
                                    $('#btnNonMbModalClose').trigger("click");
                                    $('#layer_login_select button.btn-modal-close').trigger("click");
                                    gfn_alertMsgBoxSize('동일번호로 연속적인 인증이 발생하여 창을 닫습니다.\n3분후 다시 시도해 주세요.', 400, 250);	//동일번호로 연속적인 인증이 발생하여 창을 닫습니다.\\n번호를 확인 한 후 처음부터 다시 진행바랍니다.
                                }

                            }
                            else {
                                //회원가입
                                var options = {};
                                options.msg = '동일번호로 연속적인 인증이 발생하여 창을 닫습니다.\n3분후 다시 시도해 주세요.';	//동일번호로 연속적인 인증이 발생하여 창을 닫습니다.\\n처음부터 다시 이용바랍니다.
                                options.callback = fn_mvMainPage;
                                options.minWidth = 400;
                                options.minHeight = 250;
                                gfn_alertMsgBox(options);
                            }
                            return;
                        }
                        else {
                            //nonMbCertRedisKey
                            //console.log("certNo", data.resultMap.certNo);
                            $('#nonMbCertNoSend').html("재전송");
                            $('#loginForm input[name=nonMbCertedMblpNo]').attr('value', sNonMbTelno);
                            gfn_alertMsgBoxSize('인증번호를 전송했습니다.\n인증번호가 도착하지 않았을 경우 재전송을 눌러 주세요.', 400, 250);

                            if (typeof AuthTimer != 'undefined') {
                                AuthTimer.fnStop();
                                $('#timer').html("3:00");
                            }
                            else {
                                AuthTimer = new $ComTimer();
                            }
                            AuthTimer.comSecond = 180;
                            AuthTimer.fnCallback = function () { alert("다시인증을 시도해주세요.") }
                            AuthTimer.timer = setInterval(function () { AuthTimer.fnTimer() }, 1000);
                            AuthTimer.domId = document.getElementById("timer");
                            //입력하신 휴대폰 번호로 인증번호가 발송되었습니다. 확인 후 인증번호를 입력해주세요!
                        }
                    },
                    error: function (xhr, status, error) {
                        var err = JSON.parse(xhr.responseText);
                        alert(xhr.status);
                        alert(err.message);
                    }
                });
            });


            //인증번호 확인 버튼 클릭
            $("#btnMblpCharCert").click(function () {
                if ($("#btnMblpCharCert").hasClass("disabled")) {
                    return;
                }

                var sRedisKey = $('#loginForm input[name=nonMbCertRedisKey]').val();
                var sMblpCharCertNo = $('#mblpCharCertNo').val();
                var sNonMbTelno = $('#ibxNonMbTelno').val();
                var paramData = {
                    redisKey: sRedisKey
                    , certNo: sMblpCharCertNo
                    , nonMbTelno: sNonMbTelno
                };

                $.ajaxMegaBox({
                    url: "/on/oh/ohg/MbLogin/selectNonMbCertNoCnfn.rest",
                    type: "POST",
                    contentType: "application/json;charset=UTF-8",
                    dataType: "json",
                    data: JSON.stringify(paramData),
                    success: function (data, textStatus, jqXHR) {
                        var successAt = data.resultMap.successAt;
                        var msg = data.resultMap.msg;
                        var redisKey = data.resultMap.redisKey;

                        if (successAt == "Y") {
                            sValidateMblpCertNoSuccess = "Y";
                            fn_validateNonMbInputVal();
                            $('#loginForm input[name=nonMbCertRedisKey]').attr('value', data.resultMap.redisKey);
                            $('#nonMbCert-error-text').text('');
                            $("#nonMbCertNoSend").attr("disabled", true);
                            $("#nonMbCertNoSend").addClass("disabled");
                            $("#nonMbCertRow").hide();
                            gfn_alertMsgBoxSize('휴대폰 인증을 완료했습니다.\n확인 버튼을 눌러주세요.', 400, 250);	//휴대폰 인증을 완료했습니다.
                            if (typeof fn_validateJoinInfoRegInputVal != "undefined") {
                                fn_validateJoinInfoRegInputVal()	//회원가입에서 검증함수 호출
                            }
                        }
                        else {
                            sValidateMblpCertNoSuccess = "N";
                            if (msg == "ME019") {
                                $('#nonMbCert-error-text').text('인증번호가 일치하지 않습니다.\n인증번호를 다시 입력해주세요.');	//msg.ch.ohg.ME019 인증번호를 다시 확인 후 입력해 주세요.
                            }
                            else if (msg == "ME040") {
                                $('#nonMbCert-error-text').text('인증시간이 만료되었습니다. 인증번호를 재전송 후 입력바랍니다.');	//msg.ch.ohg.ME040	유효시간이 지났습니다.  인증번호 재전송을 통해서 다시 인증해주세요.
                            }
                            else if (msg == "ME061") {
                                $('#nonMbCert-error-text').text('인증시간이 만료되었습니다. 인증번호를 재전송 후 입력바랍니다.');	//msg.ch.ohg.ME061	유효시간이 지났습니다.  인증번호 재전송을 통해서 다시 인증해주세요.
                                gfn_alertMsgBoxSize('인증시간이 만료되었습니다. 인증번호를 재전송 후 입력바랍니다.', 400, 250);	//입력정보를 확인해주세요.
                            }

                            $("#nonMbCertNoSend").removeClass("disabled");
                            $("#nonMbCertNoSend").attr("disabled", false);
                            $("#nonMbCertRow").show();
                        }
                    },
                    error: function (xhr, status, error) {
                        var err = JSON.parse(xhr.responseText);
                        alert(xhr.status);
                        alert(err.message);
                    }
                });
            });

            // 비회원 정보 확인 팝업 요청
            $("#btnChkNonMbLogin").click(function () {

                if (submitIng) return;

                if (typeof $("#ibxNonMbPwdConfirm").val() != 'undefined') {
                    if ($("#ibxNonMbPwd").val() != $("#ibxNonMbPwdConfirm").val()) {
                        gfn_alertMsgBoxSize('입력정보를 확인해주세요.', 400, 250);	//입력정보를 확인해주세요.
                        return;
                    }
                }

                //생년월일 날짜형태 확인
                // 		if(!fn_validateDateYn($("#ibxNonMbByymmdd").val())) {
                // 			alert("생년월일 입력이 잘못 되었습니다.");
                // 			$("#ibxNonMbByymmdd").focus();
                // 			return;
                // 		}
                $("#btnNonMbLogin").attr("disabled", false);
                fn_chkNonMbLogin();
            });

            // 비회원 로그인
            $("#btnNonMbLogin").click(function () {

                var paramData = {
                    nonMbNm: $("#ibxNonMbNm").val()
                    , nonMbByymmdd: $("#ibxNonMbByymmdd").val()
                    , nonMbTelno: $("#ibxNonMbTelno").val()
                    , nonMbPwd: $("#ibxNonMbPwd").val()
                    , bokdCnfmAt: bokdCnfmAt
                };

                $.ajaxMegaBox({
                    url: "/on/oh/ohg/NonMbLogin/selectNonMbLoginInfo.rest",
                    type: "POST",
                    contentType: "application/json;charset=UTF-8",
                    dataType: "json",
                    data: JSON.stringify(paramData),
                    success: function (data, textStatus, jqXHR) {

                        var menuId = data.menuId;
                        var mappingId = data.mappingId;
                        var statCd = data.result.statCd;


                        if (typeof loginPopupCallScn === "undefined") {
                            loginPopupCallScn = "";
                        }
                        //화면이동
                        if (menuId != "" && menuId != null) {    //화면으로 띄웠을떄
                            fn_mvPage(mappingId);
                            return;
                        }
                        else {
                            if (loginPopupCallScn != "" && loginPopupCallScn != null) {  //팝업으로 띄었을때 파라메타는 팝업 호출화면에 전역으로 정의
                                $(".btn-layer-close").trigger("click");
                                if (loginPopupCallScn == "SimpleBokdM") {
                                    $('.before').hide();
                                    $('.after').show();
                                    alert("콜백함수호출");
                                } else if (loginPopupCallScn == "StoreDtlV") {
                                    $('.before').hide();
                                    $('.after').show();
                                } else if (loginPopupCallScn == "MySbscDtlsL") {
                                    $('.before').hide();
                                    $('.after').show();
                                    location.href = '/on/oh/ohh/MySbscDtls/mySbscDtlsListPage.do?currPage=1&searchText=';
                                }
                            }
                            else {
                                var bokdLoginAt = $('#loginForm input[name=bokdLoginAt]').val();
                                if (bokdLoginAt == "Y") {
                                    //예매로그인일경우
                                    //오입력값을 체크한다.
                                    $('.before').hide();
                                    $('.after').show();
                                    $('#btnNonMbModalClose').trigger("click");
                                    $('#layer_login_select button.btn-modal-close').trigger("click");
                                    fn_validDataRevisn(JSON.parse($('#loginForm input[name=bokdLoginParam]').val()));
                                    return;
                                }

                                if (bokdCnfmAt == "Y") {
                                    $('#nonMbBokdCnfmForm input[name=nonMbNm]').attr('value', $('#ibxNonMbNm').val());
                                    $('#nonMbBokdCnfmForm input[name=nonMbTelno]').attr('value', $('#ibxNonMbTelno').val());
                                    $('#nonMbBokdCnfmForm input[name=nonMbPwd]').attr('value', $('#ibxNonMbPwd').val());
                                    $('#nonMbBokdCnfmForm input[name=nonMbByymmdd]').attr('value', $('#ibxNonMbByymmdd').val());

                                    /////////////////////////////////////////////////////////////////////
                                    // 예매정보가 없을 시 메세지 팝업처리 /////////////////////////////////
                                    /////////////////////////////////////////////////////////////////////
                                    if (statCd == 0) {
                                        fn_mvNonMbBokdCnfm("/non-member"); //비회원 예매 확인일때
                                    } else {
                                        alert("입력하신 정보와 일치하는 예매내역이 없습니다.");
                                    }
                                    /////////////////////////////////////////////////////////////////////
                                    /////////////////////////////////////////////////////////////////////

                                    //fn_mvNonMbBokdCnfm("/non-member"); //비회원 예매 확인일때
                                }
                                else {
                                    location.reload();
                                }

                            }
                        }
                        return;
                    },
                    error: function (xhr, status, error) {
                        var err = JSON.parse(xhr.responseText);
                        alert(xhr.status);
                        alert(err.message);
                    },
                    beforeSend: function () {
                        submitIng = true;
                    },
                    complete: function () {
                        submitIng = false;
                    }
                });

                //페이지 이동 submit
                function fn_mvNonMbBokdCnfm(page) {
                    // 	        console.log("fn_mvNonMbBokdCnfm : "+page);
                    $("#nonMbBokdCnfmForm").attr("method", "post");
                    $("#nonMbBokdCnfmForm").attr("action", page);
                    $("#nonMbBokdCnfmForm").submit();
                }

                //비회원 예매 확인 페이지 이동 submit
                function fn_mvPage(page) {
                    // 	        console.log("MbLoginScriptDV.fn_mvPage : "+page);
                    $("#loginForm").attr("method", "post");
                    $("#loginForm").attr("action", page);
                    $("#loginForm").submit();
                }
            });
        });

        function fn_adTracking(url) {
            $.ajax({
                type: "get"
                , url: url
                , data: ""
                , dataType: "json"
                , success: function (result) {

                }
                , error: function (err) {
                    console.log('fn_adEventCall error : ' + err.status);
                }
            });
        }

        /*호출 화면에 따른 분기처리*/
        function fn_viewLoginPopup(viewId, deviceType, bokdLoginAt, bokdLoginParam, reloadYn) {

            //로그인 폼 호출시 광고영역 노출
            if ($("#Rw6jtk0hQTuOBSzFbvGGlw").html() == "") {

                $("#Rw6jtk0hQTuOBSzFbvGGlw").append('<a href="" target="_blank"><img id="pageBannerRnbImage" src="/static/pc/images/common/bg/bg-noimage-main.png" /></a>');

                var header = { "typ": "JWT", "alg": "HS256" }
                var data = {
                    "device": { "devicetype": 2 },
                    "imp": [{ "native": { "ext": { "slots": 1 } } }],
                    "site": { "name": "megabox" },
                    "id": ""
                };
                var secret = "Rw6jtk0hQTuOBSzFbvGGlw";

                var stringifiedHeader = CryptoJS.enc.Utf8.parse(JSON.stringify(header));
                var encodedHeader = base64url(stringifiedHeader);
                var stringifiedData = CryptoJS.enc.Utf8.parse(JSON.stringify(data));
                var encodedData = base64url(stringifiedData);
                var signature = encodedHeader + "." + encodedData;
                signature = CryptoJS.HmacSHA256(signature, secret);
                signature = base64url(signature);
                var pram = encodedHeader + "." + encodedData + "." + signature;
                var adUrl = "https://cast.imp.joins.com/bid/" + secret + "/" + pram; //상용

                $.ajax({
                    type: "get"
                    , url: adUrl
                    , data: ""
                    , success: function (result) {
                        if (result) {
                            $("#pageBannerRnbImage").attr("src", result.image_file);
                            $("#pageBannerRnbImage").attr("alt", result.alternative_text);
                            $("#pageBannerRnbImage").attr("clickThrough", result.click_tracking);
                            $("#pageBannerRnbImage").parent().attr("href", result.click_through);



                            $("#pageBannerRnbImage").css("height", result.height);
                            $("#Rw6jtk0hQTuOBSzFbvGGlw").css("background-color", result.bgcolor);
                            fn_adTracking(result.impression_tracking);
                        }
                    }
                    , error: function (err) {
                        console.log('fn_getBannerAd error : ' + err.status);
                    }
                });

                //광고링크
                $("#pageBannerRnbImage").on("click", function () {
                    var clickThrough = $(this).attr("clickThrough");
                    if (clickThrough != undefined && clickThrough != '') {
                        fn_adTracking(clickThrough);
                    }
                });
            }

            //
            $(".alert").html("");
            if (sCookieVal == "") {	//아이디 저장 체크 안했을경우
                $(".login-input-area #ibxLoginId").val("");			//아이디
            }
            $(".login-input-area #ibxLoginPwd").val("");		//비밀번호
            $(".no-member-login-table #ibxNonMbNm").val("");	//비회원 이름
            $(".no-member-login-table #ibxNonMbByymmdd").val("");	//비회원 생년월일
            $(".no-member-login-table #ibxNonMbTelno").val("");		//비회원 휴대폰 번호
            $(".no-member-login-table #mblpCharCertNo").val("");	//비회원 휴대폰인증번호
            $(".no-member-login-table #ibxNonMbPwd").val("");		//비회원 비밀번호
            $(".no-member-login-table #ibxNonMbPwdConfirm").val("");	//비회원 비밀번호확인
            $("input[name=chkNonMbBokdPersonInfoProc]").prop("checked", false);	//비회원 라디오버튼 해제
            if (typeof AuthTimer != 'undefined') {
                AuthTimer.fnStop();
                $('#timer').html("3:00");
                $('#nonMbCertNoSend').html("인증요청");
                sValidateMblpCertNoSuccess = "N";
                $('#nonMbCertRow').show();
                $('#mblpCharCertNo').val("");
                $("#nonMbCertNoSend").removeClass("disabled");
                $("#nonMbCertNoSend").attr("disabled", false);
            }
            fn_validateNonMbInputVal();

            $('#loginForm input[name=bokdLoginAt]').val("");				//예매 로그인 여부
            $('#loginForm input[name=bokdLoginParam]').val("");				//예매 로그인 파라메타
            $('#loginForm input[name=validDataRevisnYn]').val("");				//데이터 보정 여부
            fn_validateInputVal();

            if ('pc' == deviceType) {

                if ('SimpleBokdM' == viewId) {
                    var sBokdLoginAt = typeof bokdLoginAt == 'undefined' ? "" : bokdLoginAt;//예매 로그인 여부
                    $('#layer_login_select .layer-con .tab-list').show();			//로그인 비회원로그인 선택창
                    $('#layer_login_select .layer-con .tab-cont-wrap .login-member').removeClass('pt00');	//레이어 사이즈 줄임
                    $("#loginPupupATag").attr("h-data", '556');	//높이값 변경
                    $("#loginPupupATag").trigger("click");	//레이어띄움
                    $('#loginForm input[name=bokdLoginAt]').attr('value', sBokdLoginAt);			//예매 로그인 여부 값 설정
                    $('#loginForm input[name=bokdLoginParam]').attr('value', bokdLoginParam);	//예매 로그인 파라메타
                    if (bokdLoginAt == "Y") {
                        $('#loginForm input[name=nonMbCertRedisKey]').val("");
                        $('#loginForm input[name=nonMbCertedMblpNo]').val("");
                    }

                }
                else if ('StoreDtlV' == viewId || 'MySbscDtlsL' == viewId) {
                    $("#loginPupupATag").trigger("click");	//레이어띄움
                    $("#mbPopLayer").show();		//회원 레이어
                    $("#nonMbLogoLayer").hide();	//비회원 로고
                    $("#nonMbPopLayer").hide();		//비회원 레이어
                    $("#mbMbChoiLayer").hide();	//회원 비회원 선택

                    $("#nonMbBokdCnfm").attr("style", "display:none");
                }
                else if ('BoutiqPrivateL' == viewId) {	//부티크
                    $('#layer_login_select .layer-con .tab-list li:eq(0) a').trigger("click");	//회원로그인만 클릭되도록
                    $('#layer_login_select .layer-con .tab-list').hide();						//로그인 비회원로그인 선택창
                    $('#layer_login_select .layer-con .tab-cont-wrap .login-member').addClass('pt00');	//레이어 사이즈 줄임
                    $("#loginPupupATag").attr("h-data", '484');	//높이값 변경
                    $("#loginPupupATag").trigger("click");	//레이어띄움

                    $('#loginForm input[name=reloadYn]').attr('value', reloadYn); // 화면 리로드 설정
                    $('#loginForm input[name=validDataRevisnYn]').val("Y");				//데이터 보정 여부
                }
                else {
                    var sReloadYn = typeof reloadYn == 'undefined' ? "" : reloadYn;// 화면 리로드 여부
                    $('#layer_login_select .layer-con .tab-list li:eq(0) a').trigger("click");	//회원로그인만 클릭되도록
                    $('#layer_login_select .layer-con .tab-list').hide();						//로그인 비회원로그인 선택창
                    $('#layer_login_select .layer-con .tab-cont-wrap .login-member').addClass('pt00');	//레이어 사이즈 줄임
                    $("#loginPupupATag").attr("h-data", '484');	//높이값 변경
                    $("#loginPupupATag").trigger("click");	//레이어띄움

                    $('#loginForm input[name=reloadYn]').attr('value', sReloadYn); // 화면 리로드 설정
                }
            }
        }

        //입력 문자 체크
        function fn_validateNonMbInputVal() {
            //이름
            if ($("#ibxNonMbNm").val() != "") {
                sValidateNonMbNmAt = 'Y';
            }
            else {
                sValidateNonMbNmAt = 'N';
            }

            //생년월일
            if ($("#ibxNonMbByymmdd").val() != "") {
                if (fn_validateDateYn($("#ibxNonMbByymmdd").val(), 6)) {
                    sValidateNonMbByymmddAt = 'Y';
                    //비회원예매확인
                    if (bokdCnfmAt == "Y") {
                        $('#ErrTextNonMbByymmdd').text('');
                    }
                    //비회원로그인
                    else {
                        $('#mblpInput-error-text').text('');
                    }
                }
                else {
                    sValidateNonMbByymmddAt = 'N';
                    //비회원예매확인
                    if (bokdCnfmAt == "Y") {
                        $('#ErrTextNonMbByymmdd').text('생년월일을 정확히 입력해주세요.');
                    }
                    //비회원로그인
                    else {
                        $('#mblpInput-error-text').text('생년월일을 정확히 입력해주세요.');
                    }
                    return false;
                }
            }
            else {
                sValidateNonMbByymmddAt = 'N';
                $('#mblpInput-error-text').text('');
            }

            //휴대폰 번호
            if ($("#ibxNonMbTelno").val() != "") {
                var frontNm = $("#ibxNonMbTelno").val().substr(0, 2);
                if (frontNm != '01') {
                    $('#mblpInput-error-text').text('휴대폰번호를 정확히 입력해주세요.');
                    ibxNonMbTelno = 'N';
                    return false;
                }
                else if ($("#ibxNonMbTelno").val().length < 10) {
                    $('#mblpInput-error-text').text('휴대폰번호를 정확히 입력해주세요.');
                    sValidateNonMbTelnoAt = 'N';
                    return false;
                }
                else {
                    sValidateNonMbTelnoAt = 'Y';
                    $('#mblpInput-error-text').text('');
                }
            }
            else {
                sValidateNonMbTelnoAt = 'N';
            }


            if ($("#ibxNonMbPwd").val().length == 4) {
                sValidateNonMbPwdAt = 'Y';
            }
            else {
                sValidateNonMbPwdAt = 'N';
            }
            if (bokdCnfmAt == "Y") {
                sValidateNonMbPwdConfirmAt = 'Y';
                sValidateNonMbPwdEqualAt = 'Y';
                sValidateNonMbBokdPersonInfoProc = 'Y';
                sValidateMblpCertNoSuccess = 'Y';
            }
            else {
                if ($("#ibxNonMbPwdConfirm").val().length == 4) {
                    sValidateNonMbPwdConfirmAt = 'Y';
                }
                else {
                    sValidateNonMbPwdConfirmAt = 'N';
                }

                if ($("#ibxNonMbPwd").val().length > 0 && $("#ibxNonMbPwdConfirm").val().length > 0 && $("#ibxNonMbPwd").val() == $("#ibxNonMbPwdConfirm").val()) {
                    sValidateNonMbPwdEqualAt = 'Y';
                    $('#nonMbPwdErrText').text('');
                }
                else if ($("#ibxNonMbPwd").val().length > 0 && $("#ibxNonMbPwdConfirm").val().length > 0 && $("#ibxNonMbPwd").val() != $("#ibxNonMbPwdConfirm").val()) {
                    sValidateNonMbPwdEqualAt = 'N';
                    $('#nonMbPwdErrText').text('비밀번호와 비밀번호 확인의 입력값이 일치하지 않습니다.');
                    return false;
                }

                if ($('#chkNonMbBokdPersonInfoProcTrue').prop("checked")) {
                    sValidateNonMbBokdPersonInfoProc = 'Y';
                }
                else {
                    sValidateNonMbBokdPersonInfoProc = 'N';
                }

                if ($('#chkNonMbBokdPersonInfoProcFalse').prop("checked")) {
                    sValidateNonMbBokdPersonInfoProc = 'N';
                }
            }

            // 	$('#error-text1').text
            // 	("sValidateNonMbNmAt:"             +sValidateNonMbNmAt              +("/")+$("#ibxNonMbNm").val().length        +("\n\n")+
            // 			"sValidateNonMbByymmddAt:"         +sValidateNonMbByymmddAt         +("/")+$("#ibxNonMbByymmdd").val().length   +("\n\n")+
            // 			"sValidateNonMbTelnoAt:"           +sValidateNonMbTelnoAt           +("/")+$("#ibxNonMbTelno").val().length     +("\n\n")+
            // 			"sValidateNonMbPwdAt:"             +sValidateNonMbPwdAt             +("/")+$("#ibxNonMbPwd").val().length       +("\n\n")+
            // 			"sValidateNonMbPwdConfirmAt:"      +sValidateNonMbPwdConfirmAt      +("/")+$("#ibxNonMbPwdConfirm").val().length+("\n\n")+
            // 			"sValidateNonMbPwdEqualAt:"        +sValidateNonMbPwdEqualAt        +("/\n\n")+
            // 			"sValidateNonMbBokdPersonInfoProc:"+sValidateNonMbBokdPersonInfoProc+("/\n\n")
            // 		+$("input:checkbox[id='chkNonMbBokdPersonInfoProc']").is(":checked"));

            if (bokdCnfmAt == "N"
                && sValidateNonMbNmAt == 'Y'
                && sValidateNonMbByymmddAt == 'Y'
                && sValidateNonMbTelnoAt == 'Y'
                && sValidateNonMbPwdAt == 'Y'
                && sValidateNonMbPwdConfirmAt == 'Y'
                && sValidateNonMbBokdPersonInfoProc == 'Y'
                && sValidateNonMbPwdEqualAt == 'Y'
                && sValidateMblpCertNoSuccess == 'Y') {
                $("#btnChkNonMbLogin").attr("disabled", false);
                return true;
            }
            else if (bokdCnfmAt == "Y"
                && sValidateNonMbNmAt == 'Y'
                && sValidateNonMbByymmddAt == 'Y'
                && sValidateNonMbTelnoAt == 'Y'
                && sValidateNonMbPwdAt == 'Y') {
                $("#btnNonMbLogin").attr("disabled", false);
                return true;
            }
            else {
                $("#btnChkNonMbLogin").attr("disabled", true);
                $("#btnNonMbLogin").attr("disabled", true);
                return false;
            }
        }

        /*날짜 형태 확인*/
        function fn_validateDateYn(param, length) {
            try {
                var year = 0;
                var month = 0;
                var day = 0;

                param = param.replace(/-/g, '');

                // 자리수가 맞지않을때
                if (isNaN(param) || param.length < Number(length) || param.length > Number(length)) {
                    return false;
                }

                if (param.length == 6) {
                    year = Number(param.substring(0, 2));
                    month = Number(param.substring(2, 4));
                    day = Number(param.substring(4, 6));
                }
                else if (param.length == 8) {
                    year = Number(param.substring(0, 4));
                    month = Number(param.substring(4, 6));
                    day = Number(param.substring(6, 8));

                    var sysYear = Number(new Date().getFullYear());
                    //년도입력이 현재 년도보다 클때.
                    if (sysYear < year) {
                        return false;
                    }
                }
                else {
                    return false;
                }


                var dd = day / 0;


                if (month < 1 || month > 12) {
                    return false;
                }

                var maxDaysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
                var maxDay = maxDaysInMonth[month - 1];

                // 윤년 체크
                if (month == 2 && (year % 4 == 0 && year % 100 != 0 || year % 400 == 0)) {
                    maxDay = 29;
                }

                if (day <= 0 || day > maxDay) {
                    return false;
                }
                return true;

            } catch (err) {
                return false;
            }
        }


        function $ComTimer() {
            //prototype extend
        }

        $ComTimer.prototype = {
            comSecond: ""
            , fnCallback: function () { }
            , timer: ""
            , domId: ""
            , fnTimer: function () {
                var m = Math.floor(this.comSecond / 60) + ":" + String((this.comSecond % 60)).lpad(2, "0");	// 남은 시간 계산
                this.comSecond--;					// 1초씩 감소
                this.domId.innerText = m;
                if (this.comSecond < 0) {			// 시간이 종료 되었으면..
                    clearInterval(this.timer);		// 타이머 해제
                    $('#nonMbCert-error-text').text('인증시간이 만료되었습니다. 인증번호를 재전송 후 입력바랍니다.');	//msg.ch.ohg.ME061	인증시간이 만료되었습니다. 인증번호를 재전송 후 입력바랍니다.
                    $("#btnMblpCharCert").attr("disabled", true);	//인증확인버튼 비활성
                    $("#btnMblpCharCert").addClass("disabled");		//인증확인버튼 비활성
                }
            }
            , fnStop: function () {
                clearInterval(this.timer);
            }
        }

    </script>
    <script type="text/javascript">
        var simpleLoginWithPopup;
        var simpleLoginWith = function (lnkgTy) {
            var url = "/on/oc/ocz/SimpleLogin/simpleLogin.do?lnkgTy=" + lnkgTy;
            if (simpleLoginWithPopup) {
                simpleLoginWithPopup.close();
            }
            if (lnkgTy != "FACEBOOK") {
                simpleLoginWithPopup = window.open(url, 'simpleLoginWithPopup', 'width=420, height=550');
            }
            else {
                simpleLoginWithPopup = window.open(url, 'simpleLoginWithPopup', 'width=650, height=600, scrollbars=yes');
            }
        }

        var fn_LoginPopUpCall = function (paramData) {
            if (lnkgInfoObj.attr("connTy") != undefined) {
                fn_ConnWithCallBack(paramData);
            } else {
                fn_LoginWithCallBack(paramData);
            }

        }
        var fn_LoginPopUpCallError = function (msg) {
            gfn_alertMsgBoxSize(msg, 400, 250);
        }

        //비회원 확인 팝업
        function fn_chkNonMbLogin() {

            var $td = $(document).find('#layer_no_member_chk td');

            var telTmp = $('#ibxNonMbTelno').val();

            switch (telTmp.length) {
                case 10: telTmp = telTmp.format('XXX-XXX-XXXX'); break;
                case 11: telTmp = telTmp.format('XXX-XXXX-XXXX'); break;
            }

            $td.eq(0).html($('#ibxNonMbNm').val());
            $td.eq(1).html($('#ibxNonMbByymmdd').val());
            $td.eq(2).html(telTmp);

            // 레이어 호출
            $(document).find('#aNonMbLogin').click();
        }
    </script>
    <script type="text/javascript">
        var fn_LoginWithCallBack = function (paramData) {
            $.ajaxMegaBox({
                url: "/on/oc/ocz/SimpleLogin/selectSimpleLogin.do",
                type: "POST",
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                data: JSON.stringify(paramData),
                success: function (data, textStatus, jqXHR) {
                    if (data.userMap == null) {
                        //var simpleLoginTyCd = data.userMap.simpleLoginTyCd;
                        gfn_alertMsgBoxSize('[' + paramData.simpleLoginTyCd + '] 계정으로 연동된 메가박스 계정이 없습니다.\n연동을 원하시면 나의메가박스 > 개인정보수정에서\n간편로그인 계정연동을 진행해 주세요.', 400, 250);
                    } else {
                        var loginId = data.userMap.loginId;
                        var mbNo = data.userMap.mbNo;
                        fn_selectMbLogin(loginId, "simpleLogin", "Y", paramData.redisKey);
                    }
                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(xhr.status);
                    alert(err.message);
                }
            });
        }
        var lnkgInfoObj;
        $(function () {
            $("div.sns-login > a").off("click").on("click", function () {
                lnkgInfoObj = $(this);
                simpleLoginWith($(this).attr("lnkgTy"));
            });
        });
    </script>
    <script type="text/javascript">
        $(function () {


            $('#header .right-link .before').show();
            $('#header .right-link .after').hide();
            //session 관련 처리를 위한 부분
            $.ajaxMegaBox({
                url: '/sessionChk.do',
                success: function (data) {
                    var loginYn = data.loginYn;
                    if (loginYn == 'Y') {
                        $('.right-link .before').hide();
                        $('.right-link .after').show();
                    } else {
                        $('.right-link .before').show();
                        $('.right-link .after').hide();
                    }
                }
            });




            // 웹에서만 실행 -> facebook을 로드하지 않는 템플릿에서 반복적인 오류 발생으로 hreader로 이전
            if (!MegaboxUtil.Common.isMobile() && !MegaboxUtil.Common.isApp())
                MegaboxUtil.Share.init();
        });

        //로그인 버튼
        $(document).on('click', '#moveLogin', function () {

            fn_viewLoginPopup('default', 'pc');

        });

        var sysCd = 'ON';

        //넷퍼넬 스킨 타입 지정
        NetfunnelChk.setting(sysCd, MegaboxUtil.Common.isApp());

    </script>
    <script type="text/javascript">
        var localeCode = "kr";			//한영 구분 코드
        var sellChnlCd = '';	//파라메타로 전달된 판매 체널 코드
        var riaParamIsMember = '';	//회원여부
        var riaParamName = '';		//고객명
        var riaParamMobileNo = '';	//고객전화번호
        var riaParamBirthday = '';	//고객생년월일
        var riaParamMemberCard = '';	//카드번호
        var riaParamPassword = '';	//암호
        var riaParamIPinCi = '';		//아이핀 CI값
        var riaParamReciveTime = '';	//ARS시각
        var riaParamMovieCode = '';	//특정영화코드
        var riaMemberYn = '';	//메가박스 회원여부
        var riaLoginAt = '';		//메가박스 로그인여부
        var riaLoginId = '';		//메가박스 로그인여부
        var usrId = '';		//메가박스 로그인여부
        var msgStr = '';
        var bokdMPlayDe = ''; // 상영일자


        $(window).load(function () {
            var frameBokdMBookingBodyObj = $('#frameBokdMBooking').get(0).contentWindow.document.body;	//빠른예매 프레임 바디 오브젝트
            var frameBokdMBookingContentObj = $('#frameBokdMBooking').get(0).contentWindow;
            var frameBokdMSeatBodyObj = $('#frameBokdMSeat').get(0).contentWindow.document.body;	//좌석도 프레임 바디 오브젝트
            var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
            var framePayBookingBodyObj = $('#framePayBooking').get(0).contentWindow.document.body;	//결제화면 프레임 바디 오브젝트
            var framePayBookingContentObj = $('#framePayBooking').get(0).contentWindow;

            var bokdMPlaySchdlNo = '';	//파라메타로 전달된 상영스케줄 번호
            var bokdMRpstMovieNo = '';	//파라메타로 전달된 대표영화번호
            var bokdMTheabKindCode1 = ''; // 특별관 area
            var bokdMBrchNo1 = ''; // 지점코드

            //상영스케줄 번호가 없는경우 빠른예매 화면을 표시한다.
            if ("" == bokdMPlaySchdlNo) {
                //상단네비게이션바 RIA의 경우
                if (sellChnlCd != "") {

                    $('.page-util').hide();	//상단 네비게이션바를 숨김 처리한다.

                    if (riaMemberYn == "Y") {
                        msgStr = riaParamName + "(" + riaLoginId + ") 고객님의 회원 정보가 적용되었습니다."
                    }
                    else if (riaMemberYn == "N") {
                        msgStr = "해당 회원 정보가 없습니다. 비회원으로 예매를 진행합니다.";
                    }
                }
                else {
                    $('.page-util').show();	//상단 네비게이션바를 숨김 처리한다.
                }

                $('#bokdMSeat').hide();	//좌석도 숨김
                $('#bokdMPayBooking').hide();	//결제 숨김

                //$('#frameBokdMBooking').attr('src','/on/oh/ohb/SimpleBooking/simpleBookingPage.do?rpstMovieNo='+bokdMRpstMovieNo);	//영화를 통해 진입한경우 영화 파라메타를 함께 전달
                $('#frameBokdMBooking').attr('src', '/on/oh/ohb/SimpleBooking/simpleBookingPage.do?rpstMovieNo=' + bokdMRpstMovieNo + '&theabKindCode1=' + bokdMTheabKindCode1 + '&brchNo1=' + bokdMBrchNo1 + '&sellChnlCd=' + sellChnlCd + '&playDe=' + bokdMPlayDe); //영화를 통해 진입한경우 영화 파라메타를 함께 전달
                $('#frameBokdMBooking').load(function () {	//빠른예매 화면이 로딩이 완료되면
                    $('#frameBokdMSeat').attr('src', '/on/oh/ohz/PcntSeatChoi/selectPcntSeatChoi.do');	//좌석도 화면로딩
                    $('#framePayBooking').attr('src', '/on/oh/ohz/PayBooking/completeSeat.do');			//결제 화면 로딩
                });
                NetfunnelChk.script("BOOK_STEP1", function () {	//넷퍼넬 적용
                    $('#bokdMBooking').show();	//빠른예매 화면 표시
                });
            }
            else {
                NetfunnelChk.script("BOOK_STEP2", function () {	//넷퍼넬 적용
                    // 		$('#bokdMBooking').hide();	//빠른예매 숨김
                    // 		$('#bokdMPayBooking').hide();	//결제 숨김
                    $('#frameBokdMSeat').attr('src', '/on/oh/ohz/PcntSeatChoi/selectPcntSeatChoi.do');
                    $('#frameBokdMSeat').load(function () {
                        frameBokdMSeatBodyObj = $('#frameBokdMSeat').get(0).contentWindow.document.body;	//좌석도 프레임 바디 오브젝트
                        frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
                        $('#framePayBooking').attr('src', '/on/oh/ohz/PayBooking/completeSeat.do');
                        $(frameBokdMSeatBodyObj).find('#playSchdlNo').val(bokdMPlaySchdlNo);
                        frameBokdMSeatContentObj.fn_search();
                    });
                    $('#bokdMSeat').show();
                });
            }

            //RIA용 화면 패딩 제거
            if ("" != sellChnlCd) {
                $('.container').addClass("mg00");
                $('.container').addClass("pd00");
            }
        });

        //좌석도로 파라메타 전달
        function fn_setSmapParam(obj) {
            NetfunnelChk.script("BOOK_STEP2", function () {	//넷퍼넬 적용
                var frameBokdMSeatBodyObj = $('#frameBokdMSeat').get(0).contentWindow.document.body;	//좌석도 프레임 바디 오브젝트
                var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;

                $('#bokdMSeat').show();	//좌석도 표시
                $(frameBokdMSeatBodyObj).find('#playSchdlNo').val(obj.attr("play-schdl-no"));
                frameBokdMSeatContentObj.fn_search();

                // 	$('#frameBokdMSeat').attr('src','/on/oh/ohz/PcntSeatChoi/selectPcntSeatChoi.do?playSchdlNo='+obj.attr("play-schdl-no"));
                // 	$('#frameBokdMSeat').attr('src','/main');

                $('#bokdMBooking').hide();	//빠른예매 숨김
                $('#bokdMPayBooking').hide();	//결제 숨김
            });
        }

        //좌석도에서 이전 버튼 클릭
        function fn_goPrePagePcntSeatChoi(msg) {
            var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
            $('#bokdMPayBooking').hide();	//결제 숨김
            $('#bokdMSeat').hide();	//좌석도 숨김
            $('#bokdMBooking').show();	//빠른예매 표시

            if (msg != null && msg != "") {
                gfn_alertMsgBox("결제가능 시간이 초과되어<br/> 좌석선택부터 다시 진행바랍니다.");
            }

            //결제에서 예매이동 처리 추가
            $('#frameBokdMSeat').attr("src", "/on/oh/ohz/PcntSeatChoi/selectPcntSeatChoi.do"); //좌석도 화면초기화
            $('#framePayBooking').attr("src", "/on/oh/ohz/PayBooking/completeSeat.do"); //결제화면 초기화
        }

        //상영시간표에서 다음 버튼 클릭
        function fn_goNextPagePcntSeatChoi(param) {
            //선점좌석 체크
            fn_validOccupSeat(param);
            //로그인 여부 체크
            //데이터 보정 체크
            //fn_validLoginAt();
            //오입력 체크
            //블랙리스트 체크
            //결제로이동
        }


        //결제화면으로로 파라메타 전달 및 화면 이동
        function fn_setBookingParamMove(options) {
            NetfunnelChk.script("BOOK_STEP3", function () {	//넷퍼넬 적용
                var framePayBookingBodyObj = $('#framePayBooking').get(0).contentWindow.document.body;	//결제화면 프레임 바디 오브젝트
                var framePayBookingContentObj = $('#framePayBooking').get(0).contentWindow;

                //좌석도에서 세팅한 param 값
                var playSchdlNo = options.playSchdlNo;	//상영스케쥴
                var seatOccupText = options.seatOccupText;	//좌석/티켓 상세정보
                var totalAmt = options.totalAmt;		//총금액

                $(framePayBookingBodyObj).find('#playSchdlNo').val(playSchdlNo);
                $(framePayBookingBodyObj).find('#seatOccupText').val(seatOccupText);
                $(framePayBookingBodyObj).find('#totalAmt').val(totalAmt);

                framePayBookingContentObj.completeSeat();
                $('#bokdMPayBooking').show();
                //프레임 높이 자동 조정
                calcFrameHeight($('#bokdMPayBooking'), $('#framePayBooking'));

                $('#bokdMSeat').hide();  //좌석도 숨김
            });
        }

        //결제화면에서 이전 버튼 클릭
        function fn_goPrePagePayBooking() {
            var framePayBookingContentObj = $('#framePayBooking').get(0).contentWindow;
            var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
            $('#bokdMPayBooking').hide();
            $('#framePayBooking').attr("src", "/on/oh/ohz/PayBooking/completeSeat.do"); //결제화면 초기화
            $('#bokdMSeat').show();	//좌석도 표시
            $("html,body").scrollTop(0);

            frameBokdMSeatContentObj.fn_display_init();
        }

        function fn_seatDispInit() {
            var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
            frameBokdMSeatContentObj.fn_display_init();
            frameBokdMSeatContentObj.fn_search('N');
        }

        //결제화면에서 이전 버튼 클릭 및 블랙리스트 팝업
        function fn_altBlackgoPrePagePayBooking(blackListParam) {
            var framePayBookingContentObj = $('#framePayBooking').get(0).contentWindow;
            var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
            $('#bokdMPayBooking').hide();
            $('#framePayBooking').attr("src", "/on/oh/ohz/PayBooking/completeSeat.do"); //결제화면 초기화
            $('#bokdMSeat').show();	//좌석도 표시
            $("html,body").scrollTop(0);

            frameBokdMSeatContentObj.fn_display_init();

            frameBokdMSeatContentObj.shwoBlackListPopup(blackListParam);
        }

        //결제화면에서 오류 발생시 좌석도로 이동(기선점 존재, 시간 초과 등)
        function fn_goPrePageInitSeat(msg) {
            var framePayBookingContentObj = $('#framePayBooking').get(0).contentWindow;
            $('#bokdMPayBooking').hide();
            $('#framePayBooking').attr("src", "/on/oh/ohz/PayBooking/completeSeat.do"); //결제화면 초기화

            //좌석도 초기화
            var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
            frameBokdMSeatContentObj.fn_search('N');  //새로 조회 및 최초진입 팝업 띄우지 않음
            $('#bokdMSeat').show();	//좌석도 표시
            $("html,body").scrollTop(0);

            if (msg != null && msg != "") {
                gfn_alertMsgBox("결제가능 시간이 초과되어<br/> 좌석선택부터 다시 진행바랍니다.");
            }

            frameBokdMSeatContentObj.fn_display_init();
            frameBokdMSeatContentObj.fn_search('N');
        }

        //프레임 height 자동조정 : 결제만 적용가능
        function calcFrameHeight(divObj, frameObj) { //div obj, frame obj
            var frameBodyObj = $(frameObj).get(0).contentWindow.document.body;	//프레임 바디 오브젝트
            var height = $(frameObj).contents().find('.inner-wrap').outerHeight();
            $(divObj).height(height + 35);
            $(frameObj).height(height + 25);
        }

        //선점좌석 체크
        function fn_validOccupSeat(param) {
            $.ajaxMegaBox({
                url: "/on/oh/ohb/BokdMain/selectOccupSeat.do",
                data: JSON.stringify(param),
                success: function (result) {
                    var occupSeatAt = result.resultMap.occupSeatAt;	//좌석선점여부

                    //비 좌석선점 상태 로그인 체크 하러 감.
                    if (occupSeatAt == "N") {
                        fn_validLoginAt(param);	//로그인 체크
                    }
                    //좌석 선점 상태
                    else {
                        gfn_alertMsgBoxSize('선택하신 좌석은 이미 판매가 진행중입니다．\n다른 좌석을 선택해주세요.', 400, 250);	//선택하신　좌석은　이미　판매가　진행중입니다．\\n다른　좌석을　선택해주세요.
                        return;
                    }
                }
            });

        }


        //로그인여부 체크
        function fn_validLoginAt(param) {
            $.ajaxMegaBox({
                url: "/on/oh/ohg/MbLogin/selectLoginSession.do",
                //data   : JSON.stringify(paramData),
                success: function (result) {
                    var loginAt = result.resultMap.result;	//로그인 여부

                    //비로그인 상태
                    if (loginAt == "N" && sellChnlCd == "") {
                        //로그인 팝업 표시
                        fn_viewLoginPopup('SimpleBokdM', 'pc', 'Y', JSON.stringify(param));
                    }
                    //비로그인상태 RIA
                    else if (loginAt == "N" && sellChnlCd != "") {
                        gfn_alertMsgBoxSize('로그인이 필요한 서비스 입니다.', 400, 250);	//로그인이 필요한 서비스 입니다.
                        fn_riaLoginInputToggle(false);
                    }
                    //로그인 상태
                    else {
                        //데이터 보정 체크
                        fn_validDataRevisn(param);
                    }
                }
            });
        }


        //로그인여부 체크
        function fn_testLoginAt() {
            $.ajaxMegaBox({
                url: "/on/oh/ohg/MbLogin/selectLoginSession.do",
                //data   : JSON.stringify(paramData),
                success: function (result) {
                    var loginAt = result.resultMap.result;	//로그인 여부
                    alert(loginAt);
                }
            });
        }


        //RIA 로그인 토글
        function fn_setRiaLoginToggle(riaLoginAtArrayParam) {	//0 : 로그인여부, 1:riaName, 2:riaBirthday, 3:riaMobileNo
            var ajaxUrl = "";
            var paramData = "";
            var riaLoginAt = riaLoginAtArrayParam[0];
            var riaName = "";
            var riaBirthday = "";
            var riaMobileNo = "";

            if ("Y" == riaLoginAt) {
                //로그아웃
                ajaxUrl = "/on/oh/ohg/MbLogin/riaLogOut.do";
            }
            else {
                //로그인
                ajaxUrl = "/on/oh/ohg/MbLogin/selectRiaLoginInfo.rest";

                //파라메타 생성
                riaName = riaLoginAtArrayParam[1];
                riaBirthday = riaLoginAtArrayParam[2];
                riaMobileNo = riaLoginAtArrayParam[3];

                paramData = { name: riaName, birthday: riaBirthday, mobileNo: riaMobileNo, sellChnlCd: sellChnlCd };
            }
            //로그인 또는 로그아웃
            $.ajaxMegaBox({
                url: ajaxUrl,
                data: JSON.stringify(paramData),
                success: function (result) {
                    //전역변수 토글
                    //로그인 여부 변경
                    if (typeof result.resultMap != 'undefined' && result.resultMap.memberYn != null && result.resultMap.memberYn != "") {
                        riaLoginAtArrayParam[0] = "Y";							//로그인여부
                        riaLoginAtArrayParam[1] = result.resultMap.name;		//이름
                        riaLoginAtArrayParam.push(result.resultMap.memberYn);	//회원여부
                        riaLoginAtArrayParam.push(result.resultMap.riaLoginId);	//로그인ID
                    }
                    else {
                        riaLoginAtArrayParam[0] = "N";	//로그인여부
                        riaLoginAtArrayParam.push("N");	//회원여부
                        if ("N" == riaLoginAt)
                            gfn_alertMsgBoxSize('이름은  필수 입력 항목 입니다.', 400, 250);	//{0} 필수 입력 항목 입니다.
                    }

                    fn_riaLoginGVToggle(riaLoginAtArrayParam);

                    //RIA 로그인 입력창 토글
                    fn_riaLoginInputToggle("N" == riaLoginAtArrayParam[0] ? false : true);
                }
            });
        }

        //RIA 전역변수 토글
        function fn_riaLoginGVToggle(arrayParam) {
            //로그인 상태에서 로그아웃 상태로 갈때
            if ("N" == arrayParam[0]) {
                riaLoginAt = 'N'; //메가박스 로그인여부
                riaParamName = arrayParam[1];  //고객명
                riaParamBirthday = arrayParam[2];  //고객생년월일
                riaParamMobileNo = arrayParam[3];  //고객전화번호
                riaMemberYn = typeof arrayParam == undefined || arrayParam == "" || arrayParam == null ? "N" : arrayParam[5]; //메가박스 회원여부
                riaLoginId = '';  //로그인ID

            }
            else {
                riaLoginAt = arrayParam[0];  //메가박스 로그인여부
                riaParamName = arrayParam[1];  //고객명
                riaParamBirthday = arrayParam[2];  //고객생년월일
                riaParamMobileNo = arrayParam[3];  //고객전화번호
                riaMemberYn = arrayParam[4];  //메가박스 회원여부
                riaLoginId = arrayParam[5];  //로그인ID
            }
        }

        //RIA 로그인 입력창 토글
        function fn_riaLoginInputToggle(inputAbleAt) {
            var frameBokdMBookingBodyObj = $('#frameBokdMBooking').get(0).contentWindow.document.body;	//빠른예매 프레임 바디 오브젝트
            var frameBokdMBookingContentObj = $('#frameBokdMBooking').get(0).contentWindow;
            var frameBokdMSeatBodyObj = $('#frameBokdMSeat').get(0).contentWindow.document.body;	//좌석도 프레임 바디 오브젝트
            var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
            var framePayBookingBodyObj = $('#framePayBooking').get(0).contentWindow.document.body;	//결제화면 프레임 바디 오브젝트
            var framePayBookingContentObj = $('#framePayBooking').get(0).contentWindow;
            var riaMemberInputText = "";
            var riaMemberButtonText = "";

            //로그인 버튼 텍스트 생성
            //로그인 되어 있는경우
            if ("Y" == riaLoginAt) {
                //
                if ("Y" == riaMemberYn) {
                    riaMemberInputText = "회원";
                    riaMemberButtonText = "재인증";
                    msgStr = riaParamName + "(" + riaLoginId + ") 고객님의 회원 정보가 적용되었습니다.";
                }
                else {
                    riaMemberInputText = "비회원";
                    riaMemberButtonText = "재인증";
                    msgStr = "해당 회원 정보가 없습니다. 비회원으로 예매를 진행합니다.";
                }
            }
            //로그인 되어 있지 않은경우
            else {
                msgStr = "";
                riaMemberButtonText = "인증요청";
            }


            $(frameBokdMBookingBodyObj).find('.cti-area input[name=riaName]').val(riaParamName);	//고객명
            $(frameBokdMBookingBodyObj).find('.cti-area input[name=riaMobileNo]').val(riaParamMobileNo);	//고객전화번호
            $(frameBokdMBookingBodyObj).find('.cti-area input[name=riaBirthday]').val(riaParamBirthday);	//고객생년월일
            $(frameBokdMBookingBodyObj).find('.cti-area input[name=riaMemberYn]').val(riaMemberInputText);	//회원여부

            $(frameBokdMBookingBodyObj).find('.cti-area input[name=riaName]').attr("readonly", inputAbleAt);		//고객명
            $(frameBokdMBookingBodyObj).find('.cti-area input[name=riaMobileNo]').attr("readonly", inputAbleAt);	//고객전화번호
            $(frameBokdMBookingBodyObj).find('.cti-area input[name=riaBirthday]').attr("readonly", inputAbleAt);	//고객생년월일
            $(frameBokdMBookingBodyObj).find('.cti-area button').attr('login-at', riaLoginAt);	//회원여부
            $(frameBokdMBookingBodyObj).find('.cti-area button').html(riaMemberButtonText);

            //좌석도
            $(frameBokdMSeatBodyObj).find('.cti-area input[name=riaName]').val(riaParamName);	//고객명
            $(frameBokdMSeatBodyObj).find('.cti-area input[name=riaMobileNo]').val(riaParamMobileNo);	//고객전화번호
            $(frameBokdMSeatBodyObj).find('.cti-area input[name=riaBirthday]').val(riaParamBirthday);	//고객생년월일
            $(frameBokdMSeatBodyObj).find('.cti-area input[name=riaMemberYn]').val(riaMemberInputText);	//회원여부

            $(frameBokdMSeatBodyObj).find('.cti-area input[name=riaName]').attr("readonly", inputAbleAt);		//고객명
            $(frameBokdMSeatBodyObj).find('.cti-area input[name=riaMobileNo]').attr("readonly", inputAbleAt);	//고객전화번호
            $(frameBokdMSeatBodyObj).find('.cti-area input[name=riaBirthday]').attr("readonly", inputAbleAt);	//고객생년월일
            $(frameBokdMSeatBodyObj).find('.cti-area button').attr('login-at', riaLoginAt);	//회원여부
            $(frameBokdMSeatBodyObj).find('.cti-area button').html(riaMemberButtonText);

            //결제
            $(framePayBookingBodyObj).find('.cti-area input[name=riaName]').val(riaParamName);	//고객명
            $(framePayBookingBodyObj).find('.cti-area input[name=riaMobileNo]').val(riaParamMobileNo);	//고객전화번호
            $(framePayBookingBodyObj).find('.cti-area input[name=riaBirthday]').val(riaParamBirthday);	//고객생년월일
            $(framePayBookingBodyObj).find('.cti-area input[name=riaMemberYn]').val(riaMemberInputText);	//회원여부

            $(framePayBookingBodyObj).find('.cti-area input[name=riaName]').attr("readonly", inputAbleAt);		//고객명
            $(framePayBookingBodyObj).find('.cti-area input[name=riaMobileNo]').attr("readonly", inputAbleAt);	//고객전화번호
            $(framePayBookingBodyObj).find('.cti-area input[name=riaBirthday]').attr("readonly", inputAbleAt);	//고객생년월일
            $(framePayBookingBodyObj).find('.cti-area button').attr('login-at', riaLoginAt);	//회원여부

            fn_getMsgStrToAlert();

        }


        function fn_getMsgStrToAlert() {
            if (sellChnlCd == "TELLER" && msgStr != "") {
                gfn_alertMsgBox(msgStr);
            }
        }


        //데이터 보정 체크 데이터 보정 체크 안함 김민영과장 2019-12-02
        function fn_validDataRevisn(param) {
            fn_vlaidBlackList(param);

            // 	$.ajaxMegaBox({
            //         url    : "/on/oh/ohg/MbLogin/selectDataRevisn.do",
            //         //data   : JSON.stringify(paramData),
            //         success: function(result){
            //         	var dataRevisnAt = result.resultMap.result;	//로그인 여부

            //         	//자료보정대상
            // 			if(dataRevisnAt  == "Y" && sellChnlCd == ""){
            // 				//자료 보정 안내 메세지 표시
            // 				var arguments=result.resultMap.birthDe+' / '+result.resultMap.mblpTelno;
            // 				var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;	//좌석도 프레임 컨텐츠 오브젝트
            // 				frameBokdMSeatContentObj.shwoDataRevisnPopup(arguments,param);
            //  			}
            //  			//자료보정대상아님
            //  			else {
            //  				//블랙리스트 체크
            // 				fn_vlaidBlackList(param);
            //  			}
            //         }
            //     });
        }

        //블랙리스트 체크
        function fn_vlaidBlackList(param) {
            var paramData = {
                BokdCnt: param.bokdCnt
                , BokdBrch: param.brchNo
            };
            // 	//좌석수 param
            $.ajaxMegaBox({
                url: "/on/oh/ohg/MbLogin/selectBlackList.do",
                data: JSON.stringify(paramData),
                success: function (result) {
                    var dataBlackListAt = result.resultMap.result;
                    //블랙리스트 대상
                    //dataBlackListAt = "N";	//주희연 통테 테스트용 블랙리스트 체크 제외 로직 삽입. 20191118
                    if (dataBlackListAt == "Y") {
                        //블랙리스트 안내 메세지 표시
                        var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
                        var blackListParam = {
                            bokdAbleBrch: result.resultMap.bokdAbleBrch
                            , bokdAbleCnt: result.resultMap.bokdAbleCnt
                            , bokdAbleQty: result.resultMap.bokdAbleQty
                        }
                        frameBokdMSeatContentObj.shwoBlackListPopup(blackListParam);
                    }
                    //블랙리스트 비 대상
                    else {
                        //결제로 이동
                        fn_setBookingParamMove(param);
                    }
                }
            });
        }

        //페이지 이동
        function fn_mvPage(page) {
            $("#bokdMForm").attr("method", "post");
            $("#bokdMForm").attr("action", page);
            $("#bokdMForm").submit();
        }


        //언어변환
        function setLangChg() {
            if (localeCode == "en") {
                location.href = "/booking?megaboxLanguage=kr";
            }
            else {
                location.href = "/booking?megaboxLanguage=en";
            }
        }

        //페이지 리로드
        function fn_bokdReload(page) {
            $("#bokdMForm").attr("method", "post");
            $("#bokdMForm").attr("action", page);
            $("#bokdMForm").submit();
        }


        $(window).on("beforeunload", function () {

            //결제 페이지 이동시
            if ($("#framePayBooking").contents().find("#completeYn").val() != 'Y' &&
                $("#framePayBooking").contents().find("#prepareYn").val() == 'Y') {

                $.ajaxMegaBox({
                    url: '/on/oh/ohg/MbLogin/nonMbLogout.do',
                    success: function (result) {

                        //console.log("result : "+result);
                    },
                    complete: function () {

                        //console.log("?");
                    }
                });
            }

        });


    </script>
    <script src="js/jquery-3.5.1.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/jquery-ui.1.12.1.js"></script>
    <script src="js/gsap.min.js"></script>
    <script src="js/jquery.mCustomScrollbar.concat.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/bootstrap-custom.js"></script>
    <script src="js/bootstrap-select.js"></script>
    <script type="text/javascript" src="js/netfunnel.js" charset="UTF-8"></script>
    <script type="text/javascript" src="js/netfunnel_skin.js" charset="UTF-8"></script>
    <script type="text/javascript" src="js/netfunnel_frm.js" charset="UTF-8"></script>
    <script src="js/megaboxCom.js"></script>
    <script src="js/mega.prototype.js"></script>
    <script src="js/lozad.min.js"></script>
    <script src="js/commons.js"></script>
    <script src="js/swiper-bundle.min.js"></script>
    <script src="js/masonry.pkgd.min.js"></script>
    <script type="text/javascript">
        var _init = {
            cache: Date.now(),
            path: '/static/pc/js/'
        };
        document.write(
            '<script src="' + _init.path + 'ui.common.js?v=' + _init.cache + '"><\/script>' +
            '<script src="' + _init.path + 'front.js?v=' + _init.cache + '"><\/script>'
        );

        //링크 구분에 따라 url 이동을 한다.
        function fn_goMoveLink(link_gbn, link_url) {
            alert("준비중 입니다");
            return;
        }
    </script>
    <script src="js/ui.common.js"></script>
    <script src="js/front.js"></script>
    <script type="text/javascript">
        var debug = "N";
        var fn_debugger = function () { if (debug == "") { debugger; } }
        var localeCode = 'kr';


        var seat = {};
        seat.classCodeT = {

            "GERN_CLS": ["common", "일반석", "(영)일반석", "clsGernAmt", 1, 1, 'A0', "Y", 'N', 'N', [1, 2, 3, 4, 5, 6, 7, 8], "N,N,N,N"],
            "DISABLED_CLS": ["disabled", "장애인/휠체어석", "(영)장애인/휠체어석", "clsDisabledAmt", 2, 1, 'A0', "N", 'Y', 'Y', [1, 2, 3, 4, 5, 6, 7, 8], "N,N,N,N"],
            "KIDS_CLS": ["kids", "키즈석", "(영)키즈석", "clsKidsAmt", 3, 1, 'A0', "N", 'N', 'Y', [1, 2, 3, 4, 5, 6, 7, 8], "A,Y,N,S"],
            "TABLE_CLS": ["table", "테이블석", "(영)테이블석", "clsTableAmt", 4, 1, 'D1', "N", 'N', 'Y', [1, 2, 3, 4, 5, 6, 7, 8], "N,N,N,N"],
            "2P_CLS": ["sofa2", "2인소파석", "(영)2인소파석", "cls2pAmt", 5, 2, 'E1', "N", 'Y', 'Y', [1, 2], "N,Y,C,S"],
            "4P_CLS": ["sofa4", "4인소파석", "(영)4인소파석", "cls4pAmt", 6, 4, 'F1', "N", 'Y', 'Y', [1, 2, 3, 4], "N,Y,C,S"],
            "BALCONY_CLS": ["balcony", "발코니석", "(영)발코니석", "clsBalconyAmt", 7, 4, 'G1', "N", 'Y', 'Y', [1, 2, 3, 4], "N,Y,C,S"],
            "BALCONY2_CLS": ["balcony-d", "발코디럭스석", "(영)발코디럭스석", "clsBalcony2Amt", 8, 4, 'H1', "N", 'Y', 'Y', [1, 2, 3, 4], "N,Y,C,S"],
            "ROYAL_CLS": ["royal", "로얄석", "(영)로얄석", "clsRoyalAmt", 9, 1, 'I1', "N", 'N', 'Y', [1, 2, 3, 4, 5, 6, 7, 8], "N,N,N,N"],
            "SPECIAL_CLS": ["special", "스페셜석", "(영)스페셜석", "clsSpecialAmt", 10, 1, 'J1', "N", 'N', 'Y', [1, 2, 3, 4, 5, 6, 7, 8], "N,N,N,N"],
            "SWEET_CLS": ["sweet", "스위트석", "(영)스위트석", "clsSweetAmt", 11, 1, 'K1', "N", 'N', 'Y', [1, 2, 3, 4, 5, 6, 7, 8], "N,N,N,N"],
            "COUPLE_CLS": ["couple", "커플석", "(영)커플석", "clsCoupleAmt", 12, 1, 'L1', "N", 'N', 'Y', [2, 4, 6, 8], "N,N,C,N"]
        };
        seat.classCode = {};

        seat.classCode.field = {};
        seat.classCode.field.css = 0;
        seat.classCode.field.nameKr = 1;
        seat.classCode.field.nameUs = 2;
        seat.classCode.field.amtName = 3;
        seat.classCode.field.orderNo = 4;
        seat.classCode.field.seatToCnt = 5;
        seat.classCode.field.crsChoi = 6;
        seat.classCode.field.zoneAdoptAt = 7;
        seat.classCode.field.connExcp = 8;
        seat.classCode.field.deadExcp = 9;
        seat.classCode.field.choiAbleCnt = 10;
        seat.classCode.field.notTicketAbleAt = 11;
        seat.classCode.field.name = (localeCode == 'kr' ? seat.classCode.field.nameKr : seat.classCode.field.nameUs);



        seat.classCode.deadExcp = "";
        seat.classCode.connExcp = "";
        seat.classCode.choiAbleList = [];
        seat.classCode.crsChoiMap = {};
        seat.choiAbleCntArray = {};
        seat.classCode.getCdList = function (index, ynAt) {
            ynAt = ynAt || "Y";
            return $(Object.entries(seat.classCode)).map(function (i, o) { if (o[1][index] == ynAt) { return o[0] } else { return null; } });
        }

        seat.zoneCd = {
            "GERN_ZONE": ["standard", "스탠다드", 0, "Y",],
            "ECON_ZONE": ["economy", "이코노미", 1, "Y",],
            "PRIM_ZONE": ["premium", "프리미엄", 2, "Y",]
        };
        seat.choiZoneMap = {};
        seat.zoneList = [];
        seat.zoneList_init = function () {
            seat.zoneList = [];
            seat.zoneList = $(Object.entries(seat.zoneCd)).sort(function (b, a) { return a[1][2] - b[1][2]; }).map(function (i, o) {
                if (o[1][3] == "Y") {
                    var rtnMap = {};
                    rtnMap.zoneCd = o[0];
                    rtnMap.orderNo = o[1][2];
                    rtnMap.totCount = 0;
                    return rtnMap;
                } else {
                    return null;
                }
            });
        }


        seat.sellTyCode = {
            "GERN_SELL": ["", "판매가능"],
            "SPARE_SELL": ["finish", "예약완료"],
            "STOP_SELL": ["impossible", "선택불가"]
        };


        seat.gateTyCd = {
            "GTL": ["/static/pc/images/reserve/img-door-left.png", "좌측", "(영)좌측"],
            "GTR": ["/static/pc/images/reserve/img-door-right.png", "우측", "(영)우측"],
            "GTU": ["/static/pc/images/reserve/img-door-top.png", "상단측", "(영)상단측"],
            "GTD": ["/static/pc/images/reserve/img-door-bottom.png", "하단측", "(영)하단측"],
            "GTLR": ["/static/pc/images/reserve/img-door-left-right.png", "좌우측", "(영)좌우측"],
            "GTUD": ["/static/pc/images/reserve/img-door-top-bottom.png", "상하단측", "(영)상하단측"],
            _initDoorClass: "mCS_img_loaded"
        };


        seat.init = function () {
            seat.classCode.deadExcp = seat.classCode.getCdList(seat.classCode.field.deadExcp).get().join(":");
            seat.classCode.connExcp = seat.classCode.getCdList(seat.classCode.field.connExcp).get().join(":");
            seat.classCode.choiAbleList = [];
            seat.choiAbleCntArray = {};
            seat.zoneList_init();
            seat.choiZoneMap = {};
        }

        var ticket = {};
        ticket.amtType = "";
        ticket.GERN_ZONE = [2, "zoneGernAmt", 2];
        ticket.ECON_ZONE = [3, "zoneEconAmt", 1];
        ticket.PRIM_ZONE = [4, "zonePrimAmt", 3];
        ticket.grpPayList = [];
        ticket.grpPayList_setTotCount = function () {
            ticket.grpPayList.each(function (i, map) {
                map.totCount = parseInt($("div.number > button[ticketGrpCd='" + map.grpCd + "']").text());
            });
        }

        ticket.payQueue = [];


        ticket.init = function () {
            ticket.payQueue = [];
        }


        var seatInitVal = {
            _initLeft: 110,
            _initTop: 30,
            _width: 20,
            _height: 20,
            _stepWidth: 20,
            _stepHeight: 20,
            _reWidth: 0,
            _colSize: 0,
            _initClass: "jq-tooltip seat-condition"
        };

        var seatInitRowNm = {
            _left: 85,
            _top: 32,
            _stepHeight: seatInitVal._stepHeight
        };


        var seatMapInfo = {
            MAX_PERSON: 8,
            totCount: 0,
            selectedCount: 0,
            selectedMap: {},
            fn_init: function () {
                this.totCount = 0;
                this.selectedCount = 0;
                this.selectedMap = {};
            },
            get activeCount() {
                return this.totCount - this.selectedCount;
            }
        }


        var playTimesDivPopupMsg = "";



        var seatTicketCdPopupMsg = [];


        var movieAdmisClassCd = "";


        var fn_seatPolicy = function (List) {
            var policy = List.SeatPolicyList;
            for (var i = 0; i < policy.length; i++) {
                policyInfo = policy[i];
                if (policyInfo) {
                    //seat.classCode[policyInfo.classCode] = [policyInfo.class,    policyInfo.nameKor,     policyInfo.nameEng,        policyInfo.amtName, policyInfo.orderNo,    policyInfo.seatToCnt,   policyInfo.crsChoi,    policyInfo.zoneAdoptAt, policyInfo.connExcp,    policyInfo.deadExcp,    eval(policyInfo.choiAbleCnt),     policyInfo.notTicketAbleAt];
                    seat.classCode[policyInfo.seatClassCd] = [policyInfo.classVal, policyInfo.seatClassNm, policyInfo.seatClassEngNm, policyInfo.pcNm, policyInfo.sortOrdVal, policyInfo.seatPcntCnt, policyInfo.choiGrpVal, policyInfo.zoneAdoptAt, policyInfo.connExcpVal, policyInfo.choiExcpVal, eval(policyInfo.choiAbleSeatCnt), policyInfo.bnduntChoiAt];
                }
            }
        }

        var fn_seatMapDisplay = function (result) {
            seat.init();
            ticket.init();
            seatMapInfo.fn_init();
            fn_setSeatAmt(result["seatTicketAmtList"], result["seatClassCdList"]);
            fn_ticketDisplay();
            fn_seatDisplaySD01(result["seatListSD01"], result["seatInfoSD01"]);
            fn_seatEvent();
            fn_seatDisplaySD05(result["seatListSD05"]);

            // 임시 안심띄어앉기석 이 존재하면 범례추가를 위해
            var pos = false;
            for (var i = 0; i < result.seatListSD01.length; i++) {
                if (result.seatListSD01[i].seatStatCd == "STOP_SELL") {
                    pos = true;
                    break;
                }
            }

            fn_choiAbleListDisplay(pos);
            fn_myseat();
            fn_choiZoneListDisplay();
            fn_movieDtlInfoDisplay(result["movieDtlInfo"], result["playSeqList"]);
            result.popUp.movieDtlInfo = result["movieDtlInfo"];
            fn_popUp(result.popUp);
        }

        var fn_popUp = function (popUp) {

            if (popUp.playTimesDivPopup != null) {
                msg = localeCode == "en" ? popUp.playTimesDivPopup.popupEngMsg : popUp.playTimesDivPopup.popupKorMsg;
                if (msg != null) {
                    playTimesDivPopupMsg = msg;
                }
            }

            if (popUp.seatClassCdPopUpMap != null) {
                var seatClassPopupList = Object.entries(popUp.seatClassCdPopUpMap).map(function (o, i) { return { seatClassCd: o[0], popupWebKorMsg: localeCode == 'kr' ? o[1].popupWebKorMsg : o[1].popupWebEngMsg }; });
                if (seatClassPopupList.length == 0) {
                    if (!$("div.seat-area").hasClass("has-alert")) $("div.seat-area").removeClass("has-alert");
                } else {
                    if (!$("div.seat-area").hasClass("has-alert")) $("div.seat-area").addClass("has-alert");
                    $("div.seat-layout > div.alert").html("");
                    var alertHtml = "";
                    seatClassPopupList.forEach(function (o) {
                        alertHtml += " <div class='box-alert'> <strong>[알림]</strong>";
                        alertHtml += " <span>" + gfn_charToHtml(o.popupWebKorMsg) + "</span>";
                        alertHtml += " <button type='button' class='btn-close-small'>삭제</button>";
                        alertHtml += " </div>";
                    });
                    $("div.seat-layout > div.alert").html(alertHtml);
                    $("div.seat-layout > div.alert").show();
                }
            }

            if (popUp.seatTicketCdPopupMap != null) {

                Object.entries(popUp.seatTicketCdPopupMap).forEach(function (o, i) {
                    msg = localeCode == "en" ? o[1].popupEngMsg : o[1].popupKorMsg;

                    seatTicketCdPopupMsg.push({ ticketCd: o[1].ticketCd, Msg: msg })
                });

            }

            if (popUp.rfndDivPopup != null) {
                msg = localeCode == "en" ? popUp.rfndDivPopup.popupEngMsg : popUp.rfndDivPopup.popupKorMsg;
                if (msg != null) {
                    var options = {};
                    options.msg = gfn_charToHtml(msg);
                    options.minWidth = 500;
                    options.minHeight = 250;
                    gfn_alertMsgBox(options);
                }
                //$("div.wrap > div.layer-con").children("p").addClass("scroll");
                $("div.wrap > div.layer-con").children("p.txt-common").addClass("scroll");

            }

            if (popUp.movieAdmisClassPopup != null) {
                var alertAgeLayerHtml = "";
                var classNum = popUp.movieDtlInfo.admisClassCd ? ["all", "12", "15", "19", "", ""][["AD01", "AD02", "AD03", "AD04", "AD05", "AD06"].indexOf(popUp.movieDtlInfo.admisClassCd)] : "";
                var classNm = classNum;

                if (classNum != "") {
                    if (classNum == "all") classNm = "All";

                    alertAgeLayerHtml += " <div class='alert-age-layer " + "age" + classNum + "'>";
                    alertAgeLayerHtml += " <div class='age-box " + "age-" + classNum + "'>";
                    alertAgeLayerHtml += " <div class='left'>";
                    alertAgeLayerHtml += " <p class='circle'>" + classNm + "</p>";
                    alertAgeLayerHtml += " </div>";
                    alertAgeLayerHtml += " <div class='right'>";
                    alertAgeLayerHtml += " <p class='tit'>" + popUp.movieDtlInfo.admisClassName + "</p>";
                    alertAgeLayerHtml += " <p class='txt'></p>";
                    alertAgeLayerHtml += " </div>";
                    alertAgeLayerHtml += " </div>";
                    alertAgeLayerHtml += " </div>";
                    $("section#layer_age_alert > div.wrap > div.layer-con").html(alertAgeLayerHtml);
                    $("section#layer_age_alert > div.wrap > div.layer-con > div.alert-age-layer > div.age-box > div.right > p.txt").html($.parseHTML(localeCode == 'kr' ? popUp.movieAdmisClassPopup.popupWebKorMsg : popUp.movieAdmisClassPopup.popupWebEngMsg)[0].textContent);
                    $("section#layer_age_alert").attr("style", "z-index: 900");
                    $modal('layer_age_alert');
                }
            }
        }



        var fn_setSeatAmt = function (seatTicketAmtList, seatClassCdList) {
            var amtName = "";
            ticket.grpPayList = [];
            ticket.grpPayList = $(seatTicketAmtList.map(function (o, i) {
                var rtnMap = {};
                rtnMap.grpCd = o.ticketKindCd;
                rtnMap.ticketOrder = o.ticketOrder;
                rtnMap.grpNm = (localeCode == 'kr' ? o.ticketTypeName : o.ticketTypeNameEng);
                rtnMap.totCount = 0;
                rtnMap[ticket.ECON_ZONE[1]] = o[ticket.ECON_ZONE[1]];
                rtnMap[ticket.GERN_ZONE[1]] = o[ticket.GERN_ZONE[1]];
                rtnMap[ticket.PRIM_ZONE[1]] = o[ticket.PRIM_ZONE[1]];
                seatClassCdList.forEach(function (p, i) {

                    amtName = seat.classCode[p.seatClassCd][seat.classCode.field.amtName];
                    rtnMap[amtName] = o[amtName];
                });
                return rtnMap;
            }));
        }


        var fn_ticketDisplay = function () {
            $("div.seat-count").html("");
            var ticketLayoutHtml = "";
            for (var i = 0; i < ticket.grpPayList.length; i++) {
                var map = ticket.grpPayList[i];
                ticketLayoutHtml += "<div class='cell'>";
                ticketLayoutHtml += "<p class='txt'>" + map.grpNm + "</p>";
                ticketLayoutHtml += "<div class='count'>";
                ticketLayoutHtml += "<button type='button' class='down' title='" + map.grpNm + " 좌석 선택 감소'>-</button>";
                ticketLayoutHtml += "<div class='number'>";
                ticketLayoutHtml += "<button type='button' class='now' title='" + map.grpNm + " 현재 좌석 선택 수' ticketGrpCd='" + map.grpCd + "'>0</button>";
                ticketLayoutHtml += "<ul class='num-choice'>";
                ticketLayoutHtml += $(Array(seatMapInfo.MAX_PERSON + 1)).map(function (i) { return "<li><button type='button' class='btn" + (i == 0 ? " on" : "") + "'>" + i + "</button></li>"; }).get().join(" ")
                ticketLayoutHtml += "</ul>";
                ticketLayoutHtml += "</div>";
                ticketLayoutHtml += "<button type='button' class='up' title='" + map.grpNm + " 좌석 선택 증가'>+</button>";
                ticketLayoutHtml += "</div>";
                ticketLayoutHtml += "</div>";
            }
            $("div.seat-count").html(ticketLayoutHtml);
            fn_ticketEvent();
        }


        var fn_seatDisplaySD01 = function (seatList, info) {
            var cellInfo;
            seatInitVal._colSize = info.colNoMax - info.colNoMin + 1;
            seatInitVal._reWidth = parseInt(($("div#seatLayout").width() - (seatInitVal._colSize * seatInitVal._width)) / 2) - 0;
            seatInitVal._initLeft = seatInitVal._reWidth;
            seatInitRowNm._left = seatInitVal._reWidth - 25;

            var layoutHight = info.rowNoMax * seatInitVal._stepHeight + seatInitVal._initTop + 20;
            //                            + seatInitVal._initTop ;

            var _title = "";
            var _class = "";
            var _left = 0;
            var _top = 0;
            var _width = 0;
            var _attr = "";
            var _stylePosition = "";
            var _stylePositionRowNm = "";
            var sd01Seat = [];
            var choiAblefilterList = [];
            var seatToCnt = 0;
            seatList.forEach(function (cellInfo, i) {
                if (cellInfo) {
                    try {

                        seatToCnt = seat.classCode[cellInfo.seatClassCd][seat.classCode.field.seatToCnt];


                        choiAblefilterList = seat.classCode.choiAbleList.filter(function (o, i) { return o.seatClassCd == cellInfo.seatClassCd; });
                        if (choiAblefilterList.length < 1) {

                            seat.classCode.choiAbleList.push({ seatClassCd: cellInfo.seatClassCd, count: seatToCnt, selectCount: 0, crsChoiGroup: seat.classCode[cellInfo.seatClassCd][seat.classCode.field.crsChoi] });
                        } else {

                            choiAblefilterList[0].count += seatToCnt;
                        }

                        if (seat.choiZoneMap[cellInfo.seatZoneCd]) {
                            seat.choiZoneMap[cellInfo.seatZoneCd].count += seatToCnt;
                        } else {

                            seat.choiZoneMap[cellInfo.seatZoneCd] = {};
                            seat.choiZoneMap[cellInfo.seatZoneCd].count = seatToCnt;
                        }

                        _class = seatInitVal._initClass + " ";
                        _class += seat.zoneCd[cellInfo.seatZoneCd][0] + " ";

                        if (cellInfo.seatStatCd == "GERN_SELL") {
                            _class += seat.classCode[cellInfo.seatClassCd][seat.classCode.field.css];
                        } else if (cellInfo.seatStatCd == "STOP_SELL") {
                            _class += "finish pos";
                        } else {
                            _class += "finish";
                        }
                        _left = seatInitVal._initLeft + (seatInitVal._stepWidth * (cellInfo.horzCoorVal));
                        _top = seatInitVal._initTop + (seatInitVal._stepHeight * (cellInfo.vertCoorVal));
                        _width = seatInitVal._width * parseInt(cellInfo.horzSizeRt);
                        if (seatToCnt > 1) {
                            _width = seatInitVal._width * parseInt(seatToCnt);
                            if (cellInfo.seatChoiGrpSeq > 1) {
                                return true;
                            }
                        }

                        _stylePosition = "' style='position:absolute; left:" + _left + "px; top:" + _top + "px; width:" + _width + "px;' ";

                        _left = seatInitRowNm._left;
                        _top = ((seatInitRowNm._stepHeight * cellInfo.vertCoorVal) + seatInitRowNm._top);
                        _stylePositionRowNm = "' style='position:absolute; left:" + _left + "px; top:" + _top + "px;'";
                        _attr = Object.entries(seat.classCode).filter(function (o, i) { return o[1][seat.classCode.field.seatToCnt] > 1 && o[0] == cellInfo.seatClassCd; }).length > 0 ? seat.classCode[cellInfo.seatClassCd][seat.classCode.field.css] + "_seatGrpNo_" + cellInfo.seatGrpNo : "";
                        _attr = (_attr == "") ? "" : " seatGrpNo=" + _attr;
                        _attr += " seatClassCd='" + cellInfo.seatClassCd + "'";
                        _attr += " seatZoneCd='" + cellInfo.seatZoneCd + "'";
                        _attr += " seatUniqNo='" + cellInfo.seatUniqNo + "'";
                        _attr += " rowNm='" + cellInfo.rowNm + "'";
                        _attr += " seatNo='" + cellInfo.seatNo + "'";
                        _attr += " seatChoiDircVal='" + cellInfo.seatChoiDircVal + "'";
                        _attr += " seatChoiGrpNo='" + cellInfo.seatChoiGrpNo + "'";
                        _attr += " seatChoiGrpNm='" + cellInfo.seatChoiGrpNm + "'";
                        _attr += " seatChoiRowCnt='" + cellInfo.seatChoiRowCnt + "'";
                        _attr += " seatChoiGrpSeq='" + cellInfo.seatChoiGrpSeq + "'";
                        _attr += " seatToCnt='" + seatToCnt + "'";
                        _attr += (cellInfo.seatNotiMsg != "" && cellInfo.seatNotiMsg != null ? " seatNotiMsg='" + cellInfo.seatNotiMsg + "'" : "");


                        _title = cellInfo.rowNm + "" + cellInfo.seatNo + " (" + seat.zoneCd[cellInfo.seatZoneCd][1] + "/" + seat.classCode[cellInfo.seatClassCd][seat.classCode.field.name] + ")";

                        if (!sd01Seat[cellInfo.rowNo]) sd01Seat[cellInfo.rowNo] = " <button type='button' class='btn-seat-row' title='" + cellInfo.rowNm + " 행" + _stylePositionRowNm + ">" + cellInfo.rowNm + "</button>"

                        sd01Seat[cellInfo.rowNo] += "<button type='button' title='" + _title + "' class='" + _class + _stylePosition + _attr + ">";
                        sd01Seat[cellInfo.rowNo] += "<span class='num'>" + cellInfo.seatNo + "</span>";
                        sd01Seat[cellInfo.rowNo] += "<span class='kind'>" + seat.zoneCd[cellInfo.seatZoneCd][1] + "</span>";
                        sd01Seat[cellInfo.rowNo] += "<span class='condition'>" + seat.sellTyCode[cellInfo.seatSellTyCd][1] + "</span>";
                        sd01Seat[cellInfo.rowNo] += "<span class='rank'>" + seat.classCode[cellInfo.seatClassCd][seat.classCode.field.name] + "</span>";
                        sd01Seat[cellInfo.rowNo] += "</button>";
                    } catch (e) {
                        console.log(e);
                    }
                }
            });

            seat.classCode.choiAbleList.sort(function (a, b) {
                return seat.classCode[a.seatClassCd][seat.classCode.field.orderNo] - seat.classCode[b.seatClassCd][seat.classCode.field.orderNo];
            });

            //$("div#seatLayout").css("height" , "600px");
            $("div#seatLayout").css("height", layoutHight + "px");
            $(".seat-select-section .seat-section .seat-area .seat-layout .scroll .mCSB_container").css("height", layoutHight + "px");
            $("div#seatLayout").children().not("[alt='screen']").remove();
            $("div#seatLayout").append("<div class'row'>" + sd01Seat.join(" ") + "</div>");
            $("div#seatLayout").show();

            $('.m-scroll').mCustomScrollbar('update');

        };

        var fn_seatDisplaySD05 = function (list) {
            var cellInfo;
            var _alt = " 출입구";
            var _src = "";
            var _left = 0;
            var _top = 0;
            var _width = 0;
            var stylePosition = "";
            var doorLayoutHtml = "";
            for (var i = 0; i < list.length; i++) {
                cellInfo = list[i];
                if (cellInfo) {
                    _alt = seat.gateTyCd[cellInfo.gateTyCd][1] + _alt;
                    _src = seat.gateTyCd[cellInfo.gateTyCd][0];

                    _left = seatInitVal._initLeft + (seatInitVal._stepWidth * (cellInfo.horzCoorVal + cellInfo.horzPosiRt));
                    _top = seatInitVal._initTop + (seatInitVal._stepHeight * (cellInfo.vertCoorVal + cellInfo.vertPosiRt));
                    _width = seatInitVal._width * parseInt(cellInfo.horzSizeRt);
                    stylePosition = "' style='position:absolute; left:" + _left + "px; top:" + _top + "px; width:16px; height: 16px;'";
                    doorLayoutHtml += " <img src='" + _src + "' alt='" + _alt + stylePosition + "/>";
                }
            }
            $("div#seatLayout").append(doorLayoutHtml);
        };


        var fn_choiAbleListDisplay = function (pos) {
            var choiAbleHtml = "";
            $("div.choice-seat-area div.legend ul.list").html(choiAbleHtml);
            choiAbleHtml += " <li><div class='seat-condition choice'     title='선택한 좌석'></div> <em>선택</em></li>";
            choiAbleHtml += " <li><div class='seat-condition finish'     title='예매 완료'  ></div> <em>예매완료</em></li>";
            choiAbleHtml += " <li><div class='seat-condition impossible' title='선택 불가'  ></div> <em>선택불가</em></li>";
            if (pos) {
                choiAbleHtml += "<li><div class='seat-condition pos' title='띄어앉기석'></div> <em>띄어앉기석</em></li>";
            }
            choiAbleHtml += seat.classCode.choiAbleList.map(function (o, i) { return " <li><div class='seat-condition " + seat.classCode[o.seatClassCd][seat.classCode.field.css] + "' title='" + seat.classCode[o.seatClassCd][seat.classCode.field.name] + "'></div> <em> " + seat.classCode[o.seatClassCd][seat.classCode.field.name] + "</em></li>" }).join(" ");
            $("div.choice-seat-area div.legend ul.list").html(choiAbleHtml);
        }

        var fn_movieDtlInfoDisplay = function (moveInfo, playSeqList) {
            var brchNo = moveInfo.brchNo;
            $('#brchNo').val(brchNo);	//블랙리스트 체크를 위한 파라메타

            var classID = moveInfo.admisClassCd ? ["age-all", "age-12", "age-15", "age-19", "age-no", "age-no"][["AD01", "AD02", "AD03", "AD04", "AD05", "AD06"].indexOf(moveInfo.admisClassCd)] : "age-no";
            var admisClassName, movieNm, playKindName, brchNm, theabNm, movieEventTyName, areaName, playDowNm;

            //전역 변수 (영화관람등급 Setting)
            movieAdmisClassCd = moveInfo.admisClassCd;


            if (localeCode == 'kr') {
                admisClassName = moveInfo.admisClassName;
                movieNm = moveInfo.movieNm;
                childMovieNm = moveInfo.childMovieNm;
                playKindName = moveInfo.playKindName;
                brchNm = moveInfo.brchNm;
                theabNm = moveInfo.theabExpoNm;
                movieEventTyName = moveInfo.movieEventTyName;
                areaName = moveInfo.areaName;
                playDowNm = moveInfo.playDowNm;
            } else {
                admisClassName = moveInfo.admisClassNameEng;
                movieNm = moveInfo.movieNmEng;
                playKindName = moveInfo.playKindNameEng;
                brchNm = moveInfo.brchEngNm;
                theabNm = moveInfo.theabNmEng;
                movieEventTyName = moveInfo.movieEventTyNameEng;
                areaName = moveInfo.areaNameEng;
                playDowNm = moveInfo.playDowNmEng;
            }

            $("div.tit-area  > span.movie-grade").addClass(classID).text(admisClassName);
            $("div.tit-area  > p.tit").html(childMovieNm);
            $("div.tit-area  > p.cate").text((localeCode == 'kr' ? gfn_charToHtml(moveInfo.playKindName) : gfn_charToHtml(moveInfo.playKindNameEng)) + (moveInfo.movieEventTyCd != null ? "/" + movieEventTyName : ""));
            $("div.info-area > p.theater").text(gfn_charToHtml(brchNm));
            $("div.info-area > p.special").text(gfn_charToHtml(theabNm));
            $("div.info-area > p.date").html("<span>" + moveInfo.playDe.maskDate() + "</span>" + "<em>(" + playDowNm + ")</em>");
            $("div.info-area > div.other-time > button.now").html(moveInfo.playStartTime.maskTime() + "~" + moveInfo.playEndTime.maskTime() + "<i class='arr'></i>");
            $("div.info-area > div.other-time > ul.other").html(playSeqList.reduce(function (a, o) {
                a += "<li><button type='button' choiCnt='" + o.choiCnt + "' playSchdlNo='" + o.playSchdlNo + "' class='btn" + (o.playSchdlNo == moveInfo.playSchdlNo ? " on" : "") + " '>" + o.playStartTime.maskTime() + "~" + o.playEndTime.maskTime() + "</button></li>";
                return a;
            }, ""));
            $("div.seat-result p.poster img").attr({ 'src': nvl(moveInfo.imgPath).posterFormat('_150'), 'alt': childMovieNm });

            /*
                for ( var i = 0 ; i < $('.seat-select-section .seat-section .seat-area .seat-count').children().length ; i ++) {
                    var ticketGrpCd     = $(".seat-select-section .seat-section .seat-area .seat-count > div.cell:eq(" + i + ") > div.count > div.number").children("button").attr("ticketGrpCd");
                    var ticketGrpCnt    = parseInt($(".seat-select-section .seat-section .seat-area .seat-count > div.cell:eq(" + i + ") > div.count > div.number").children("button").text());
                    if (movieAdmisClassCd == 'AD04' && (ticketGrpCd=='TKY' || ticketGrpCd=='TKC') ){
                        $(".seat-select-section .seat-section .seat-area .seat-count > div.cell:eq(" + i + ") > div.count").children("button").attr("disabled","disabled");
                        $(".seat-select-section .seat-section .seat-area .seat-count > div.cell:eq(" + i + ") > div.count > div.number").children("button").attr("disabled","disabled");
                    }
                }
            */

            $("div.info-area > div.other-time > ul.other > li > button.btn").unbind("click").bind("click", function () {
                $("#playSchdlNo").val($(this).attr("playSchdlNo"));
                if (parseInt($(this).attr("choiCnt")) < seatMapInfo.totCount) {
                    gfn_alertMsgBox("해당 회차의 잔여 좌석수가 부족합니다.");
                } else {
                    $("div.info-area > div.other-time > ul.other > li > button.btn").removeClass("on");
                    $("div.info-area > div.other-time > button.now").html(" " + $(this).text() + "<i class='arr'></i>");
                    $("div.info-area > div.other-time > button.now > i.arr").click();
                    $(this).addClass("on");
                    fn_search();
                }
            });
        }


        var fn_choiZoneListDisplay = function () {
            var choiZoneHtml = "";
            $("div.zone-legend").hide();
            $("div.zone-legend").html(choiZoneHtml);
            if (Object.entries(seat.choiZoneMap).length <= 1) {
                if (!$("div.seat-area").hasClass("has-zone-legend")) $("div.seat-area").removeClass("has-zone-legend");
                return;
            } else {
                choiZoneHtml += Object.entries(seat.choiZoneMap).sort(function (a, b) { return seat.zoneCd[a[0]][2] - seat.zoneCd[b[0]][2]; }).map(function (o, i) { return "<div class='label " + seat.zoneCd[o[0]][0] + "'>" + seat.zoneCd[o[0]][1] + "</div>" }).join(" ");
                $("div.zone-legend").html(choiZoneHtml);
                if (!$("div.seat-area").hasClass("has-zone-legend")) $("div.seat-area").addClass("has-zone-legend");
                $("div.zone-legend").show();
                $('.m-scroll').mCustomScrollbar('update');
            }
        }


        var fn_seatEvent = function () {

            $('button.seat-condition').unbind('mouseenter focus').bind('mouseenter focus', function () {
                if (seatMapInfo.totCount == 0 || seatMapInfo.activeCount == 0) return false;
                var seatClassCd = $(this).attr("seatClassCd");
                if (typeof (seat.choiAbleCntArray[seatClassCd]) == "undefined") {
                    seat.choiAbleCntArray[seatClassCd] = seat.classCode[seatClassCd][seat.classCode.field.choiAbleCnt];
                }
                var choiAbleCnt = seat.choiAbleCntArray[seatClassCd];

                if (choiAbleCnt.indexOf(seatMapInfo.activeCount) < 0) return false;

                if (!$(this).hasClass('finish') && !$(this).hasClass('impossible')) {
                    $(this).addClass('on');
                    if (seatMapInfo.activeCount > 1) {
                        if ($(this).is("[nextOrd]")) {
                            var nextObj = fn_nextObject($(this));
                            if (nextObj) {
                                nextObj.addClass('on');
                            }
                        }
                    }
                }
            });

            $('button.seat-condition').unbind('mouseleave blur').bind('mouseleave blur', function () {
                if (!$(this).hasClass('choice')) {
                    $(this).removeClass('on');
                    if ($(this).is("[seatNextUniqNo]")) {
                        var nextObj = fn_nextObject($(this), $(this).attr("seatNextUniqNo"));
                        if (nextObj) {
                            nextObj.removeClass('on');
                            nextObj.removeAttr("seatNextUniqNo");
                            $(this).removeAttr("seatNextUniqNo");
                        }
                    }
                }
            });

            $('button.seat-condition').unbind('click').bind('click', 'button.seat-condition', function () {
                var _grpCount = 1;
                var _selectSeatList = [];

                var _seatNo = $(this).attr("seatNo");
                var _rowNm = $(this).attr("rowNm");
                var _seatZoneCd = $(this).attr("seatZoneCd");
                var _seatClassCd = $(this).attr("seatClassCd");
                var _seatUniqNo = $(this).attr("seatUniqNo");
                var _seatToCnt = parseInt($(this).attr("seatToCnt"));
                var _sumTotCnt = 0;
                var _title = "";
                if ($(this).hasClass('choice')) {

                    $(this).removeClass('choice');

                    _title = _rowNm + "" + _seatNo + "(" + seat.zoneCd[_seatZoneCd][1] + "/" + seat.classCode[_seatClassCd][seat.classCode.field.name] + ")";

                    $(this).attr("title", _title).children("span.condition").text("판매가능");
                    /*  */
                    $(this).removeAttr("selected");
                    _selectSeatList = [{ seat: [_rowNm + _seatNo, _seatClassCd, _seatZoneCd, _seatUniqNo, _seatToCnt] }];

                    if ($(this).is("[seatNextUniqNo]")) {
                        var nextObj = fn_nextObject($(this), $(this).attr("seatNextUniqNo"));
                        if (nextObj) {
                            nextObj.removeClass('choice');
                            nextObj.removeAttr("selected");
                            _selectSeatList.push({ seat: [nextObj.attr("rowNm") + nextObj.attr("seatNo"), nextObj.attr("seatClassCd"), nextObj.attr("seatZoneCd"), nextObj.attr("seatUniqNo"), nextObj.attr("seatToCnt")] });
                        }
                    }

                    _sumTotCnt = _selectSeatList.reduce(function (a, o) { return a += Number(o.seat[4]); }, 0);

                    seat.zoneList.filter(function (i, o) { return o.zoneCd == _seatZoneCd; })[0].totCount -= _sumTotCnt;

                    seat.classCode.choiAbleList.filter(function (o) { return o.seatClassCd == _seatClassCd; })[0].selectCount -= _sumTotCnt;

                    //seatMapInfo.selectedCount -= _selectSeatList.length;
                    seatMapInfo.selectedCount -= _sumTotCnt;


                    for (var i = 0; i < _selectSeatList.length; i++) {
                        delete seatMapInfo.selectedMap[_selectSeatList[i].seat[0]];
                    }
                } else {
                    /* 좌석 선택 */
                    // 좌석 선택시 체크 항목
                    // 1. 선택불가및 예매완료 종료
                    if ($(this).hasClass('finish') || $(this).hasClass('impossible')) return false;
                    // 2. 구매가능좌석수가 0 인 경우 종료
                    if (seatMapInfo.totCount == 0) {
                        gfn_alertMsgBox("관람하실 인원을 먼저 선택해주세요.");
                        return false;
                    }
                    // 3. 선택 가능 건수가 0 인 경우 종료
                    if (seatMapInfo.activeCount == 0) {
                        gfn_alertMsgBox("좌석 선택이 완료되었습니다. ");
                        return false;
                    }

                    var _grpCount = 1;
                    // 4. 2인,4인 소파석 일때 초과되는 경우 종료
                    if (seatMapInfo.activeCount < _grpCount) {
                        gfn_alertMsgBox("선택가능한 좌석수가 초과되었습니다. ");
                        return false;
                    }

                    // 99. 선택된 좌석의 메세지가 있을경우 보여 준다.
                    if ($(this).is('[seatNotiMsg]')) {
                        var msg = $(this).attr("seatNotiMsg");
                        gfn_alertMsgBox(msg);
                    }
                    $(this).addClass('choice');
                    _title = _rowNm + "" + _seatNo + "(" + seat.zoneCd[_seatZoneCd][1] + "/" + "선택됨" + ")";
                    $(this).attr("title", _title).children("span.condition").text("선택됨");
                    $(this).attr("selected", "Y");
                    _selectSeatList = [{ seat: [_rowNm + _seatNo, _seatClassCd, _seatZoneCd, _seatUniqNo, _seatToCnt] }];
                    if (seatMapInfo.activeCount > 1) {   // 2건 이상
                        var nextObj = fn_nextObject($(this));
                        if (nextObj) {
                            nextObj.addClass('choice');
                            nextObj.attr("selected", "Y");

                            nextObj.attr("title", nextObj.attr("rowNm") + "" + nextObj.attr("seatNo") + "(" + seat.zoneCd[nextObj.attr("seatZoneCd")][1] + "/" + "선택됨" + ")").children("span.condition").text("선택됨");
                            _selectSeatList.push({ seat: [nextObj.attr("rowNm") + nextObj.attr("seatNo"), nextObj.attr("seatClassCd"), nextObj.attr("seatZoneCd"), nextObj.attr("seatUniqNo"), nextObj.attr("seatToCnt")] });
                        }
                    }

                    _sumTotCnt = _selectSeatList.reduce(function (a, o) { return a += Number(o.seat[4]); }, 0);

                    seat.zoneList.filter(function (i, o) { return o.zoneCd == _seatZoneCd; })[0].totCount += _sumTotCnt;

                    seat.classCode.choiAbleList.filter(function (o) { return o.seatClassCd == _seatClassCd; })[0].selectCount += _sumTotCnt;

                    //seatMapInfo.selectedCount += _selectSeatList.length;
                    seatMapInfo.selectedCount += _sumTotCnt;


                    for (var i = 0; i < _selectSeatList.length; i++) {
                        seatMapInfo.selectedMap[_selectSeatList[i].seat[0]] = [_selectSeatList[i].seat[1], _selectSeatList[i].seat[2], _selectSeatList[i].seat[3], _selectSeatList[i].seat[4], seat.classCode[_seatClassCd][seat.classCode.field.crsChoi]];
                    }
                }

                seat.classCode.crsChoiMap = seat.classCode.choiAbleList.filter(function (o) { return o.seatClassCd == _seatClassCd; })[0];

                fn_reSeatProc();
                fn_seatCountDivCheck();
                fn_myseat();
            });
        };


        var fn_ticketEvent = function () {
            $('.seat-select-section .seat-section .seat-area .seat-count .cell .count .number .now').on('click', function () {
                $(this).closest('.number').find('.num-choice').toggleClass('on');

            });
            $('div.cell > div.count').on('mouseleave blur', function () {
                $(this).find(".num-choice").removeClass('on');
            });


            $("ul.num-choice > li > button").unbind("click").bind("click", function () {
                var value = parseInt($(this).text());
                var _oldValue = parseInt($(this).parents("div.number").children("button").text());
                var curGrpCd = $(this).parents("div.number").children("button").attr("ticketGrpCd");

                //권종 팝업
                if (_oldValue == 0) {
                    for (var i = 0; i < seatTicketCdPopupMsg.length; i++) {
                        map = seatTicketCdPopupMsg[i];
                        if (curGrpCd == map.ticketCd) {
                            /////////////////////////////////////////////
                            ///  전체관람가인 경우 어린이 권종팝업 생략 ///
                            /////////////////////////////////////////////
                            /*
                            console.log("curGrpCd : " + curGrpCd + ", admisClassCd : " + movieAdmisClassCd);
                            */
                            // 어린이 권종 선택은 전체관람가 영화가 아닌경우만 팝업
                            if (((curGrpCd == "TKC") && (movieAdmisClassCd != "AD01")) || (curGrpCd == "TKA") || (curGrpCd == "TKY") || (curGrpCd == "TKS")) {
                                //alert("권종:"+$(this).parent().parent().children("p").text()+", ticketCd:"+map.ticketCd+", Msg:"+map.Msg);
                                var options = {};
                                options.msg = gfn_charToHtml(map.Msg);
                                options.minWidth = 400;
                                options.minHeight = 250;
                                gfn_alertMsgBox(options);
                            }
                        }
                    }
                }


                var rtnVal = fn_ticketCheck(value - _oldValue);
                if (rtnVal == -1) return false;
                if (rtnVal == -2) {
                    $(this).parents("div.number").children("ul").removeClass('on').find("button").removeClass('on');
                    $(this).parents("div.number").children("ul").find("button:contains('" + _oldValue + "')").addClass("on");
                    return false;
                }
                seatMapInfo.totCount += (value - _oldValue);
                $(this).parents("ul.num-choice").find("li > button").removeClass('on');
                $(this).addClass("on");
                $(this).parents("div.number").children("button").text(value);
                $(".seat-count-before").click();
                fn_reSeatProc();

                fn_activeCountAndSeatCntValid(curGrpCd);

                fn_myseat();

            });

            $("div.cell > div.count").children("button.up , button.down ").unbind("click").bind("click", function () {
                var inDe = ($(this).text() == "+") ? 1 : -1;
                var value = parseInt($(this).parent().children("div.number").children("button").text()) + inDe;

                if (value < 0) return false;

                //권종 팝업
                var _oldValue = parseInt($(this).parent().children("div.number").children("button").text());
                var curGrpCd = $(this).parent().children("div.number").children("button").attr("ticketGrpCd");

                if (_oldValue == 0) {
                    for (var i = 0; i < seatTicketCdPopupMsg.length; i++) {
                        map = seatTicketCdPopupMsg[i];
                        if (curGrpCd == map.ticketCd) {
                            /////////////////////////////////////////////
                            ///  전체관람가인 경우 어린이 권종팝업 생략 ///
                            /////////////////////////////////////////////
                            /*
                            console.log("curGrpCd : " + curGrpCd + ", admisClassCd : " + movieAdmisClassCd);
                            */
                            // 어린이 권종 선택은 전체관람가 영화가 아닌경우만 팝업
                            if (((curGrpCd == "TKC") && (movieAdmisClassCd != "AD01")) || (curGrpCd == "TKA") || (curGrpCd == "TKY") || (curGrpCd == "TKS")) {
                                var options = {};
                                options.msg = gfn_charToHtml(map.Msg);
                                options.minWidth = 400;
                                options.minHeight = 250;
                                gfn_alertMsgBox(options);
                            }
                        }
                    }
                }


                if (fn_ticketCheck(inDe) < 0) return false;
                seatMapInfo.totCount += inDe;

                if (value < 0 || value > seatMapInfo.MAX_PERSON) return false;
                $(this).parent().children("div.number").children("button").text(value);
                $(this).parent().children("div.number").children("ul").find("button").removeClass('on');
                $(this).parent().children("div.number").children("ul").find("button:contains('" + value + "')").addClass("on");
                $(".seat-count-before").click();

                fn_reSeatProc();
                fn_activeCountAndSeatCntValid(curGrpCd);;
                fn_myseat();
            });
            $(".seat-count-before").on("click", function () {
                $(".seat-count-before").addClass("off");
            });
        }


        var fn_activeCountAndSeatCntValid = function (grpCd) {
            var grpCdNm = ticket.grpPayList.filter(function (i, o) { return o.grpCd == grpCd; })[0].grpNm;

            var activeSeatCnt = $("button.seat-condition:not(.impossible):not(.finish):not(.choice)").size();

            if (activeSeatCnt < seatMapInfo.activeCount) {
                gfn_alertMsgBox(grpCdNm + "으로 선택가능한 좌석이 존재하지 않아 좌석도를 초기화 합니다.");
                fn_display_init();
                return;
            }
        }


        var fn_ticketCheck = function (inDe) {

            if (seatMapInfo.totCount + (inDe) < seatMapInfo.selectedCount) {
                gfn_confirmMsgBoxSize("선택하신 좌석을 모두 취소하고 다시 선택하시겠습니까?", 400, 200, fn_display_init);
                return -1;
            }

            var checkMap = Object.entries(seat.classCode.choiAbleList.reduce(function (a, o) {
                if (!a[o.crsChoiGroup]) a[o.crsChoiGroup] = {}, a[o.crsChoiGroup].count = o.count, a[o.crsChoiGroup].selectCount = o.selectCount;
                else a[o.crsChoiGroup].count += o.count, a[o.crsChoiGroup].selectCount += o.selectCount; return a;
            }, {}));
            if (checkMap.filter(function (o, i) { return o[1].selectCount > 0 && o[1].selectCount == o[1].count }).length +
                checkMap.filter(function (o, i) { return o[1].selectCount > 0 && o[1].count < seatMapInfo.totCount + (inDe) }).length > 0) {
                gfn_confirmMsgBoxSize("선택하신 좌석을 모두 취소하고 다시 선택하시겠습니까?", 400, 200, fn_display_init);
                return -1;
            }

            if (seatMapInfo.totCount + inDe > seatMapInfo.MAX_PERSON) {
                gfn_alertMsgBox("인원선택은 총 `MAX_PERSON`명까지 가능합니다.".replaceAll("`MAX_PERSON`", seatMapInfo.MAX_PERSON));
                return -2;
            }
            return 0;
        }

        var keyListCaseArray = [];

        var fn_myseat_doPermutation = function (arr, startIdx) {
            var length = arr.length;
            for (var i = startIdx; i < length; i++) {
                var temp = arr[startIdx];
                arr[startIdx] = arr[i];
                arr[i] = temp;
                if (startIdx + 1 == length - 1) {
                    var rArray = arr.slice();
                    keyListCaseArray.push(rArray);
                } else {
                    fn_myseat_doPermutation(arr, startIdx + 1);
                }
                temp = arr[startIdx];
                arr[startIdx] = arr[i];
                arr[i] = temp;
            }
        }

        var fn_keyListCaseArray_reset = function () {
            keyListCaseArray = [];
        }


        var fn_myseat = function () {

            // 권종별 티켓 배열의 각 요소별 선택 권종건수 셋팅(totCount)
            ticket.grpPayList_setTotCount();
            ticket.payQueue = [];

            var zoneCd = "";
            var totCount = 0;
            var pay = 0;
            // 선택된 좌석번호 리스트 (ex: [N17, N15])
            var keyList = Object.keys(seatMapInfo.selectedMap);
            var seatUniqNo = "";
            var seatClassCd = "";
            var seatToCnt = "";
            var zoneList = null;
            var classList = null;
            var gernZoneClassList = null;
            // 정책 리스트에서 zone 적용 여부가 Y인 리스트를 가져온다.
            var zoneAdoptClassList = seat.classCode.getCdList(seat.classCode.field.zoneAdoptAt);

            // 선택된 좌석들중에 존 적용여부가 Y인 좌석이 존재하는지 확인
            var zoneAmtAt = Math.sign(ticket.grpPayList.filter(function (i, o) { return (o[ticket.ECON_ZONE[1]] > 0 || o[ticket.PRIM_ZONE[1]] > 0) }).length);


            keyList.sort(function (a, b) {
                for (var i = 0; i < ticket.grpPayList.length; i++) {
                    var aAmtName = "";
                    var bAmtName = "";
                    if (seatMapInfo.selectedMap[a][1] != "GERN_ZONE") aAmtName = ticket[seatMapInfo.selectedMap[a][1]][1];
                    else aAmtName = seat.classCode[seatMapInfo.selectedMap[a][0]][seat.classCode.field.amtName];

                    if (seatMapInfo.selectedMap[b][1] != "GERN_ZONE") bAmtName = ticket[seatMapInfo.selectedMap[b][1]][1];
                    else bAmtName = seat.classCode[seatMapInfo.selectedMap[b][0]][seat.classCode.field.amtName];

                    if (ticket.grpPayList[i][bAmtName] != ticket.grpPayList[i][aAmtName] || (ticket.grpPayList[i][bAmtName] == ticket.grpPayList[i][aAmtName] && aAmtName == aAmtName)) {
                        return ticket.grpPayList[i][bAmtName] - ticket.grpPayList[i][aAmtName];
                    }
                }
            });
            //    var keyListParam = keyList.slice();
            //console.log("before call" + keyListParam);
            //fn_myseat_doPermutation(keyListParam, 0);
            //console.log("after call" + keyListCaseArray);
            //fn_keyListCaseArray_reset();

            for (var i = 0; i < keyList.length; i++) {
                seatClassCd = seatMapInfo.selectedMap[keyList[i]][0];
                zoneCd = seatMapInfo.selectedMap[keyList[i]][1];
                seatUniqNo = seatMapInfo.selectedMap[keyList[i]][2];
                seatToCnt = seatMapInfo.selectedMap[keyList[i]][3];
                zoneList = $.unique(Object.entries(seatMapInfo.selectedMap).filter(function (o, i) { return o[1][3] > 0 && o[1][1] != "GERN_ZONE"; }).map(function (o, i) { return o[1][1]; }).sort(function (a, b) { return ticket[b][2] - ticket[a][2]; }));
                classList = $.unique(Object.entries(seatMapInfo.selectedMap).filter(function (o, i) { return o[1][3] > 0; }).map(function (o, i) { return o[1][0]; }).sort(function (a, b) { return ticket.grpPayList[0][seat.classCode[a][seat.classCode.field.amtName]] - ticket.grpPayList[0][seat.classCode[b][seat.classCode.field.amtName]] }));
                gernZoneClassList = $.unique(Object.entries(seatMapInfo.selectedMap).filter(function (o, i) { return (o[1][3] > 0 && o[1][1] == "GERN_ZONE"); }).map(function (o, i) { return o[1][0]; }).sort(function (a, b) { return ticket.grpPayList[0][seat.classCode[a][seat.classCode.field.amtName]] - ticket.grpPayList[0][seat.classCode[b][seat.classCode.field.amtName]] }));
                if (gernZoneClassList.length > 0) zoneList = zoneList.concat(gernZoneClassList);
                if (zoneAmtAt > 0) {
                    var payList = ticket.grpPayList.filter(function (i, o) { return o.totCount > 0; }).map(function (i, map) {
                        for (var i = 0; i < zoneList.length; i++) {
                            if (zoneList[i].match("ZONE$")) {
                                map[ticket[zoneList[i]][1] + "List"] = [];
                            } else {
                                map[seat.classCode[zoneList[i]][seat.classCode.field.amtName] + "List"] = [];
                            }


                            for (var j = 0; j < zoneList.length; j++) {
                                var iVal = 0;
                                var jVal = 0;
                                var iAmtName = "";
                                var jAmtName = "";
                                if (zoneList[i].match("ZONE$")) {
                                    iVal = map[ticket[zoneList[i]][1]];
                                    iAmtName = ticket[zoneList[i]][1];
                                }
                                else {
                                    iVal = map[seat.classCode[zoneList[i]][seat.classCode.field.amtName]];
                                    iAmtName = seat.classCode[zoneList[i]][seat.classCode.field.amtName];
                                }
                                if (zoneList[j].match("ZONE$")) {
                                    jVal = map[ticket[zoneList[j]][1]];
                                    jAmtName = ticket[zoneList[j]][1];
                                }
                                else {
                                    jVal = map[seat.classCode[zoneList[j]][seat.classCode.field.amtName]];
                                    jAmtName = seat.classCode[zoneList[j]][seat.classCode.field.amtName];
                                }

                                if (iVal - jVal >= 0) map[iAmtName + "List"].push([jAmtName, map[iAmtName] - map[jAmtName]]);
                            }

                            map[iAmtName + "Sort"] = map[iAmtName + "List"].sort(function (a, b) { return b[1] - a[1]; })[0];
                        }
                        return map;
                    }).get();

                    var amtName = "";
                    if (zoneCd != "GERN_ZONE") amtName = ticket[zoneCd][1];
                    else amtName = seat.classCode[seatClassCd][seat.classCode.field.amtName];
                    if (payList.length > 1) {
                        payList.sort(function (a, b) {

                            if (a[amtName + "Sort"][1] == b[amtName + "Sort"][1]) {
                                if (a[amtName] == b[amtName]) {
                                    // 성인, 청소년, 이런이, 우대 순
                                    return a["ticketOrder"] - b["ticketOrder"];
                                } else {
                                    return b[amtName] - a[amtName];
                                }
                            } else {
                                return a[amtName + "Sort"][1] - b[amtName + "Sort"][1];
                            }
                        });
                    }
                    if (payList.length > 0) {
                        var payMap = payList.shift();
                        if (payMap.totCount > 0) {
                            payMap.totCount--;
                            pay = payMap[amtName];

                            ticket.payQueue.push({ pcGrpDivCd: "MBX", zoneCd: zoneCd, grpCd: payMap.grpCd, grpNm: payMap.grpNm, pay: pay, seatUniqNo: seatUniqNo, seatClassCd: seatClassCd, seatRowNm: keyList[i] });
                        }
                    }
                } else {

                    var payList = ticket.grpPayList.filter(function (i, o) { return o.totCount > 0; }).map(function (i, map) {
                        for (var i = 0; i < classList.length; i++) {

                            map[seat.classCode[classList[i]][seat.classCode.field.amtName] + "List"] = [];
                            for (var j = 0; j < classList.length; j++) {
                                if (map[seat.classCode[classList[i]][seat.classCode.field.amtName]] - map[seat.classCode[classList[j]][seat.classCode.field.amtName]] >= 0) {
                                    map[seat.classCode[classList[i]][seat.classCode.field.amtName] + "List"].push([seat.classCode[classList[j]][seat.classCode.field.amtName], map[seat.classCode[classList[i]][seat.classCode.field.amtName]] - map[seat.classCode[classList[j]][seat.classCode.field.amtName]]]);
                                }
                            }

                            map[seat.classCode[classList[i]][seat.classCode.field.amtName] + "Sort"] = map[seat.classCode[classList[i]][seat.classCode.field.amtName] + "List"].sort(function (a, b) { return b[1] - a[1]; })[0];
                        }
                        return map;
                    }).get();
                    if (payList.length > 1) {
                        payList.sort(function (a, b) {

                            if (a[seat.classCode[seatClassCd][seat.classCode.field.amtName] + "Sort"][1] == b[seat.classCode[seatClassCd][seat.classCode.field.amtName] + "Sort"][1]) {
                                if (a[seat.classCode[seatClassCd][seat.classCode.field.amtName]] == b[seat.classCode[seatClassCd][seat.classCode.field.amtName]]) {
                                    // 성인, 청소년, 이런이, 우대 순
                                    return a["ticketOrder"] - b["ticketOrder"];
                                } else {
                                    return b[seat.classCode[seatClassCd][seat.classCode.field.amtName]] - a[seat.classCode[seatClassCd][seat.classCode.field.amtName]];
                                }
                            } else {
                                return a[seat.classCode[seatClassCd][seat.classCode.field.amtName] + "Sort"][1] - b[seat.classCode[seatClassCd][seat.classCode.field.amtName] + "Sort"][1];
                            }
                        });
                    }

                    if (payList.length > 0) {
                        var payMap = payList.shift();
                        if (payMap.totCount > 0) {
                            var paySeatToCnt = 0;
                            if (seatToCnt > payMap.totCount) {
                                paySeatToCnt = payMap.totCount;
                                payMap.totCount = 0;
                            }
                            else {
                                paySeatToCnt = seatToCnt;
                                payMap.totCount -= seatToCnt;
                            }

                            pay = payMap[seat.classCode[seatClassCd][seat.classCode.field.amtName]];

                            ticket.payQueue.push({ pcGrpDivCd: "MBX", zoneCd: zoneCd, grpCd: payMap.grpCd, grpNm: payMap.grpNm, pay: pay, seatUniqNo: seatUniqNo, seatClassCd: seatClassCd, seatRowNm: keyList[i], paySeatToCnt: paySeatToCnt });
                        }
                    }
                }

                seatMapInfo.selectedMap[keyList[i]][3] = 0;
            }

            ticket.grpPayList_setTotCount();

            keyList.sort(function (a, b) { return (a.substring(0, 1) + a.substring(1).lpad(2, '0')).localeCompare(b.substring(0, 1) + b.substring(1).lpad(2, '0')) });
            $("div.my-seat > div.seat").removeClass("possible").removeClass("choice").addClass("all").text("-").attr("title", "구매가능 좌석");
            $("div.my-seat > div.seat:lt(" + seatMapInfo.totCount + ")").removeClass("all").addClass("possible").attr("title", "선택할 수 있는 좌석");
            for (var i = 0; i < keyList.length; i++) {
                seatMapInfo.selectedMap[keyList[i]][3] = seat.classCode[seatMapInfo.selectedMap[keyList[i]][0]][seat.classCode.field.seatToCnt];
                $("div.my-seat > div.seat:eq(" + i + ")").removeClass("possible").addClass("choice").text(keyList[i]).attr("title", "선택한 좌석");
            }


            var payCountLayoutHtml = "";
            var cntPay = 0;
            var totPay = 0;
            for (var i = 0; i < ticket.grpPayList.length; i++) {
                map = ticket.grpPayList[i];
                cntPay = 0;
                $(ticket.payQueue).each(function (i, o) {
                    if (o.grpCd == map.grpCd) {
                        cntPay += parseInt(o.paySeatToCnt);
                        totPay += parseInt(o.pay);
                    }
                });
                if (cntPay > 0) {
                    payCountLayoutHtml += "<span>" + map.grpNm + " <em>" + cntPay + "</em></span>";
                }
            }

            ticket.payQueue.totalPay = totPay;
            $("div.pay-area > p.count").html(payCountLayoutHtml);
            $("div.pay-area > div.pay > div.money > em").html(totPay.format());


            //if ( seatMapInfo.totCount > 0 && seatMapInfo.activeCount == 0 ){
            if (seatMapInfo.totCount > 0 && seatMapInfo.activeCount <= 0) {

                $("a#pageNext").bind("click", function () {

                    var tkaCnt, tkyCnt, tkcCnt, tksCnt = 0;
                    for (var i = 0; i < $('.seat-select-section .seat-section .seat-area .seat-count').children().length; i++) {
                        var ticketGrpCd = $(".seat-select-section .seat-section .seat-area .seat-count > div.cell:eq(" + i + ") > div.count > div.number").children("button").attr("ticketGrpCd");
                        var ticketGrpCnt = parseInt($(".seat-select-section .seat-section .seat-area .seat-count > div.cell:eq(" + i + ") > div.count > div.number").children("button").text());
                        switch (ticketGrpCd) {
                            case 'TKA': tkaCnt = ticketGrpCnt; break;
                            case 'TKY': tkyCnt = ticketGrpCnt; break;
                            case 'TKC': tkcCnt = ticketGrpCnt; break;
                            case 'TKS': tksCnt = ticketGrpCnt; break;
                        }
                    }

                    if (movieAdmisClassCd != 'AD01' && tkcCnt > 0 && tkaCnt <= 0) {
                        gfn_alertMsgBoxSize(gfn_charToHtml("본 영화는 &#039;12/15세 관람가&#039;로 어린이는 보호자 없이 관람이 불가능하며, &lt;br&gt; 어린이 요금과 성인 요금을 같이 선택하셔야 진행이 가능합니다."), 480, 250);
                        return;
                    }


                    if (playTimesDivPopupMsg != null && playTimesDivPopupMsg != '') {
                        var options = {};
                        options.msg = gfn_charToHtml(playTimesDivPopupMsg);
                        options.confirmFn = setBookingParam;
                        options.cancelFn = '';
                        options.okBtnTxt = "확인";
                        options.cancelBtnTxt = "취소";
                        options.param = { confirm: ticket.payQueue, cancel: "" };
                        options.minWidth = 400;
                        options.minHeight = 250;
                        gfn_confirmMsgBox(options);
                    }
                    else {
                        var payUrl = "/on/oh/ohz/PayBooking/completeSeat.do";
                        //console.log(ticket.payQueue);
                        setBookingParam(ticket.payQueue);
                    }
                    //parent.fn_goNextPagePcntSeatChoi(ticket.payQueue);
                });
                $("a#pageNext").removeClass("disabled").addClass("active");
            } else {
                $("a#pageNext").unbind("click");
                $("a#pageNext").removeClass("active").addClass("disabled");
            }
        }


        //예매 param 세팅
        function setBookingParam(paramList) {
            var paramText = "";
            for (var i = 0; i < paramList.length; i++) {
                if (i > 0) {
                    paramText += ";";
                }
                paramText += paramList[i].seatUniqNo + "," + paramList[i].grpCd + "," + paramList[i].pay;
                paramText += "," + paramList[i].pcGrpDivCd + "," + paramList[i].zoneCd + "," + paramList[i].seatClassCd + "," + paramList[i].paySeatToCnt;
            }

            var options = {};
            options.playSchdlNo = $("#playSchdlNo").val();
            options.brchNo = $("#brchNo").val();
            options.bokdCnt = paramList.length;
            options.seatOccupText = paramText;
            options.totalAmt = paramList.totalPay;

            //parent.fn_setBookingParam(options);
            parent.fn_goNextPagePcntSeatChoi(options);
        }



        var fn_reSeatProc = function () {

            var rowNmArray = $.unique($("button.seat-condition").map(function () { return $(this).attr("rowNm"); }));
            var seatRowArray = null;
            var seatArray = null;
            $("button.seat-condition").removeClass("impossible");

            $.each(rowNmArray, function (i, rowNm) {
                var seatChoiGrpNmArray = $.unique($("button.seat-condition[rowNm='" + rowNm + "']").map(function () { return $(this).attr("seatChoiGrpNm"); }));
                $.each(seatChoiGrpNmArray, function (i, seatChoiGrpNm) {
                    seatRowArray = $("button.seat-condition[rowNm='" + rowNm + "'][seatChoiGrpNm='" + seatChoiGrpNm + "']");

                    var selectorArray = ["choice", "finish"];
                    seatArray = fn_seatGroupSplit(seatRowArray, selectorArray);

                    $.each(seatArray[1], function () { $(this).removeAttr("nextOrd"); });

                    $(seatArray[0]).each(function (n, seat) {
                        var seatLength = seat.length;
                        seat.each(function (i, o) {
                            fn_seatDeadCheck(o, i + 1, seatLength);
                            fn_setConnSeat(o, i + 1, seatLength);
                        });
                    });
                });
            });
        }

        var fn_seatGroupSplit = function (array, selectorArray) {
            var splitSeat = [];
            var splitEtcSeat = [];

            var idxArray = array.map(function (i, o) {
                var rtVal = null;
                for (var selector in selectorArray) {
                    if ($(o).hasClass(selectorArray[selector])) {
                        rtVal = i + 1;
                        break;
                    }
                }
                return rtVal;
            }).add(array.length + 1);

            var idx = 0;
            var idxPrev = 0;
            for (var i = 0; i < idxArray.length; i++) {
                idx = idxArray[i];
                splitSeat.push(array.slice(idxPrev, idx - 1));
                splitEtcSeat.push(array.slice(idx - 1, idx));
                idxPrev = idx;
            }
            return [splitSeat, splitEtcSeat];
        }

        var fn_setConnSeat = function (cell, seatChoiGrpSeq, seatChoiRowCnt) {
            var seatChoiDircVal = parseInt($(cell).attr("seatChoiDircVal"));
            if (seat.classCode.connExcp.indexOf($(cell).attr("seatClassCd")) < 0 && seatChoiRowCnt > 1) {
                if (seatMapInfo.activeCount > 1) {

                    var finishObj;
                    if (seatChoiGrpSeq % 2 == 1) {
                        finishObj = $(cell).next().hasClass("finish");

                        if (finishObj == true) {
                            console.log($(cell).next().attr("rowNm") + $(cell).next().attr("seatNo") + "이미 예약됨");
                            $(cell).attr("nextOrd", "P");
                        } else {
                            $(cell).attr("nextOrd", "N");
                        }
                        //$(cell).attr("nextOrd","N");
                    } else {
                        finishObj = $(cell).prev().hasClass("finish");

                        if (finishObj == true) {
                            console.log($(cell).prev().attr("rowNm") + $(cell).prev().attr("seatNo") + "이미 예약됨");
                            $(cell).attr("nextOrd", "N");
                        } else {
                            $(cell).attr("nextOrd", "P");
                        }
                        //$(cell).attr("nextOrd","P");
                    }

                    if (seatChoiRowCnt == seatChoiGrpSeq && $(cell).attr("nextOrd") == "N") {
                        $(cell).attr("nextOrd", "P");
                    }

                    /////////////////////////////////////////////////////
                    /////////////////////////////////////////////////////
                    /////////////////////////////////////////////////////
                    if (seatChoiGrpSeq == 1 && $(cell).attr("nextOrd") == "P") {
                        $(cell).attr("nextOrd", "N");
                    }
                    /////////////////////////////////////////////////////
                    /////////////////////////////////////////////////////
                    /////////////////////////////////////////////////////

                } else {

                    $(cell).removeAttr("nextOrd");
                }
            }
        }


        var fn_seatDeadCheck = function (cell, seatChoiGrpSeq, seatChoiRowCnt) {

            var seatChoiDircVal = parseInt($(cell).attr("seatChoiDircVal"));
            var seatClassCd = $(cell).attr("seatClassCd");

            var seatCheckFlg = true;
            var seatCrsChoiGrpFlg = true;
            var seatToCnt = $(cell).attr("seatToCnt");
            //if ( $(cell).attr("seatUniqNo")   == '00901401') fn_debugger();


            if (typeof (seat.choiAbleCntArray[seatClassCd]) == "undefined") {
                seat.choiAbleCntArray[seatClassCd] = seat.classCode[seatClassCd][seat.classCode.field.choiAbleCnt];
            }
            var choiAbleCnt = seat.choiAbleCntArray[seatClassCd];

            var isSelectable = true;
            /*if ( choiAbleCnt.indexOf(seatMapInfo.totCount) < 0 && seatMapInfo.totCount > 0) {
                isSelectable = false;
                seatCheckFlg = false;
            }*/

            if (choiAbleCnt.indexOf(seatMapInfo.activeCount) < 0 && (seatMapInfo.activeCount) > 0) {
                isSelectable = false;
                seatCheckFlg = false;
            }


            var crsChoiGroupNm = seat.classCode[seatClassCd][seat.classCode.field.crsChoi];
            var keyList = Object.keys(seatMapInfo.selectedMap);
            if (keyList.length > 0) {
                if (keyList.filter(function (key, i) {
                    return seatMapInfo.selectedMap[key][4] == seat.classCode[seatClassCd][seat.classCode.field.crsChoi];
                }).length <= 0) {
                    isSelectable = false;
                    seatCheckFlg = false;
                }
            }


            if (Object.entries(seat.classCode.choiAbleList.reduce(function (a, o) {
                if (!a[o.crsChoiGroup]) a[o.crsChoiGroup] = {}, a[o.crsChoiGroup].count = o.count, a[o.crsChoiGroup].selectCount = o.selectCount;
                else a[o.crsChoiGroup].count += o.count, a[o.crsChoiGroup].selectCount += o.selectCount;
                return a;
            }, {})).filter(function (o, i) { return o[1].count >= seatMapInfo.totCount && o[0] == crsChoiGroupNm }).length == 0) {
                isSelectable = false;
                seatCheckFlg = false;
            }

            var notTicketAbleAtList = seat.classCode[seatClassCd][seat.classCode.field.notTicketAbleAt].split(",").filter(function (o, i) { return o != 'N'; });
            if (notTicketAbleAtList.length > 0) {
                ticket.grpPayList_setTotCount();
                // 인원수가 올라가있는 권종 리스트 중 해당 셀의 좌석등급에 해당 권종은 앉을수 없다는게 한건이라도 확인되면 비활성화 처리
                if (ticket.grpPayList.filter(function (i, o) { return o.totCount > 0; }).filter(function (i, o) { return notTicketAbleAtList.filter(function (b, j) { return o.grpCd == "TK" + b; }).length > 0; }).length > 0) {
                    isSelectable = false;
                    seatCheckFlg = false;
                }
            }
            if (seatCheckFlg) {
                if (seatMapInfo.activeCount == 1) {
                    isSelectable = false;
                    if (seatChoiDircVal == 0) {
                        if (seatChoiGrpSeq % 2 == 1) {
                            isSelectable = true;
                        }
                    } else {
                        if (seatChoiRowCnt % 2 == 0) {
                            if (seatChoiGrpSeq % 2 == 0) {
                                isSelectable = true;
                            }
                        } else {
                            if (seatChoiGrpSeq % 2 == 1) {
                                isSelectable = true;
                            }
                        }
                    }
                    if (seatChoiRowCnt <= 2) {
                        isSelectable = true;
                    } else {
                        if (seatChoiGrpSeq == 2 || seatChoiGrpSeq == seatChoiRowCnt - 1) {
                            isSelectable = false;
                        }
                        if (seatChoiGrpSeq == 1 || seatChoiGrpSeq == seatChoiRowCnt) {
                            isSelectable = true;
                        }
                    }

                    if (seat.classCode.deadExcp.indexOf($(cell).attr("seatClassCd")) >= 0) {
                        isSelectable = true;
                    }
                }
            }
            if (!isSelectable) {
                /////////////////////////////////////////////
                // TODO 소스원본
                // if( !$(cell).hasClass('finish') ){
                /////////////////////////////////////////////
                if ($(cell).hasClass('finish') == false && $(cell).hasClass('choice') == false) {
                    /*
                    if($(cell).attr("rowNm") == "G"  && $(cell).attr("seatNo") == "16"){
                        alert($(cell).attr("class"));
                        alert("G16 impossible view 추가");
                    }
                    */
                    $(cell).addClass("impossible view");
                }
                $(cell).css("width", 20 * seatToCnt);
            }
        }


        var fn_seatCountDivCheck = function () {

            fn_seatCountDivInit();


            var seatClassCdArray = $.unique($("button.seat-condition:not(.impossible):not(.finish):not(.choice)").map(function () { return $(this).attr("seatclasscd"); }).sort(function (a, b) { return seat.classCode[a][policyInfo.sortOrdVal] - seat.classCode[b][policyInfo.sortOrdVal]; }));
            var nTKACnt = 0, nTKYCnt = 0, nTKCCnt = 0, nTKSCnt = 0;
            for (var i = 0; i < seatClassCdArray.length; i++) {
                var notTicketAbleAtList = seat.classCode[seatClassCdArray[i]][seat.classCode.field.notTicketAbleAt].split(",").filter(function (o, i) { return o != 'N'; });
                for (var j = 0; j < notTicketAbleAtList.length; j++) {
                    if (notTicketAbleAtList[j] == "A") nTKACnt++;
                    else if (notTicketAbleAtList[j] == "Y") nTKYCnt++;
                    else if (notTicketAbleAtList[j] == "C") nTKCCnt++;
                    else if (notTicketAbleAtList[j] == "S") nTKSCnt++;
                }
            }
            ticket.grpPayList.each(function (i, map) {
                if (eval("n" + map.grpCd + "Cnt") == seatClassCdArray.length && Number($("div.seat-count p:contains('" + map.grpNm + "')").siblings("div.count").find("button.now").text()) == 0) {
                    $("div.seat-count p:contains('" + map.grpNm + "')").siblings("div.count").find("button").prop("disabled", true);
                }
            });
        }


        var fn_seatCountDivInit = function () {
            $("div.seat-count").find("button").prop("disabled", false);
        }




        var fn_nextObject = function (obj, seatNextUniqNo) {
            var seatChoiGrpNm = obj.attr("seatChoiGrpNm");
            if (!obj.is("[seatUniqNo]")) {
                return null;
            }
            if (seat.classCode.connExcp.indexOf(obj.attr("seatClassCd")) > -1) {
                return null;
            }

            if (seatNextUniqNo) {
                return $('button.seat-condition[seatUniqNo="' + seatNextUniqNo + '"]');
            }
            var nextOrd = obj.attr("nextOrd");

            var nextObj;
            if (!nextOrd) {
                return null;
            } else if (nextOrd == "N") {
                nextObj = obj.next("[seatChoiGrpNm='" + seatChoiGrpNm + "']");
            } else {
                nextObj = obj.prev("[seatChoiGrpNm='" + seatChoiGrpNm + "']");
            }
            if (nextObj.is(".choice")) {
                return null;
            }
            if (nextObj.is(".finish")) {
                return null;
            }
            obj.attr("seatNextUniqNo", nextObj.attr("seatUniqNo"));
            nextObj.attr("seatNextUniqNo", obj.attr("seatUniqNo"));
            return nextObj;
        }


        var fn_search = function (popYn) {
            if (typeof $("#playSchdlNo").val() == 'undefined' || $("#playSchdlNo").val() == '') {
                return;
            }
            var paramData = {
                playSchdlNo: $("#playSchdlNo").val()
            }
            $.ajaxMegaBox({
                url: "/on/oh/ohz/PcntSeatChoi/selectSeatList.do",
                data: JSON.stringify(paramData),
                success: function (result) {
                    if (result.seatListSD01.length > 0) {
                        if (popYn == 'N') {
                            //popYn 전달시 최초진입 팝업 삭제(결제화면에서 좌석선점 등으로 이동시 팝업띄우지 않음)
                            if (result.popUp.rfndDivPopup != null) {
                                result.popUp.rfndDivPopup = null;
                            }
                            if (result.popUp.movieAdmisClassPopup != null) {
                                result.popUp.movieAdmisClassPopup = null;
                            }
                        }
                        fn_seatPolicy(result.seatPolicyList);

                        fn_seatMapDisplay(result);
                    } else {
                        gfn_alertMsgBox("상영정보가 없습니다.");
                        $("a#pagePrevious").click();
                    }
                },
                complete: function () {
                    parent.$('.bg-loading').hide();
                }
            });
        }


        var fn_display_init = function () {
            $("div.number").children("ul").removeClass('on').find("button").removeClass('on');
            $("div.number").children("ul").find("button:contains('" + 0 + "')").addClass("on");
            $("div.number").children("button").text(0);
            seatMapInfo.fn_init();
            $("button.seat-condition.choice").removeClass("choice on");
            seat.classCode.choiAbleList.forEach(function (o) { o.selectCount = 0; });
            seat.zoneList_init();
            seat.zone
            ticket.init();
            fn_reSeatProc();
            fn_seatCountDivInit();
            fn_myseat();
        }


        function shwoBlackListPopup(param) {
            //gfn_alertMsgBoxSize('원활한 극장 운영을 위하여 개인별 예매 수량 및 예매 가능 지점 수에 대해 부분적인 제한(1일 '+param.bokdAbleBrch+'회, 최대 '+param.bokdAbleCnt+'매까지, 최대 '+param.bokdAbleQty+'개 지점)을 실시하고 있습니다.\n\n또한, 이틀 연속 예매 가능매수를 초과 하실 경우 익일엔 예매가 불가능하오니 참고 부탁드립니다.\n\n단체 관람을 위해 예매 하시는 경우 드림센터 또는 관람 예정 지점 문의를 통해 단체 할인을 받으실 수 있사오니 별도 문의 부탁 드리겠습니다.\n\n고객님의 양해 부탁 드리며 관련 문의는 1544-0070으로 부탁 드립니다.',400,250);	//원활한 극장 운영을 위하여 개인별 예매 수량 및 예매 가능 지점 수에 대해 부분적인 제한(1일 {0}회, 최대 {1}매까지, 최대 {2}개 지점)을 실시하고 있습니다. 또한, 이틀 연속 예매 가능매수를 초과 하실 경우 익일엔 예매가 불가능하오니 참고 부탁드립니다. 단체 관람을 위해 예매 하시는 경우 드림센터 또는 관람 예정 지점 문의를 통해 단체 할인을 받으실 수 있사오니 별도 문의 부탁 드리겠습니다. 고객님의 양해 부탁 드리며 관련 문의는 1544-0070으로 부탁 드립니다.
            gfn_alertMsgBoxSize('원활한 극장 운영을 위하여 개인별 예매 수량 및 예매 가능 지점 수에 대해 부분적인 제한(1일 ' + param.bokdAbleCnt + '회, 최대 ' + param.bokdAbleQty + '매까지, 최대 ' + param.bokdAbleBrch + '개 지점)을 실시하고 있습니다.\n\n또한, 이틀 연속 예매 가능매수를 초과 하실 경우 익일엔 예매가 불가능하오니 참고 부탁드립니다.\n\n단체 관람을 위해 예매 하시는 경우 드림센터 또는 관람 예정 지점 문의를 통해 단체 할인을 받으실 수 있사오니 별도 문의 부탁 드리겠습니다.\n\n고객님의 양해 부탁 드리며 관련 문의는 1544-0070으로 부탁 드립니다.', 400, 250);
            //$modal('layer_member_grade');
        }


        function shwoDataRevisnPopup(arguments, param) {
            var options = {};
            options.msg = '고객님의 생년월일, 전화번호가 정상적으로 등록되지 않았습니다.\n해당정보는 현장에서 예매정보 확인시 필요한 정보이므로 업데이트 바랍니다.\n(' + arguments + ')\n\n예매를 계속 진행하시겠습니까?\n';
            options.confirmFn = parent.fn_mvPage;
            options.cancelFn = parent.fn_vlaidBlackList;
            options.okBtnTxt = "지금변경";
            options.cancelBtnTxt = "계속진행";
            options.minWidth = 400;
            options.minHeight = 300;
            options.param = { confirm: "/on/oh/ohh/Mypage/mainPage.do", cancel: param };
            gfn_confirmMsgBox(options);
        }



        $(function () {

            $("button#seatMemberCntInit").off("click").on("click", function () {
                //$("button#seatMemberCntInit").hide();
                $("button#seatMemberCntInit").attr("disabled", true);
                fn_search('N');
                Timers.call(5, "s", null, function (param) {
                    //$("button#seatMemberCntInit").show();
                    $("button#seatMemberCntInit").attr("disabled", false);
                });
            });

            $("a#pagePrevious").off("click").on("click", function () {
                //window.history.back();
                parent.fn_goPrePagePcntSeatChoi();
            });
            fn_search();
        });
    </script>
    <script src="js/megabox.api.min.js"></script>
    <script src="js/gabox.js"></script>
    <script src="js/megabox.common.min.js"></script>
    <script src="js/booking.js"></script>
    <script src="js/selectPcntSeatChoi.js"></script>
    <script>
        //document.body.scrollIntoView(true);
    
        ////////////////////////////////////////////////////////////////////////////
        /////////////////////////// IFRAME 외부로 호출영역///////////////////////////
        ////////////////////////////////////////////////////////////////////////////
    
        $("#frameBokdMBooking").load(function(){
            if (self != top) {
                var height = $(document).height();
                var allowOrigin = "http://ria.megabox.co.kr";
                window.parent.postMessage(height, allowOrigin);
            }
        });
    
        ////////////////////////////////////////////////////////////////////////////
        ////////////////////////////////////////////////////////////////////////////
        ////////////////////////////////////////////////////////////////////////////
    
    </script>
    <script type="text/javascript">
		(function(w, d, a){
		    w.__beusablerumclient__ = {
		        load : function(src){
		            var b = d.createElement("script");
		            b.src = src; b.async=true; b.type = "text/javascript";
		            d.getElementsByTagName("head")[0].appendChild(b);
		        }
		    };w.__beusablerumclient__.load(a);
		})(window, document, "//rum.beusable.net/script/b200617e104748u388/bc4af2fa1e");
	</script>
    <title>Document</title>
</head>

<body class="body-iframe">
    <input type="hidden" id="playSchdlNo" name="playSchdlNo" value="2007231372022">
    <input type="hidden" id="brchNo" name="brchNo" value="1372">
    <section id="layer_age_alert" class="modal-layer" style="z-index: 900"><a href="" class="focus">레이어로 포커스 이동 됨</a>
        <div class="wrap" style="width: 500px; height: 350px; margin-left: -250px; margin-top: 0px; top: 140px;">
            <header class="layer-header">
                <h3 class="tit">알림</h3>
            </header>
            <div class="layer-con">
                <div class="alert-age-layer age15">
                    <div class="age-box age-15">
                        <div class="left">
                            <p class="circle">15</p>
                        </div>
                        <div class="right">
                            <p class="tit">15세이상관람가</p>
                            <p class="txt">
                            <p>[15세 이상 관람가]<br><br>만 15 세 미만의 고객님은(영,유아 포함) 반드시 부모님 또는<br> 성인 보호자의 동반하에 관람이 가능합니다.<br>연령
                                확인 불가 시 입장이 제한될 수 있습니다.</p>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="btn-group-fixed">
                <button type="button" class="button purple close-layer">확인</button>
            </div>
            <button type="button" class="btn-modal-close">레이어 닫기</button>
        </div>
    </section>
    <div class="inner-wrap" style="padding-top:40px; padding-bottom:100px;">
        <div class="quick-reserve">
            <h2 class="tit">빠른예매</h2>
            <!-- cti 일때만 출력 -->







            <script type="text/javascript">
                var requestPayAt = "N";

                $(function () {
                    //RIA의 경우
                    if (parent.sellChnlCd != "") {
                        $('.inner-wrap')
                            .css('padding-bottom', '')
                            .css('padding-top', '');	//하단 상단 공백 제거
                        //         $('#btnLangChg').hide();    //언어전환 버튼숨김

                        //로그인 되었으면
                        if (parent.riaLoginAt == "Y") {
                            $('.cti-area input[name=riaName]').attr('value', parent.riaParamName);	//고객명
                            $('.cti-area input[name=riaMobileNo]').attr('value', parent.riaParamMobileNo);	//고객전화번호
                            $('.cti-area input[name=riaBirthday]').attr('value', parent.riaParamBirthday);	//고객생년월일
                            $('.cti-area input[name=riaMemberYn]').attr('value', parent.riaMemberYn == "Y" ? "회원" : "비회원");	//회원여부

                            $('.cti-area input[name=riaName]').attr("readonly", true);		//고객명
                            $('.cti-area input[name=riaMobileNo]').attr("readonly", true);	//고객전화번호
                            $('.cti-area input[name=riaBirthday]').attr("readonly", true);	//고객생년월일

                            $('.cti-area input[name=riaMemberYn]').attr("readonly", true);	//회원여부

                            $('.cti-area button').attr('login-at', "Y");

                            //결제화면이 아니면
                            if ("N" == requestPayAt) {
                                $('.cti-area button').html('재인증');
                            }
                        }
                        //로그인 되지 않았으면
                        else {
                            $('.cti-area input[name=riaName]').attr('value', parent.riaParamName);	//고객명
                            $('.cti-area input[name=riaMobileNo]').attr('value', parent.riaParamMobileNo);	//고객전화번호
                            $('.cti-area input[name=riaBirthday]').attr('value', parent.riaParamBirthday);	//고객생년월일
                            $('.cti-area input[name=riaMemberYn]').attr('value', '');	//회원여부

                            $('.cti-area input[name=riaName]').attr("readonly", false);		//고객명
                            $('.cti-area input[name=riaMobileNo]').attr("readonly", false);	//고객전화번호
                            $('.cti-area input[name=riaBirthday]').attr("readonly", false);	//고객생년월일

                            $('.cti-area input[name=riaMemberYn]').attr("readonly", true);	//회원여부

                            $('.cti-area button').attr('login-at', "N");	//회원여부
                            //결제화면이 아니면
                            if ("N" == requestPayAt) {
                                $('.cti-area button').html('인증요청');
                            }
                        }

                        //드림센터의 경우
                        if (parent.sellChnlCd == "TELLER") {
                            $('.cti-area').show();	//cti 로그인창 표시
                        }
                        else {
                            $('.cti-area').hide();	//cti 로그인창 표시
                        }


                        //회원정보 확인을 위한 초기 파라메타 셋팅

                        //파라메타 셋팅후
                        //회원여부확인				부모창
                        //나머지 화면 disable 처리	부모창

                    }
                    else {
                        $('.quick-reserve-ad-area').show();	//광고영역 표시
                        //         $('#btnLangChg').show();	//언어전환 버튼표시 사용안함 20200106 김민영
                    }

                    /* RIA 재인증 버튼 클릭 */
                    $('.cti-area button').on("click", function () {

                        //입력값 검증
                        if ($('.cti-area button').attr('login-at') == "N") {

                            // 			if($(".cti-area input[name=riaName]").val().length == 0){
                            // 				gfn_alertMsgBoxSize('이름은  필수 입력 항목 입니다.',400,250);	//{0} 필수 입력 항목 입니다.
                            // 				return;
                            // 			}

                            if (!fn_validateDateYn($(".cti-area input[name=riaBirthday]").val())) {
                                gfn_alertMsgBoxSize('생년월일을 정확히 입력해주세요.', 400, 250);	//생년월일을 정확히 입력해주세요.
                                return;
                            }

                            if ($(".cti-area input[name=riaMobileNo]").val().length < 10) {
                                gfn_alertMsgBoxSize('휴대폰번호를 정확히 입력해주세요.', 400, 250);	//휴대폰번호를 정확히 입력해주세요.
                                return;
                            }

                            if ($(".cti-area input[name=riaMobileNo]").val().substr(0, 2) != "01") {
                                gfn_alertMsgBoxSize('휴대폰번호를 정확히 입력해주세요.', 400, 250);	//휴대폰번호를 정확히 입력해주세요.
                                return;
                            }
                        }
                        parent.fn_setRiaLoginToggle([$('.cti-area button').attr('login-at')
                            , $(".cti-area input[name=riaName]").val()
                            , $(".cti-area input[name=riaBirthday]").val()
                            , $(".cti-area input[name=riaMobileNo]").val()]
                        );
                    });


                    /* 이름 숫자를 제외한 입력 여부판단 */
                    $(".cti-area input[name=riaName]").on("keyup", function (e) {
                        var partton = /[^ㄱ-힣a-zA-Z]/g;
                        if (partton.test($(this).val())) {
                            var value = $(this).val().replace(/[^ㄱ-힣a-zA-Z]/g, "");
                            $(this).val(value);
                        }
                    });
                    $(".cti-area input[name=riaName]").focusout(function () {
                        var partton = /[^ㄱ-힣a-zA-Z]/g;
                        if (partton.test($(this).val())) {
                            var value = $(this).val().replace(/[^ㄱ-힣a-zA-Z]/g, "");
                            $(this).val(value);
                        }
                    });

                    /* 생년월일 숫자만 입력 여부판단 */
                    $(".cti-area input[name=riaBirthday]").on("keyup", function (e) {
                        $(this).val($(this).val().replace(/[^0-9]/g, ""));
                    });
                    $(".cti-area input[name=riaBirthday]").focusout(function () {
                        $(this).val($(this).val().replace(/[^0-9]/g, ""));
                    });

                    /* 휴대폰번호 숫자만 입력 여부판단 */
                    $(".cti-area input[name=riaMobileNo]").on("keyup", function (e) {
                        $(this).val($(this).val().replace(/[^0-9]/g, ""));
                    });
                    $(".cti-area input[name=riaMobileNo]").focusout(function () {
                        $(this).val($(this).val().replace(/[^0-9]/g, ""));
                    });
                });


                /*날짜 형태 확인*/
                function fn_validateDateYn(param) {
                    try {
                        var yearFront = "";
                        var year = "";
                        var month = "";
                        var day = "";

                        param = param.replace(/-/g, '');

                        // 자리수가 맞지않을때
                        if (isNaN(param) || param.length < 6 || param.length == 7) {
                            return false;
                        }

                        if (param.length == 6) {
                            year = Number(param.substring(0, 2));
                            month = Number(param.substring(2, 4));
                            day = Number(param.substring(4, 6));
                        }
                        else if (param.length == 8) {
                            var date = new Date();
                            yearFront = Number(param.substring(0, 4));
                            year = Number(param.substring(2, 4));
                            month = Number(param.substring(4, 6));
                            day = Number(param.substring(6, 8));

                            if (yearFront > date.getFullYear()) {
                                return false;
                            }
                        }
                        var dd = day / 0;

                        if (month < 1 || month > 12) {
                            return false;
                        }

                        var maxDaysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
                        var maxDay = maxDaysInMonth[month - 1];

                        // 윤년 체크
                        if (month == 2 && (year % 4 == 0 && year % 100 != 0 || year % 400 == 0)) {
                            maxDay = 29;
                        }

                        if (day <= 0 || day > maxDay) {
                            return false;
                        }
                        return true;

                    } catch (err) {
                        return false;
                    }
                }

            </script>
            <!-- cti 일때만 출력 -->
            <div class="cti-area" style="display:none">
                <p>이름</p>
                <input maxlength="20" name="riaName" type="text" title="이름 출력" class="input-text a-c w120px"
                    placeholder="이름" value="">

                <p>생년월일</p>
                <input maxlength="8" name="riaBirthday" type="text" title="생년월일 출력" class="input-text a-c w150px"
                    placeholder="6자리 또는 8자리" value="">

                <p>휴대폰번호</p>
                <input maxlength="11" name="riaMobileNo" type="text" title="휴대폰번호 출력" class="input-text a-c w150px"
                    placeholder="- 없이 입력" value="">

                <p>회원</p>
                <input name="riaMemberYn" type="text" title="회원여부 출력" class="input-text a-c w100px" value=""
                    readyonly="readyonly">


                <button type="button" class="button gray ml10" login-at="N"></button>

            </div>
            <div class="seat-select-section">
                <div class="seat-section">
                    <div class="tit-util">
                        <h3 class="tit small"> 관람인원선택<span class="sub">(최대 8매 선택가능)</span>
                        </h3>
                        <div class="right">
                            <button type="button" class="button gray-line small" id="seatMemberCntInit"> <i
                                    class="iconset ico-reset-small"></i>초기화</button>
                        </div>
                    </div>
                    <div class="seat-area">
                        <div class="seat-count" style="min-height: 52px">
                            <div class="cell">
                                <p class="txt">성인</p>
                                <div class="count"><button type="button" class="down" title="성인 좌석 선택 감소">-</button>
                                    <div class="number"><button type="button" class="now" title="성인 현재 좌석 선택 수"
                                            ticketgrpcd="TKA">0</button>
                                        <ul class="num-choice">
                                            <li><button type="button" class="btn on">0</button></li>
                                            <li><button type="button" class="btn">1</button></li>
                                            <li><button type="button" class="btn">2</button></li>
                                            <li><button type="button" class="btn">3</button></li>
                                            <li><button type="button" class="btn">4</button></li>
                                            <li><button type="button" class="btn">5</button></li>
                                            <li><button type="button" class="btn">6</button></li>
                                            <li><button type="button" class="btn">7</button></li>
                                            <li><button type="button" class="btn">8</button></li>
                                        </ul>
                                    </div><button type="button" class="up" title="성인 좌석 선택 증가">+</button>
                                </div>
                            </div>
                            <div class="cell">
                                <p class="txt">청소년</p>
                                <div class="count"><button type="button" class="down" title="청소년 좌석 선택 감소">-</button>
                                    <div class="number"><button type="button" class="now" title="청소년 현재 좌석 선택 수"
                                            ticketgrpcd="TKY">0</button>
                                        <ul class="num-choice">
                                            <li><button type="button" class="btn on">0</button></li>
                                            <li><button type="button" class="btn">1</button></li>
                                            <li><button type="button" class="btn">2</button></li>
                                            <li><button type="button" class="btn">3</button></li>
                                            <li><button type="button" class="btn">4</button></li>
                                            <li><button type="button" class="btn">5</button></li>
                                            <li><button type="button" class="btn">6</button></li>
                                            <li><button type="button" class="btn">7</button></li>
                                            <li><button type="button" class="btn">8</button></li>
                                        </ul>
                                    </div><button type="button" class="up" title="청소년 좌석 선택 증가">+</button>
                                </div>
                            </div>
                            <div class="cell">
                                <p class="txt">우대</p>
                                <div class="count"><button type="button" class="down" title="우대 좌석 선택 감소">-</button>
                                    <div class="number"><button type="button" class="now" title="우대 현재 좌석 선택 수"
                                            ticketgrpcd="TKS">0</button>
                                        <ul class="num-choice">
                                            <li><button type="button" class="btn on">0</button></li>
                                            <li><button type="button" class="btn">1</button></li>
                                            <li><button type="button" class="btn">2</button></li>
                                            <li><button type="button" class="btn">3</button></li>
                                            <li><button type="button" class="btn">4</button></li>
                                            <li><button type="button" class="btn">5</button></li>
                                            <li><button type="button" class="btn">6</button></li>
                                            <li><button type="button" class="btn">7</button></li>
                                            <li><button type="button" class="btn">8</button></li>
                                        </ul>
                                    </div><button type="button" class="up" title="우대 좌석 선택 증가">+</button>
                                </div>
                            </div>
                        </div>
                        <div class="seat-layout">
                            <div class="alert" style="display: none;"></div>
                            <div class="seat-count-before off" style="top: 0px">관람인원을 선택하십시요</div>
                            <div class="scroll m-scroll mCustomScrollbar _mCS_1 mCS_no_scrollbar">
                                <div id="mCSB_1" class="mCustomScrollBox mCS-light mCSB_vertical mCSB_inside"
                                    style="max-height: none;" tabindex="0">
                                    <div id="mCSB_1_container" class="mCSB_container mCS_no_scrollbar_y"
                                        style="position: relative; top: 0px; left: 0px; height: 210px;" dir="ltr">
                                        <div id="seatLayout" style="width: 100%; height: 210px;">
                                            <img src="img/img-theater-screen.png" alt="screen"
                                                style="position: absolute; left: 62px; top: 10px;"
                                                class="mCS_img_loaded">
                                            <div class'row'=""> <button type="button" class="btn-seat-row" title="A 행"
                                                    style="position:absolute; left:206px; top:52px;">A</button><button
                                                    type="button" title="A1 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:251px; top:50px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00100101"
                                                    rownm="A" seatno="1" seatchoidircval="1" seatchoigrpno="2"
                                                    seatchoigrpnm="A2" seatchoirowcnt="6" seatchoigrpseq="1"
                                                    seattocnt="1"><span class="num">1</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="A2 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:271px; top:50px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00100201"
                                                    rownm="A" seatno="2" seatchoidircval="1" seatchoigrpno="2"
                                                    seatchoigrpnm="A2" seatchoirowcnt="6" seatchoigrpseq="2"
                                                    seattocnt="1"><span class="num">2</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="A3 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:291px; top:50px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00100301"
                                                    rownm="A" seatno="3" seatchoidircval="1" seatchoigrpno="2"
                                                    seatchoigrpnm="A2" seatchoirowcnt="6" seatchoigrpseq="3"
                                                    seattocnt="1"><span class="num">3</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="A4 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:311px; top:50px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00100401"
                                                    rownm="A" seatno="4" seatchoidircval="1" seatchoigrpno="2"
                                                    seatchoigrpnm="A2" seatchoirowcnt="6" seatchoigrpseq="4"
                                                    seattocnt="1"><span class="num">4</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="A5 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:331px; top:50px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00100501"
                                                    rownm="A" seatno="5" seatchoidircval="1" seatchoigrpno="2"
                                                    seatchoigrpnm="A2" seatchoirowcnt="6" seatchoigrpseq="5"
                                                    seattocnt="1"><span class="num">5</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="A6 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:351px; top:50px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00100601"
                                                    rownm="A" seatno="6" seatchoidircval="1" seatchoigrpno="2"
                                                    seatchoigrpnm="A2" seatchoirowcnt="6" seatchoigrpseq="6"
                                                    seattocnt="1"><span class="num">6</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="A7 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:391px; top:50px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00100801"
                                                    rownm="A" seatno="7" seatchoidircval="0" seatchoigrpno="3"
                                                    seatchoigrpnm="A3" seatchoirowcnt="5" seatchoigrpseq="1"
                                                    seattocnt="1"><span class="num">7</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="A8 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:411px; top:50px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00100901"
                                                    rownm="A" seatno="8" seatchoidircval="0" seatchoigrpno="3"
                                                    seatchoigrpnm="A3" seatchoirowcnt="5" seatchoigrpseq="2"
                                                    seattocnt="1"><span class="num">8</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="A9 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:431px; top:50px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00101001"
                                                    rownm="A" seatno="9" seatchoidircval="0" seatchoigrpno="3"
                                                    seatchoigrpnm="A3" seatchoirowcnt="5" seatchoigrpseq="3"
                                                    seattocnt="1"><span class="num">9</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="A10 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:451px; top:50px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00101101"
                                                    rownm="A" seatno="10" seatchoidircval="0" seatchoigrpno="3"
                                                    seatchoigrpnm="A3" seatchoirowcnt="5" seatchoigrpseq="4"
                                                    seattocnt="1"><span class="num">10</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="A11 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:471px; top:50px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00101201"
                                                    rownm="A" seatno="11" seatchoidircval="0" seatchoigrpno="3"
                                                    seatchoigrpnm="A3" seatchoirowcnt="5" seatchoigrpseq="5"
                                                    seattocnt="1"><span class="num">11</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="A12 (스탠다드/장애인석)"
                                                    class="jq-tooltip seat-condition standard disabled"
                                                    style="position:absolute; left:491px; top:50px; width:20px;"
                                                    seatclasscd="DISABLED_CLS" seatzonecd="GERN_ZONE"
                                                    seatuniqno="00101301" rownm="A" seatno="12" seatchoidircval="0"
                                                    seatchoigrpno="1" seatchoigrpnm="A1" seatchoirowcnt="2"
                                                    seatchoigrpseq="1" seattocnt="1"
                                                    seatnotimsg="해당좌석은 장애인 전용 좌석으로 일반고객은 다른 좌석을 선택하여  주시기 바랍니다."><span
                                                        class="num">12</span><span class="kind">스탠다드</span><span
                                                        class="condition">판매가능</span><span
                                                        class="rank">장애인석</span></button><button type="button"
                                                    title="A13 (스탠다드/장애인석)"
                                                    class="jq-tooltip seat-condition standard disabled"
                                                    style="position:absolute; left:511px; top:50px; width:20px;"
                                                    seatclasscd="DISABLED_CLS" seatzonecd="GERN_ZONE"
                                                    seatuniqno="00101401" rownm="A" seatno="13" seatchoidircval="0"
                                                    seatchoigrpno="1" seatchoigrpnm="A1" seatchoirowcnt="2"
                                                    seatchoigrpseq="2" seattocnt="1"
                                                    seatnotimsg="해당좌석은 장애인 전용 좌석으로 일반고객은 다른 좌석을 선택하여  주시기 바랍니다."><span
                                                        class="num">13</span><span class="kind">스탠다드</span><span
                                                        class="condition">판매가능</span><span
                                                        class="rank">장애인석</span></button> <button type="button"
                                                    class="btn-seat-row" title="B 행"
                                                    style="position:absolute; left:206px; top:72px;">B</button><button
                                                    type="button" title="B1 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:251px; top:70px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00200101"
                                                    rownm="B" seatno="1" seatchoidircval="1" seatchoigrpno="4"
                                                    seatchoigrpnm="B4" seatchoirowcnt="6" seatchoigrpseq="1"
                                                    seattocnt="1"><span class="num">1</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="B2 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:271px; top:70px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00200201"
                                                    rownm="B" seatno="2" seatchoidircval="1" seatchoigrpno="4"
                                                    seatchoigrpnm="B4" seatchoirowcnt="6" seatchoigrpseq="2"
                                                    seattocnt="1"><span class="num">2</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="B3 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:291px; top:70px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00200301"
                                                    rownm="B" seatno="3" seatchoidircval="1" seatchoigrpno="4"
                                                    seatchoigrpnm="B4" seatchoirowcnt="6" seatchoigrpseq="3"
                                                    seattocnt="1"><span class="num">3</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="B4 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:311px; top:70px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00200401"
                                                    rownm="B" seatno="4" seatchoidircval="1" seatchoigrpno="4"
                                                    seatchoigrpnm="B4" seatchoirowcnt="6" seatchoigrpseq="4"
                                                    seattocnt="1"><span class="num">4</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="B5 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:331px; top:70px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00200501"
                                                    rownm="B" seatno="5" seatchoidircval="1" seatchoigrpno="4"
                                                    seatchoigrpnm="B4" seatchoirowcnt="6" seatchoigrpseq="5"
                                                    seattocnt="1"><span class="num">5</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="B6 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:351px; top:70px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00200601"
                                                    rownm="B" seatno="6" seatchoidircval="1" seatchoigrpno="4"
                                                    seatchoigrpnm="B4" seatchoirowcnt="6" seatchoigrpseq="6"
                                                    seattocnt="1"><span class="num">6</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="B7 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:391px; top:70px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00200801"
                                                    rownm="B" seatno="7" seatchoidircval="0" seatchoigrpno="5"
                                                    seatchoigrpnm="B5" seatchoirowcnt="7" seatchoigrpseq="1"
                                                    seattocnt="1"><span class="num">7</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="B8 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:411px; top:70px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00200901"
                                                    rownm="B" seatno="8" seatchoidircval="0" seatchoigrpno="5"
                                                    seatchoigrpnm="B5" seatchoirowcnt="7" seatchoigrpseq="2"
                                                    seattocnt="1"><span class="num">8</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="B9 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:431px; top:70px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00201001"
                                                    rownm="B" seatno="9" seatchoidircval="0" seatchoigrpno="5"
                                                    seatchoigrpnm="B5" seatchoirowcnt="7" seatchoigrpseq="3"
                                                    seattocnt="1"><span class="num">9</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="B10 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:451px; top:70px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00201101"
                                                    rownm="B" seatno="10" seatchoidircval="0" seatchoigrpno="5"
                                                    seatchoigrpnm="B5" seatchoirowcnt="7" seatchoigrpseq="4"
                                                    seattocnt="1"><span class="num">10</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="B11 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:471px; top:70px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00201201"
                                                    rownm="B" seatno="11" seatchoidircval="0" seatchoigrpno="5"
                                                    seatchoigrpnm="B5" seatchoirowcnt="7" seatchoigrpseq="5"
                                                    seattocnt="1"><span class="num">11</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="B12 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:491px; top:70px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00201301"
                                                    rownm="B" seatno="12" seatchoidircval="0" seatchoigrpno="5"
                                                    seatchoigrpnm="B5" seatchoirowcnt="7" seatchoigrpseq="6"
                                                    seattocnt="1"><span class="num">12</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="B13 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:511px; top:70px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00201401"
                                                    rownm="B" seatno="13" seatchoidircval="0" seatchoigrpno="5"
                                                    seatchoigrpnm="B5" seatchoirowcnt="7" seatchoigrpseq="7"
                                                    seattocnt="1"><span class="num">13</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button> <button type="button"
                                                    class="btn-seat-row" title="C 행"
                                                    style="position:absolute; left:206px; top:92px;">C</button><button
                                                    type="button" title="C1 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:251px; top:90px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00300101"
                                                    rownm="C" seatno="1" seatchoidircval="1" seatchoigrpno="6"
                                                    seatchoigrpnm="C6" seatchoirowcnt="6" seatchoigrpseq="1"
                                                    seattocnt="1"><span class="num">1</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="C2 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:271px; top:90px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00300201"
                                                    rownm="C" seatno="2" seatchoidircval="1" seatchoigrpno="6"
                                                    seatchoigrpnm="C6" seatchoirowcnt="6" seatchoigrpseq="2"
                                                    seattocnt="1"><span class="num">2</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="C3 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:291px; top:90px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00300301"
                                                    rownm="C" seatno="3" seatchoidircval="1" seatchoigrpno="6"
                                                    seatchoigrpnm="C6" seatchoirowcnt="6" seatchoigrpseq="3"
                                                    seattocnt="1"><span class="num">3</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="C4 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:311px; top:90px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00300401"
                                                    rownm="C" seatno="4" seatchoidircval="1" seatchoigrpno="6"
                                                    seatchoigrpnm="C6" seatchoirowcnt="6" seatchoigrpseq="4"
                                                    seattocnt="1"><span class="num">4</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="C5 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:331px; top:90px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00300501"
                                                    rownm="C" seatno="5" seatchoidircval="1" seatchoigrpno="6"
                                                    seatchoigrpnm="C6" seatchoirowcnt="6" seatchoigrpseq="5"
                                                    seattocnt="1"><span class="num">5</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="C6 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:351px; top:90px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00300601"
                                                    rownm="C" seatno="6" seatchoidircval="1" seatchoigrpno="6"
                                                    seatchoigrpnm="C6" seatchoirowcnt="6" seatchoigrpseq="6"
                                                    seattocnt="1"><span class="num">6</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="C7 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:391px; top:90px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00300801"
                                                    rownm="C" seatno="7" seatchoidircval="0" seatchoigrpno="7"
                                                    seatchoigrpnm="C7" seatchoirowcnt="7" seatchoigrpseq="1"
                                                    seattocnt="1"><span class="num">7</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="C8 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:411px; top:90px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00300901"
                                                    rownm="C" seatno="8" seatchoidircval="0" seatchoigrpno="7"
                                                    seatchoigrpnm="C7" seatchoirowcnt="7" seatchoigrpseq="2"
                                                    seattocnt="1"><span class="num">8</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="C9 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:431px; top:90px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00301001"
                                                    rownm="C" seatno="9" seatchoidircval="0" seatchoigrpno="7"
                                                    seatchoigrpnm="C7" seatchoirowcnt="7" seatchoigrpseq="3"
                                                    seattocnt="1"><span class="num">9</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="C10 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:451px; top:90px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00301101"
                                                    rownm="C" seatno="10" seatchoidircval="0" seatchoigrpno="7"
                                                    seatchoigrpnm="C7" seatchoirowcnt="7" seatchoigrpseq="4"
                                                    seattocnt="1"><span class="num">10</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="C11 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:471px; top:90px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00301201"
                                                    rownm="C" seatno="11" seatchoidircval="0" seatchoigrpno="7"
                                                    seatchoigrpnm="C7" seatchoirowcnt="7" seatchoigrpseq="5"
                                                    seattocnt="1"><span class="num">11</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="C12 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:491px; top:90px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00301301"
                                                    rownm="C" seatno="12" seatchoidircval="0" seatchoigrpno="7"
                                                    seatchoigrpnm="C7" seatchoirowcnt="7" seatchoigrpseq="6"
                                                    seattocnt="1"><span class="num">12</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="C13 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:511px; top:90px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00301401"
                                                    rownm="C" seatno="13" seatchoidircval="0" seatchoigrpno="7"
                                                    seatchoigrpnm="C7" seatchoirowcnt="7" seatchoigrpseq="7"
                                                    seattocnt="1"><span class="num">13</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button> <button type="button"
                                                    class="btn-seat-row" title="D 행"
                                                    style="position:absolute; left:206px; top:112px;">D</button><button
                                                    type="button" title="D1 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:251px; top:110px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00400101"
                                                    rownm="D" seatno="1" seatchoidircval="1" seatchoigrpno="8"
                                                    seatchoigrpnm="D8" seatchoirowcnt="6" seatchoigrpseq="1"
                                                    seattocnt="1"><span class="num">1</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="D2 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:271px; top:110px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00400201"
                                                    rownm="D" seatno="2" seatchoidircval="1" seatchoigrpno="8"
                                                    seatchoigrpnm="D8" seatchoirowcnt="6" seatchoigrpseq="2"
                                                    seattocnt="1"><span class="num">2</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="D3 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:291px; top:110px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00400301"
                                                    rownm="D" seatno="3" seatchoidircval="1" seatchoigrpno="8"
                                                    seatchoigrpnm="D8" seatchoirowcnt="6" seatchoigrpseq="3"
                                                    seattocnt="1"><span class="num">3</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="D4 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:311px; top:110px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00400401"
                                                    rownm="D" seatno="4" seatchoidircval="1" seatchoigrpno="8"
                                                    seatchoigrpnm="D8" seatchoirowcnt="6" seatchoigrpseq="4"
                                                    seattocnt="1"><span class="num">4</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="D5 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:331px; top:110px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00400501"
                                                    rownm="D" seatno="5" seatchoidircval="1" seatchoigrpno="8"
                                                    seatchoigrpnm="D8" seatchoirowcnt="6" seatchoigrpseq="5"
                                                    seattocnt="1"><span class="num">5</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="D6 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:351px; top:110px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00400601"
                                                    rownm="D" seatno="6" seatchoidircval="1" seatchoigrpno="8"
                                                    seatchoigrpnm="D8" seatchoirowcnt="6" seatchoigrpseq="6"
                                                    seattocnt="1"><span class="num">6</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="D7 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:391px; top:110px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00400801"
                                                    rownm="D" seatno="7" seatchoidircval="0" seatchoigrpno="9"
                                                    seatchoigrpnm="D9" seatchoirowcnt="7" seatchoigrpseq="1"
                                                    seattocnt="1"><span class="num">7</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="D8 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:411px; top:110px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00400901"
                                                    rownm="D" seatno="8" seatchoidircval="0" seatchoigrpno="9"
                                                    seatchoigrpnm="D9" seatchoirowcnt="7" seatchoigrpseq="2"
                                                    seattocnt="1"><span class="num">8</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="D9 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:431px; top:110px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00401001"
                                                    rownm="D" seatno="9" seatchoidircval="0" seatchoigrpno="9"
                                                    seatchoigrpnm="D9" seatchoirowcnt="7" seatchoigrpseq="3"
                                                    seattocnt="1"><span class="num">9</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="D10 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:451px; top:110px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00401101"
                                                    rownm="D" seatno="10" seatchoidircval="0" seatchoigrpno="9"
                                                    seatchoigrpnm="D9" seatchoirowcnt="7" seatchoigrpseq="4"
                                                    seattocnt="1"><span class="num">10</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="D11 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:471px; top:110px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00401201"
                                                    rownm="D" seatno="11" seatchoidircval="0" seatchoigrpno="9"
                                                    seatchoigrpnm="D9" seatchoirowcnt="7" seatchoigrpseq="5"
                                                    seattocnt="1"><span class="num">11</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="D12 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:491px; top:110px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00401301"
                                                    rownm="D" seatno="12" seatchoidircval="0" seatchoigrpno="9"
                                                    seatchoigrpnm="D9" seatchoirowcnt="7" seatchoigrpseq="6"
                                                    seattocnt="1"><span class="num">12</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="D13 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:511px; top:110px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00401401"
                                                    rownm="D" seatno="13" seatchoidircval="0" seatchoigrpno="9"
                                                    seatchoigrpnm="D9" seatchoirowcnt="7" seatchoigrpseq="7"
                                                    seattocnt="1"><span class="num">13</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button> <button type="button"
                                                    class="btn-seat-row" title="E 행"
                                                    style="position:absolute; left:206px; top:132px;">E</button><button
                                                    type="button" title="E1 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:251px; top:130px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00500101"
                                                    rownm="E" seatno="1" seatchoidircval="1" seatchoigrpno="10"
                                                    seatchoigrpnm="E10" seatchoirowcnt="6" seatchoigrpseq="1"
                                                    seattocnt="1"><span class="num">1</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="E2 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:271px; top:130px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00500201"
                                                    rownm="E" seatno="2" seatchoidircval="1" seatchoigrpno="10"
                                                    seatchoigrpnm="E10" seatchoirowcnt="6" seatchoigrpseq="2"
                                                    seattocnt="1"><span class="num">2</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="E3 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:291px; top:130px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00500301"
                                                    rownm="E" seatno="3" seatchoidircval="1" seatchoigrpno="10"
                                                    seatchoigrpnm="E10" seatchoirowcnt="6" seatchoigrpseq="3"
                                                    seattocnt="1"><span class="num">3</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="E4 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:311px; top:130px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00500401"
                                                    rownm="E" seatno="4" seatchoidircval="1" seatchoigrpno="10"
                                                    seatchoigrpnm="E10" seatchoirowcnt="6" seatchoigrpseq="4"
                                                    seattocnt="1"><span class="num">4</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="E5 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:331px; top:130px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00500501"
                                                    rownm="E" seatno="5" seatchoidircval="1" seatchoigrpno="10"
                                                    seatchoigrpnm="E10" seatchoirowcnt="6" seatchoigrpseq="5"
                                                    seattocnt="1"><span class="num">5</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="E6 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:351px; top:130px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00500601"
                                                    rownm="E" seatno="6" seatchoidircval="1" seatchoigrpno="10"
                                                    seatchoigrpnm="E10" seatchoirowcnt="6" seatchoigrpseq="6"
                                                    seattocnt="1"><span class="num">6</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="E7 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:391px; top:130px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00500801"
                                                    rownm="E" seatno="7" seatchoidircval="0" seatchoigrpno="11"
                                                    seatchoigrpnm="E11" seatchoirowcnt="7" seatchoigrpseq="1"
                                                    seattocnt="1"><span class="num">7</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="E8 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish"
                                                    style="position:absolute; left:411px; top:130px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00500901"
                                                    rownm="E" seatno="8" seatchoidircval="0" seatchoigrpno="11"
                                                    seatchoigrpnm="E11" seatchoirowcnt="7" seatchoigrpseq="2"
                                                    seattocnt="1"><span class="num">8</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="E9 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:431px; top:130px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00501001"
                                                    rownm="E" seatno="9" seatchoidircval="0" seatchoigrpno="11"
                                                    seatchoigrpnm="E11" seatchoirowcnt="7" seatchoigrpseq="3"
                                                    seattocnt="1"><span class="num">9</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="E10 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:451px; top:130px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00501101"
                                                    rownm="E" seatno="10" seatchoidircval="0" seatchoigrpno="11"
                                                    seatchoigrpnm="E11" seatchoirowcnt="7" seatchoigrpseq="4"
                                                    seattocnt="1"><span class="num">10</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="E11 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:471px; top:130px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00501201"
                                                    rownm="E" seatno="11" seatchoidircval="0" seatchoigrpno="11"
                                                    seatchoigrpnm="E11" seatchoirowcnt="7" seatchoigrpseq="5"
                                                    seattocnt="1"><span class="num">11</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="E12 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:491px; top:130px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00501301"
                                                    rownm="E" seatno="12" seatchoidircval="0" seatchoigrpno="11"
                                                    seatchoigrpnm="E11" seatchoirowcnt="7" seatchoigrpseq="6"
                                                    seattocnt="1"><span class="num">12</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="E13 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:511px; top:130px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00501401"
                                                    rownm="E" seatno="13" seatchoidircval="0" seatchoigrpno="11"
                                                    seatchoigrpnm="E11" seatchoirowcnt="7" seatchoigrpseq="7"
                                                    seattocnt="1"><span class="num">13</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button> <button type="button"
                                                    class="btn-seat-row" title="F 행"
                                                    style="position:absolute; left:206px; top:152px;">F</button><button
                                                    type="button" title="F1 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:251px; top:150px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00600101"
                                                    rownm="F" seatno="1" seatchoidircval="1" seatchoigrpno="12"
                                                    seatchoigrpnm="F12" seatchoirowcnt="6" seatchoigrpseq="1"
                                                    seattocnt="1"><span class="num">1</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="F2 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:271px; top:150px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00600201"
                                                    rownm="F" seatno="2" seatchoidircval="1" seatchoigrpno="12"
                                                    seatchoigrpnm="F12" seatchoirowcnt="6" seatchoigrpseq="2"
                                                    seattocnt="1"><span class="num">2</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="F3 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:291px; top:150px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00600301"
                                                    rownm="F" seatno="3" seatchoidircval="1" seatchoigrpno="12"
                                                    seatchoigrpnm="F12" seatchoirowcnt="6" seatchoigrpseq="3"
                                                    seattocnt="1"><span class="num">3</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="F4 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:311px; top:150px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00600401"
                                                    rownm="F" seatno="4" seatchoidircval="1" seatchoigrpno="12"
                                                    seatchoigrpnm="F12" seatchoirowcnt="6" seatchoigrpseq="4"
                                                    seattocnt="1"><span class="num">4</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="F5 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish"
                                                    style="position:absolute; left:331px; top:150px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00600501"
                                                    rownm="F" seatno="5" seatchoidircval="1" seatchoigrpno="12"
                                                    seatchoigrpnm="F12" seatchoirowcnt="6" seatchoigrpseq="5"
                                                    seattocnt="1"><span class="num">5</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="F6 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish"
                                                    style="position:absolute; left:351px; top:150px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00600601"
                                                    rownm="F" seatno="6" seatchoidircval="1" seatchoigrpno="12"
                                                    seatchoigrpnm="F12" seatchoirowcnt="6" seatchoigrpseq="6"
                                                    seattocnt="1"><span class="num">6</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="F7 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish"
                                                    style="position:absolute; left:391px; top:150px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00600801"
                                                    rownm="F" seatno="7" seatchoidircval="0" seatchoigrpno="13"
                                                    seatchoigrpnm="F13" seatchoirowcnt="6" seatchoigrpseq="1"
                                                    seattocnt="1"><span class="num">7</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="F8 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:411px; top:150px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00600901"
                                                    rownm="F" seatno="8" seatchoidircval="0" seatchoigrpno="13"
                                                    seatchoigrpnm="F13" seatchoirowcnt="6" seatchoigrpseq="2"
                                                    seattocnt="1"><span class="num">8</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="F9 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:431px; top:150px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00601001"
                                                    rownm="F" seatno="9" seatchoidircval="0" seatchoigrpno="13"
                                                    seatchoigrpnm="F13" seatchoirowcnt="6" seatchoigrpseq="3"
                                                    seattocnt="1"><span class="num">9</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="F10 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish"
                                                    style="position:absolute; left:451px; top:150px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00601101"
                                                    rownm="F" seatno="10" seatchoidircval="0" seatchoigrpno="13"
                                                    seatchoigrpnm="F13" seatchoirowcnt="6" seatchoigrpseq="4"
                                                    seattocnt="1"><span class="num">10</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="F11 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish"
                                                    style="position:absolute; left:471px; top:150px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00601201"
                                                    rownm="F" seatno="11" seatchoidircval="0" seatchoigrpno="13"
                                                    seatchoigrpnm="F13" seatchoirowcnt="6" seatchoigrpseq="5"
                                                    seattocnt="1"><span class="num">11</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="F12 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:491px; top:150px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00601301"
                                                    rownm="F" seatno="12" seatchoidircval="0" seatchoigrpno="13"
                                                    seatchoigrpnm="F13" seatchoirowcnt="6" seatchoigrpseq="6"
                                                    seattocnt="1"><span class="num">12</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button> <button type="button"
                                                    class="btn-seat-row" title="G 행"
                                                    style="position:absolute; left:206px; top:172px;">G</button><button
                                                    type="button" title="G1 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:251px; top:170px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00700101"
                                                    rownm="G" seatno="1" seatchoidircval="1" seatchoigrpno="14"
                                                    seatchoigrpnm="G14" seatchoirowcnt="6" seatchoigrpseq="1"
                                                    seattocnt="1"><span class="num">1</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="G2 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:271px; top:170px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00700201"
                                                    rownm="G" seatno="2" seatchoidircval="1" seatchoigrpno="14"
                                                    seatchoigrpnm="G14" seatchoirowcnt="6" seatchoigrpseq="2"
                                                    seattocnt="1"><span class="num">2</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="G3 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:291px; top:170px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00700301"
                                                    rownm="G" seatno="3" seatchoidircval="1" seatchoigrpno="14"
                                                    seatchoigrpnm="G14" seatchoirowcnt="6" seatchoigrpseq="3"
                                                    seattocnt="1"><span class="num">3</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="G4 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:311px; top:170px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00700401"
                                                    rownm="G" seatno="4" seatchoidircval="1" seatchoigrpno="14"
                                                    seatchoigrpnm="G14" seatchoirowcnt="6" seatchoigrpseq="4"
                                                    seattocnt="1"><span class="num">4</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="G5 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish"
                                                    style="position:absolute; left:331px; top:170px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00700501"
                                                    rownm="G" seatno="5" seatchoidircval="1" seatchoigrpno="14"
                                                    seatchoigrpnm="G14" seatchoirowcnt="6" seatchoigrpseq="5"
                                                    seattocnt="1"><span class="num">5</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="G6 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish"
                                                    style="position:absolute; left:351px; top:170px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00700601"
                                                    rownm="G" seatno="6" seatchoidircval="1" seatchoigrpno="14"
                                                    seatchoigrpnm="G14" seatchoirowcnt="6" seatchoigrpseq="6"
                                                    seattocnt="1"><span class="num">6</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="G7 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish"
                                                    style="position:absolute; left:391px; top:170px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00700801"
                                                    rownm="G" seatno="7" seatchoidircval="0" seatchoigrpno="15"
                                                    seatchoigrpnm="G15" seatchoirowcnt="5" seatchoigrpseq="1"
                                                    seattocnt="1"><span class="num">7</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="G8 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:411px; top:170px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00700901"
                                                    rownm="G" seatno="8" seatchoidircval="0" seatchoigrpno="15"
                                                    seatchoigrpnm="G15" seatchoirowcnt="5" seatchoigrpseq="2"
                                                    seattocnt="1"><span class="num">8</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="G9 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:431px; top:170px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00701001"
                                                    rownm="G" seatno="9" seatchoidircval="0" seatchoigrpno="15"
                                                    seatchoigrpnm="G15" seatchoirowcnt="5" seatchoigrpseq="3"
                                                    seattocnt="1"><span class="num">9</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="G10 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:451px; top:170px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00701101"
                                                    rownm="G" seatno="10" seatchoidircval="0" seatchoigrpno="15"
                                                    seatchoigrpnm="G15" seatchoirowcnt="5" seatchoigrpseq="4"
                                                    seattocnt="1"><span class="num">10</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="G11 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:471px; top:170px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00701201"
                                                    rownm="G" seatno="11" seatchoidircval="0" seatchoigrpno="15"
                                                    seatchoigrpnm="G15" seatchoirowcnt="5" seatchoigrpseq="5"
                                                    seattocnt="1"><span class="num">11</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button> <button type="button"
                                                    class="btn-seat-row" title="H 행"
                                                    style="position:absolute; left:206px; top:192px;">H</button><button
                                                    type="button" title="H3 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish"
                                                    style="position:absolute; left:291px; top:190px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00800301"
                                                    rownm="H" seatno="3" seatchoidircval="1" seatchoigrpno="16"
                                                    seatchoigrpnm="H16" seatchoirowcnt="4" seatchoigrpseq="1"
                                                    seattocnt="1"><span class="num">3</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="H4 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish"
                                                    style="position:absolute; left:311px; top:190px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00800401"
                                                    rownm="H" seatno="4" seatchoidircval="1" seatchoigrpno="16"
                                                    seatchoigrpnm="H16" seatchoirowcnt="4" seatchoigrpseq="2"
                                                    seattocnt="1"><span class="num">4</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="H5 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:331px; top:190px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00800501"
                                                    rownm="H" seatno="5" seatchoidircval="1" seatchoigrpno="16"
                                                    seatchoigrpnm="H16" seatchoirowcnt="4" seatchoigrpseq="3"
                                                    seattocnt="1"><span class="num">5</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="H6 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:351px; top:190px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00800601"
                                                    rownm="H" seatno="6" seatchoidircval="1" seatchoigrpno="16"
                                                    seatchoigrpnm="H16" seatchoirowcnt="4" seatchoigrpseq="4"
                                                    seattocnt="1"><span class="num">6</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="H7 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:391px; top:190px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00800801"
                                                    rownm="H" seatno="7" seatchoidircval="0" seatchoigrpno="17"
                                                    seatchoigrpnm="H17" seatchoirowcnt="4" seatchoigrpseq="1"
                                                    seattocnt="1"><span class="num">7</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="H8 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard finish pos"
                                                    style="position:absolute; left:411px; top:190px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00800901"
                                                    rownm="H" seatno="8" seatchoidircval="0" seatchoigrpno="17"
                                                    seatchoigrpnm="H17" seatchoirowcnt="4" seatchoigrpseq="2"
                                                    seattocnt="1"><span class="num">8</span><span
                                                        class="kind">스탠다드</span><span class="condition">선택불가</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="H9 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:431px; top:190px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00801001"
                                                    rownm="H" seatno="9" seatchoidircval="0" seatchoigrpno="17"
                                                    seatchoigrpnm="H17" seatchoirowcnt="4" seatchoigrpseq="3"
                                                    seattocnt="1"><span class="num">9</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button><button type="button"
                                                    title="H10 (스탠다드/일반)"
                                                    class="jq-tooltip seat-condition standard common"
                                                    style="position:absolute; left:451px; top:190px; width:20px;"
                                                    seatclasscd="GERN_CLS" seatzonecd="GERN_ZONE" seatuniqno="00801101"
                                                    rownm="H" seatno="10" seatchoidircval="0" seatchoigrpno="17"
                                                    seatchoigrpnm="H17" seatchoirowcnt="4" seatchoigrpseq="4"
                                                    seattocnt="1"><span class="num">10</span><span
                                                        class="kind">스탠다드</span><span class="condition">판매가능</span><span
                                                        class="rank">일반</span></button></div> <img
                                                src="img/img-door-left-right.png" alt="좌우측 출입구"
                                                style="position:absolute; left:231px; top:30px; width:16px; height: 16px;">
                                        </div>
                                    </div>
                                    <div id="mCSB_1_scrollbar_vertical"
                                        class="mCSB_scrollTools mCSB_1_scrollbar mCS-light mCSB_scrollTools_vertical">
                                        <div class="mCSB_draggerContainer">
                                            <div id="mCSB_1_dragger_vertical" class="mCSB_dragger"
                                                style="position: absolute; min-height: 30px; display: none; height: 732px; top: 0px; max-height: 382px;">
                                                <div class="mCSB_dragger_bar" style="line-height: 30px;"></div>
                                            </div>
                                            <div class="mCSB_draggerRail"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="zone-legend" style="display: none"></div>
                    </div>
                </div>
                <div class="seat-result">
                    <div class="wrap">
                        <div class="tit-area">
                            <span class="movie-grade small age-all age-15">15세이상관람가</span>
                            <p class="tit">반도</p>
                            <p class="cate">2D</p>
                        </div>
                        <div class="info-area">
                            <p class="theater">강남</p>
                            <p class="special">5관</p>
                            <p class="date"><span>2020.07.23</span><em>(목)</em></p>
                            <div class="other-time">
                                <button type="button" class="now">14:15~16:21<i class="arr"></i></button>
                                <ul class="other">
                                    <li><button type="button" choicnt="67" playschdlno="2007231372022"
                                            class="btn on ">14:15~16:21</button></li>
                                    <li><button type="button" choicnt="168" playschdlno="2007231372008"
                                            class="btn ">14:50~16:56</button></li>
                                    <li><button type="button" choicnt="72" playschdlno="2007231372015"
                                            class="btn ">15:40~17:46</button></li>
                                    <li><button type="button" choicnt="66" playschdlno="2007231372021"
                                            class="btn ">16:40~18:46</button></li>
                                    <li><button type="button" choicnt="179" playschdlno="2007231372009"
                                            class="btn ">17:15~19:21</button></li>
                                    <li><button type="button" choicnt="80" playschdlno="2007231372016"
                                            class="btn ">18:05~20:11</button></li>
                                    <li><button type="button" choicnt="73" playschdlno="2007231372035"
                                            class="btn ">18:25~20:31</button></li>
                                    <li><button type="button" choicnt="61" playschdlno="2007231372020"
                                            class="btn ">19:05~21:11</button></li>
                                    <li><button type="button" choicnt="173" playschdlno="2007231372010"
                                            class="btn ">19:40~21:46</button></li>
                                    <li><button type="button" choicnt="72" playschdlno="2007231372051"
                                            class="btn ">20:15~22:21</button></li>
                                    <li><button type="button" choicnt="76" playschdlno="2007231372017"
                                            class="btn ">20:30~22:36</button></li>
                                    <li><button type="button" choicnt="71" playschdlno="2007231372024"
                                            class="btn ">21:30~23:36</button></li>
                                    <li><button type="button" choicnt="182" playschdlno="2007231372011"
                                            class="btn ">22:05~24:11</button></li>
                                    <li><button type="button" choicnt="82" playschdlno="2007231372018"
                                            class="btn ">22:55~25:01</button></li>
                                </ul>
                            </div>
                            <p class="poster">
                                <img src="img/bando.gif" onerror="noImg(this);" alt="반도">
                            </p>
                        </div>
                        <div class="choice-seat-area">
                            <div class="legend">
                                <ul class="list">
                                    <li>
                                        <div class="seat-condition choice" title="선택한 좌석"></div> <em>선택</em>
                                    </li>
                                    <li>
                                        <div class="seat-condition finish" title="예매 완료"></div> <em>예매완료</em>
                                    </li>
                                    <li>
                                        <div class="seat-condition impossible" title="선택 불가"></div> <em>선택불가</em>
                                    </li>
                                    <li>
                                        <div class="seat-condition pos" title="띄어앉기석"></div> <em>띄어앉기석</em>
                                    </li>
                                    <li>
                                        <div class="seat-condition common" title="일반"></div> <em> 일반</em>
                                    </li>
                                    <li>
                                        <div class="seat-condition disabled" title="장애인석"></div> <em> 장애인석</em>
                                    </li>
                                </ul>
                            </div>
                            <div class="seat-num">
                                <p class="tit">선택좌석</p>
                                <div class="my-seat">
                                    <div class="seat all" title="구매가능 좌석">-</div>
                                    <div class="seat all" title="구매가능 좌석">-</div>
                                    <div class="seat all" title="구매가능 좌석">-</div>
                                    <div class="seat all" title="구매가능 좌석">-</div>
                                    <div class="seat all" title="구매가능 좌석">-</div>
                                    <div class="seat all" title="구매가능 좌석">-</div>
                                    <div class="seat all" title="구매가능 좌석">-</div>
                                    <div class="seat all" title="구매가능 좌석">-</div>
                                </div>
                            </div>
                        </div>
                        <div class="pay-area">
                            <p class="count"></p>
                            <div class="pay">
                                <p class="tit">최종결제금액</p>
                                <div class="money">
                                    <em>0</em> <span>원</span>
                                </div>
                            </div>
                        </div>
                        <div class="btn-group">
                            <a href="javaScript:void(0)" class="button" id="pagePrevious" title="이전">이전</a>
                            <a href="javaScript:void(0)" class="button disabled" id="pageNext" title="다음">다음</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="normalStyle"
        style="display:none;position:fixed;top:0;left:0;background:#000;opacity:0.7;text-indent:-9999px;width:100%;height:100%;z-index:100;">
        닫기</div>
    <div class="alertStyle"
        style="position: fixed; top: 0px; left: 0px; background: rgb(0, 0, 0); opacity: 0; width: 100%; height: 100%; z-index: 5005; display: none;">
    </div>
    <section class="alert-popup"
        style="position: fixed; padding-top: 45px; background: rgb(255, 255, 255); z-index: 5006; top: 289px; left: 400px; width: 300px; opacity: 1; display: none;"
        id="layerId_0775184337883889">
        <div class="wrap">
            <header class="layer-header">
                <h3 class="tit">알림</h3>
            </header>
            <div class="layer-con" style="height: 200px;">
                <p class="txt-common">좌석 선택이 완료되었습니다. </p>
                <div class="btn-group"><button type="button" class="button lyclose"
                        style="display: none;"></button><button type="button" class="button purple confirm">확인</button>
                </div>
            </div><button type="button" class="btn-layer-close">레이어 닫기</button>
        </div>
    </section>
    <script src="js/hmac-sha256.js"></script>
    <script src="js/enc-base64-min.js"></script>
    <script type="text/javascript">
        /*전역변수
        아이디
        패스워드  입력 완료 체크 변수 필요
        */
        var sValidateLoginIdAt = 'N';	//로그인ID  입력 검증 여부
        var sValidateLoginPwdAt = 'N';	//로그인PWD 입력 검증 여부
        var submitIng = false;
        var sCookieVal = "";	//쿠키값
        /*
        window.fbAsyncInit = function() {
            FB.init({
                appId            : '',
                  autoLogAppEvents : true,
                  xfbml            : true,
                  version          : ''
           });
        };
        
        var naverLogin = new naver.LoginWithNaverId({
            clientId: '',
            callbackUrl: location.href,
            isPopup: false,
            callbackHandle: false
            // callback 페이지가 분리되었을 경우에 callback 페이지에서는 callback처리를 해줄수 있도록 설정합니다.
        });
        */

        $(function () {
            /*로그인 버튼 비활성*/
            $("#btnLogin").attr("disabled", true);

            /*쿠키조회 pc 아이디값 입력 및 자동로그인 체크*/
            sCookieVal = fn_getCookie('loginId');
            if (!(sCookieVal == null || sCookieVal == "")) {
                $("#ibxLoginId").val(sCookieVal);
                $("input:checkbox[id='chkIdSave']").prop("checked", true);
                fn_validateInputVal("loginId", sCookieVal);
            }

            /*이벤트*/
            /*로그인*/
            $("#btnLogin").click(function () {
                var sLoginId = $("#ibxLoginId").val();
                var sLloginPwd = $("#ibxLoginPwd").val();

                // 		//아이디 생성규칙 확인
                // 		if(!fn_validateInputVal("loginId" ,$("#ibxLoginId").val(), 'Y')) {
                // 			$("#ibxLoginId").focus();
                // 			return;
                // 		}
                // 		//패스워드 생성규칙확인
                // 		if(!fn_validateInputVal("loginPwd",$("#ibxLoginPwd").val(), 'Y')) {
                // 			$("#ibxLoginPwd").focus();
                // 			return;
                // 		}

                $('#error-text').text('');

                //아이디 저장 버튼 체크시 쿠키 설정
                if ($("input:checkbox[id='chkIdSave']").is(":checked")) {
                    fn_setCookie('loginId', $("#ibxLoginId").val(), 730);
                }
                //아이디 저장 체크 안했을때 쿠키 삭제
                else if (!$("input:checkbox[id='chkIdSave']").is(":checked")) {
                    fn_deleteCookie('loginId');
                }

                fn_selectMbLogin(sLoginId, sLloginPwd);	//로그인
            });

            /*아이디 입력시 체크 */
            $("#ibxLoginId").on("keyup", function (e) {
                if (fn_validateInputVal("loginId", $(this).val())) {
                    if (e.keyCode == 13) { $("#btnLogin").click(); }
                } else {
                    if (e.keyCode == 13) { $("#ibxLoginPwd").focus(); }
                }

                return;
            });

            /*비밀번호 입력체크 */
            $("#ibxLoginPwd").on("keyup", function (e) {
                if (fn_validateInputVal("loginPwd", $(this).val())) {
                    if (e.keyCode == 13) { $("#btnLogin").click(); }
                }
                return;
            });


            // 페이스북 로그인
            $('.login-facebook').on('click', function (e) {
                e.preventDefault();

                var type = $(this).data('type');

                FB.login(function (response) {
                    if (response.authResponse.userID) {
                        $.ajaxMegaBox({
                            url: '/on/oh/ohg/MbLogin/selectMbSimpleLogin.rest',
                            data: JSON.stringify({ simpleLoginId: response.authResponse.userID, type: type }),
                            success: function (data) {
                                if (data.result) {
                                    AppHandler.Common.goMain();  // 메인페이지로 이동
                                } else {
                                    AppHandler.Common.alert('본 서비스는 메가박스 회원인 경우에만  이용하실 수 있습니다.\n회원가입 후 이용 부탁 드립니다.');
                                }
                            }
                        });
                    }
                });
            });
        });

        //쿠키설정
        function fn_setCookie(cname, cvalue, exdays) {
            var d = new Date();
            d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
            var expires = "expires=" + d.toUTCString();
            document.cookie = cname + "=" + cvalue + "; " + expires + ";path=/";
        }

        //쿠키조회
        function fn_getCookie(name) {
            var value = document.cookie.match('(^|;) ?' + name + '=([^;]*)(;|$)');
            return value ? value[2] : null;

        }

        //쿠키삭제
        function fn_deleteCookie(name) {
            var d = new Date();
            d.setTime(d.getDate() - 1);
            var expires = "expires=" + d.toUTCString();
            document.cookie = name + "=;" + expires + ";path=/";
        }


        //입력 문자 체크
        function fn_validateInputVal(type, sVal, submitAt) {
            if (type == "loginId") {		  //아이디

                if (sVal == "") {
                    sValidateLoginIdAt = 'N';
                }
                // 		if (!/((?=.{8,})(?=.*[0-9])(?=.*[a-zA-Z]).*$)/g.test(sVal)) {
                // 			$('#error-text').text('아이디는 영문,숫자 조합 8자리 이상 12자리 이하 입니다.');
                // 			sValidateLoginIdAt = 'N';
                // 		}
                // 		else if (/((?=.{8,})(?=.*[~!@#$%^&*+=-]).*$)/g.test(sVal)) {
                // 			$('#error-text').text('아이디는 영문,숫자 조합 8자리 이상 12자리 이하 입니다.');
                // 			sValidateLoginIdAt = 'N';
                // 		}
                else {
                    $('#error-text').text('');
                    sValidateLoginIdAt = 'Y';
                }
            }
            else if (type == "loginPwd") { //패스워드
                if (sVal == "") {
                    sValidateLoginPwdAt = 'N';
                }
                // 		if (!/((?=.{10,})(?=.*[0-9])(?=.*[a-zA-Z]).*$)|((?=.{10,})(?=.*[~!@#$%^&*+=-])(?=.*[a-zA-Z]).*$)|((?=.{10,})(?=.*[!@#$%^&*+=-])(?=.*[0-9]).*$)/g.test(sVal)) {
                // 			$('#error-text').text('비밀번호는 영문,숫자,특수기호 중 2가지 이상 조합하여 10자리 이상 16자리 이하 입니다.');
                // 			sValidateLoginPwdAt = 'N';
                // 		}
                else {
                    $('#error-text').text('');
                    sValidateLoginPwdAt = 'Y';
                }
            }

            if (submitAt != 'Y') {
                if (sValidateLoginIdAt == 'Y' && sValidateLoginPwdAt == 'Y') {
                    $("#btnLogin").attr("disabled", false);	//버튼활성화
                }
                else {
                    $("#btnLogin").attr("disabled", true);	//버튼비활성화
                }
            }

            if (sValidateLoginIdAt == 'N' || sValidateLoginPwdAt == 'N') {
                return false;
            }

            return true;
        }


        //패스워드 3개월 초과시 다음에 하기 버튼 누를경우 비밀번호 변경일자 오늘날자로 셋팅
        //비번 재설정은 3개월 미변경시, 변경 안하면 로그인 할때마다 alert 나옴 20190507
        function fn_updatePwdUptDt(sLoginId) {
            var paramData = { loginId: sLoginId };
            $.ajaxMegaBox({
                url: "/on/oh/ohg/MbLogin/updateMbPwdReSet.rest",
                type: "POST",
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                data: JSON.stringify(paramData),
                success: function (data, textStatus, jqXHR) {
                    //메인 화면으로 이동
                    $(location).attr('href', '/main');
                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(xhr.status);
                    alert(err.message);
                }
            });
        }

        //로그인
        function fn_selectMbLogin(sLoginId, sLloginPwd, snsLoginAt, redisKey) {

            if (submitIng) return;

            /* 폼데이터 초기화 */
            $('#loginForm input[name=certType]').val();								//본인인증 모듈 코드값 초기화
            var sMenuId = $('input[name=menuId]').val();							//호출화면id
            var sMappingId = $('input[name=mappingId]').val();						//리턴URL
            var sSnsLogin = typeof snsLoginAt == 'undefined' ? "N" : snsLoginAt;	//sns로그인 여부

            var validLoginId = sLoginId != null ? sLoginId.replace(/ /gi, "") : "";
            var validLoginPwd = sLloginPwd != null ? sLloginPwd.replace(/ /gi, "") : "";

            if (validLoginPwd != "simpleLogin") {
                if (validLoginId == "" || validLoginPwd == "") {
                    gfn_alertMsgBoxSize('로그인 정보를 입력해 주세요.', 400, 250);	//로그인 정보를 입력해 주세요.
                    return;
                }
            }

            var paramData = {
                loginId: sLoginId
                , loginPwd: sLloginPwd
                , menuId: sMenuId
                , mappingId: sMappingId
                , snsLogin: sSnsLogin
                , redisKey: redisKey
            };

            $.ajaxMegaBox({
                url: "/on/oh/ohg/MbLogin/selectMbLoginInfo.rest",
                data: JSON.stringify(paramData),
                //async: false,
                success: function (data, textStatus, jqXHR) {
                    var revStr = data.revStr;
                    var redisKey = data.redisKey;
                    var pwdErrCnt = data.pwdErrCnt + 1;
                    var loginPwdLstUptDt = data.loginPwdLstUptDt;
                    var pwdUptDayco = data.pwdUptDayco;
                    var menuId = data.menuId;
                    var mappingId = data.mappingId;
                    var marketRcvStr = data.marketRcvStr
                    var loginIdStar = data.loginIdStar;

                    //비밀번호 5회 오류	//본인인증 수단 선택 M-ME-DA-01
                    if (revStr == "acctLock") {
                        $('#loginForm input[name=redisKey]').attr('value', redisKey);
                        $('#loginForm input[name=certType]').attr('value', 'SCRC05');
                        var options = {};
                        options.msg = '로그인정보가 5회 이상 잘못 입력되었습니다.\n회원인증 후 새로운 비밀번호를 설정해 주세요.';	//비밀번호 5회 이상 잘못 입력되었습니다.\n본인인증 후 새로운 비밀번호를 설정해 주세요.
                        options.callback = fn_mvPage;
                        options.param = { confirm: '/on/oh/ohg/MbLogin/viewMbSimpleCertPage.rest' };	//간편인증페이지
                        options.minWidth = 400;
                        options.minHeight = 250;
                        gfn_alertMsgBox(options);
                        return;
                    }
                    //비밀번호 변경9개월 초과 //비밀번호 재설정 M-ME-FI-04	비밀번호변경 9개월 체크 하지 않음. 무조건 3개월 연장
                    // 			else if (revStr == "loginPwdUpt9mm") {
                    // 				$('input[name=loginId]').attr('value',loginId);
                    // // 				mbLayer.toggle({id:revStr, msg:'회원님의 개인정보 보호를 위해 3개월마다 비밀번호 변경 안내해드리고 있습니다.\n마지막 변경일 : '+loginPwdLstUptDt+'('+pwdUptDayco+'일전)', btn:'비밀번호 변경', callback:fn_mvPage, param:'/pw-register', minHeight:200, type:'single' });
                    // 				var options      = {};
                    // 				options.msg      = '회원님의 개인정보 보호를 위해 3개월마다 비밀번호 변경 안내해드리고 있습니다.\n마지막 변경일 : '+loginPwdLstUptDt+'('+pwdUptDayco+'일전)';
                    // 				options.okBtnTxt = "비밀번호 변경";
                    // 				options.callback = fn_mvPage;
                    // 				options.param    = {confirm:'/pw-register'};
                    // 				options.minWidth  = 400;
                    // 				options.minHeight = 250;
                    // 				gfn_alertMsgBox(options);
                    // 				return;
                    // 			}
                    //비밀번호 변경3개월 초과	//다음에하기, 비밀번호 재설정 M-ME-FI-04
                    else if (revStr == "loginPwdUpt3mm") {
                        $('#loginForm input[name=redisKey]').attr('value', redisKey);
                        var options = {};
                        options.msg = '회원님의 개인정보 보호를 위해 3개월마다 비밀번호 변경안내를 시행하고 있습니다.\n안전한 서비스 이용을 위해 비밀번호 변경 후 이용바랍니다.\n지금 변경 하시겠습니까?\n\n마지막 변경일 : ' + loginPwdLstUptDt + '(' + pwdUptDayco + '일전)';
                        options.confirmFn = fn_mvPage;
                        options.cancelFn = fn_loginSuccessEvent;
                        options.okBtnTxt = "비밀번호 재설정";
                        options.cancelBtnTxt = "다음에 하기";
                        options.minWidth = 400;
                        options.minHeight = 300;
                        options.param = { confirm: "/pw-register" };
                        gfn_confirmMsgBox(options);
                        return;
                        // 				if(confirm('회원님의 개인정보 보호를 위해 3개월마다 비밀번호 변경안내를 시행하고 있습니다.\n안전한 서비스 이용을 위해 비밀번호 변경 후 이용바랍니다.\n지금 변경 하시겠습니까?\n\n마지막 변경일 : '+loginPwdLstUptDt+'('+pwdUptDayco+'일전)')){
                        // 					$('input[name=loginId]').attr('value',loginId);
                        // 					fn_mvPage('/pw-register');
                        // 					return;
                        // 				}
                        // 				else {
                        // 					fn_mvPage("/main");	//메인페이지로 이동
                        // 					return;
                        // 				}
                    }
                    //마케팅 수신일 2년 초과	//todo 다음에하기, 수신동의 설정 내정보 수정화면 개발후연결
                    else if (revStr == "marketRcv") {
                        var options = {};
                        options.msg = '마케팅 수신 동의일로부터 2년이 경과되어, 수신에 대한 재동의 안내를 시행하고 있습니다. \n메가박스의 다양한 소식 및 이벤트를 받고 싶으시면 수신동의 재설정이 필요합니다.  \n수신동의 재설정을 진행 하시겠습니까?\n\n[수신동의 정보]\n' + marketRcvStr + '';
                        //options.msg        = '마케팅 수신 동의일로부터 2년이 경과되어, 수신에 대한 재동의 안내를 시행하고 있습니다. \n메가박스의 다양한 소식 및 이벤트를 받고 싶으시면 수신동의 재설정이 필요합니다.  \n수신동의 재설정을 진행 하시겠습니까?\n\n[수신동의 정보]\n&#39;+lstSmsRcvAgreeDt+&#39;'.replaceAll('\n','<br/>');
                        options.confirmFn = fn_mvPage;
                        options.cancelFn = fn_loginSuccessEvent;
                        options.okBtnTxt = "수신동의 설정";
                        options.cancelBtnTxt = "다음에 하기";
                        options.param = { confirm: "/on/oh/ohh/Mypage/userAdditInfoPage.do?marketRcvReAgree=Y" };
                        options.minWidth = 400;
                        options.minHeight = 300;
                        gfn_confirmMsgBox(options);
                        return;
                    }
                    //관리자에의한 패스워드 초기화 //비밀번호 재설정 M-ME-FI-04	관리자에 의한 패스워드 초기화는 없다.
                    // 			else if (revStr == "loginPwdReset") {
                    // // 				mbLayer.toggle({id:revStr, msg:'비밀번호 재설정이 완료되었습니다. 다시 로그인해 주시기 바랍니다.', btn:'확인', callback:fn_mvPage, param:'/pw-register', minHeight:200, type:'single' });
                    // 				var options = {};
                    // 				options.msg = '비밀번호 재설정이 완료되었습니다. 다시 로그인해 주시기 바랍니다.';
                    // 				options.callback  = fn_mvPage;
                    // 				options.param = {confirm:'/pw-register'};
                    // 				options.minWidth  = 400;
                    // 				options.minHeight = 250;
                    // 				gfn_alertMsgBox(options);
                    // 				return;
                    // 			}
                    //휴면계정복구 안내	//TODO 다음에하기, 휴면계정복구 본인인증 수단 선택 M-ME-DA-01
                    else if (revStr == "mbSchIdGuideDormAcct") {
                        $('#loginForm input[name=certType]').attr('value', 'SCRC03');
                        $('#loginForm input[name=redisKey]').attr('value', redisKey);
                        var options = {};
                        options.msg = '회원님의 아이디는 [' + loginIdStar + '] 메가박스 온라인 서비스를 1년이상 이용하지 않아 휴면계정으로 전환되었습니다. 휴면계정 복구 후 서비스 이용이 가능합니다.\n휴면계정 복구를 진행하시겠습니까?';
                        options.okBtnTxt = "휴면계정복구";
                        options.callback = fn_mvPage;
                        options.param = { confirm: "/member-check" };
                        options.minWidth = 400;
                        options.minHeight = 300;
                        gfn_alertMsgBox(options);
                        return;
                    }
                    //탈퇴회원안내
                    else if (revStr == "quitMb") {
                        gfn_alertMsgBoxSize('회원탈퇴 후 1개월 이내 재가입할 수 없습니다.\n메가박스 고객센터로 문의해 주세요', 400, 250);	//회원탈퇴 후 1개월 이내 재가입할 수 없습니다. 메가박스 고객센터로 문의해 주세요
                        return;
                    }
                    //loginPwdFail 패스워드실패안내, mbJoinReq 회원가입안내, mbInfoSearchUnable 탈퇴회원안내
                    else if (revStr == "loginPwdFail" || revStr == "mbJoinReq" || revStr == "mbInfoSearchUnable") {
                        // 				$('.alert').text('로그인 정보가 잘못되었습니다. (로그인 '+pwdErrCnt+'/5회 실패)');	2020-02-06 메가박스 차세대 이행/안정화 결함대장 28번
                        $("#ibxLoginId").val("");
                        $("#ibxLoginPwd").val("");
                        gfn_alertMsgBoxSize('아이디 또는 비밀번호가 맞지 않습니다.\n로그인 정보를 다시 확인바랍니다.', 400, 250);	//msg.ch.ohg.ME031=아이디 또는 비밀번호가 맞지 않습니다.\\n로그인 정보를 다시 확인바랍니다.
                        $("#btnLogin").attr("disabled", true);	//버튼비활성화
                        sValidateLoginPwdAt = 'N';
                        return;
                    }

                    if (typeof loginPopupCallScn === "undefined") {
                        loginPopupCallScn = "";
                    }
                    // 		    console.log("this : "+loginPopupCallScn);
                    //화면이동
                    if (menuId != "" && menuId != null) {  //화면으로 띄웠을떄
                        fn_mvPage(mappingId);
                        return;
                    }
                    else {

                        fn_loginSuccessEvent();

                    }
                    return;
                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(xhr.status);
                    alert(err.message);
                },
                beforeSend: function () {
                    submitIng = true;
                },
                complete: function () {
                    submitIng = false;
                }
            });

            function fn_loginSuccessEvent() {

                var bokdLoginAt = $('#loginForm input[name=bokdLoginAt]').val();
                var reloadYn = $('#loginForm input[name=reloadYn]').val();
                var validDataRevisnYn = $('#loginForm input[name=validDataRevisnYn]').val();				//데이터 보정 여부

                if (bokdLoginAt == "Y") {
                    //예매로그인일경우
                    //오입력값을 체크한다.
                    $('.before').hide();
                    $('.after').show();
                    $('.after .notice').show();
                    $('#layer_login_select button.btn-modal-close').trigger("click");
                    fn_validDataRevisn(JSON.parse($('#loginForm input[name=bokdLoginParam]').val()));
                }
                else {
                    if (reloadYn == "N") {

                        $('.before').hide();
                        $('.after').show();
                        $('.after .notice').show();
                        $('#layer_login_select button.btn-modal-close').trigger("click");
                        if (validDataRevisnYn == "Y") {
                            fn_validDataRevisn();
                        }
                    } else {

                        //화면 리로드
                        //location.reload();
                        //post submit시 브라우저 경고창 관련
                        window.document.location.href = window.document.URL;


                        ////////////////////////////////////////////
                        // TODO 빵원쿠폰일 경우에만 처리되도록 수정 //
                        ////////////////////////////////////////////
                        $(".btn-modal-close").click();
                        ////////////////////////////////////////////
                        ////////////////////////////////////////////
                    }
                }
            }

            //페이지 이동 submit
            function fn_mvPage(page) {
                // 		console.log("MbLoginScriptDV.fn_mvPage : "+page);

                var rtnParam = $("#loginForm [name=rtnParam]").val();

                if (rtnParam.trim() != "") {

                    var arr;
                    var html = '<input type="hidden" name="#1" value="#2" />';

                    $.each(rtnParam.split(','), function (i, val) {

                        arr = val.split(':');
                        arr[0] = arr[0].trim();
                        arr[1] = arr[1].trim();
                        arr[2] = '[name=' + arr[0] + ']';

                        if ($("#loginForm").find(arr[2]).length > 0) {
                            $("#loginForm").find(arr[2]).val(arr[1]);
                        } else {
                            $("#loginForm").append(html.replace('#1', arr[0]).replace('#2', arr[1]));
                        }
                    });
                }

                $("#loginForm").attr("method", "post");
                $("#loginForm").attr("action", page);
                $("#loginForm input[name=preUrl]").val(document.location.pathname)
                $("#loginForm").submit();
            }
        }
        /* 비회원 */
        var sValidateNonMbNmAt = "N";
        var sValidateNonMbByymmddAt = "N";
        var sValidateNonMbTelnoAt = "N";

        var sValidateMblpCharCertNo = "N";

        var sValidateNonMbPwdAt = "N";
        var sValidateNonMbPwdConfirmAt = "N";
        var sValidateNonMbPwdEqualAt = "N";
        var sValidateNonMbBokdPersonInfoProc = "N";
        var sValidateMblpCertNoSuccess = "N";

        var AuthTimer;
        var bokdCnfmAt = "N";

        //이벤트
        $(function () {
            if (typeof $("#ibxNonMbPwdConfirm").val() == 'undefined') {
                bokdCnfmAt = "Y";
            }
            fn_validateNonMbInputVal();
            /*비회원 로그인 버튼 비활성화*/
            $("#btnMbLogin").attr("disabled", true);

            /*비회원 정보 확인 버튼 비활성화*/
            $("#btnChkNonMbLogin").attr("disabled", true);
            $("#btnNonMbLogin").attr("disabled", true);

            /* 이름 숫자를 제외한 입력 여부판단 */
            $("#ibxNonMbNm").on("keyup", function (e) {
                var partton = /[^ㄱ-힣a-zA-Z]/g;
                if (partton.test($(this).val())) {
                    var value = $(this).val().replace(/[^ㄱ-힣a-zA-Z]/g, "");
                    $(this).val(value);
                }
                if (fn_validateNonMbInputVal()) {
                    if (e.keyCode == 13) { $("#btnChkNonMbLogin").click(); }
                } else {
                    if (e.keyCode == 13) { $("#ibxNonMbByymmdd").focus() };
                }
            });
            $("#ibxNonMbNm").focusout(function () {
                var partton = /[^ㄱ-힣a-zA-Z]/g;
                if (partton.test($(this).val())) {
                    var value = $(this).val().replace(/[^ㄱ-힣a-zA-Z]/g, "");
                    $(this).val(value);
                }
                fn_validateNonMbInputVal();
            });

            /* 생년월일 숫자만 입력 여부판단 */
            $("#ibxNonMbByymmdd").on("keyup", function (e) {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));
                if (fn_validateNonMbInputVal()) {
                    if (e.keyCode == 13) { $("#btnChkNonMbLogin").click(); }
                } else {
                    if (e.keyCode == 13) { $("#ibxNonMbTelno").focus(); }
                }
            });
            $("#ibxNonMbByymmdd").focusout(function () {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));
                fn_validateNonMbInputVal();
            });

            /* 휴대폰번호 숫자만 입력 여부판단 */
            $("#ibxNonMbTelno").on("keyup", function (e) {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));

                //휴대폰 번호
                if ($("#ibxNonMbTelno").val() != "") {
                    var frontNm = $("#ibxNonMbTelno").val().substr(0, 2);
                    if (frontNm != '01') {
                        $('#mblpInput-error-text').text('휴대폰번호를 정확히 입력해주세요.');
                        ibxNonMbTelno = 'N';
                        return false;
                    }
                    else if ($("#ibxNonMbTelno").val().length < 10) {
                        $('#mblpInput-error-text').text('휴대폰번호를 정확히 입력해주세요.');
                        sValidateNonMbTelnoAt = 'N';
                        return false;
                    }
                    else {
                        sValidateNonMbTelnoAt = 'Y';
                        $('#mblpInput-error-text').text('');
                    }
                }
                else {
                    sValidateNonMbTelnoAt = 'N';
                }

                //console.log("sValidateNonMbTelnoAt", sValidateNonMbTelnoAt);
                //console.log("sValidateMblpCertNoSuccess", sValidateMblpCertNoSuccess);

                //인증번호 전송 버튼 활성화
                if (sValidateNonMbTelnoAt == 'Y' && sValidateMblpCertNoSuccess == 'N') {
                    $("#nonMbCertNoSend").attr("disabled", false);
                    $("#nonMbCertNoSend").removeClass("disabled");
                    if (window.fn_validateJoinInfoRegInputVal) {
                        //sValidateMblpCertNoSuccess = "Y";
                        fn_validateJoinInfoRegInputVal();
                    }
                }
                else {
                    $("#nonMbCertNoSend").attr("disabled", true);
                    $("#nonMbCertNoSend").addClass("disabled");
                    if (window.fn_validateJoinInfoRegInputVal) {
                        //sValidateMblpCertNoSuccess = "N";
                        fn_validateJoinInfoRegInputVal();
                    }
                }

                if (e.keyCode != 9) {
                    if (typeof AuthTimer != 'undefined') {
                        AuthTimer.fnStop();
                        $('#timer').html("3:00");
                        $('#nonMbCertNoSend').html("인증요청");
                        sValidateMblpCertNoSuccess = "N";
                        $('#nonMbCertRow').show();
                        $('#mblpCharCertNo').val("");
                        $("#nonMbCertNoSend").removeClass("disabled");
                        $("#nonMbCertNoSend").attr("disabled", false);
                        $("#btnMblpCharCert").attr("disabled", true);
                        $("#btnMblpCharCert").addClass("disabled");
                        if (fn_validateNonMbInputVal()) {
                            if (e.keyCode == 13) { $("#btnChkNonMbLogin").click(); }
                        } else {
                            if (e.keyCode == 13) { $("#nonMbCertNoSend").click(); }
                        }
                    }
                    else {
                        if (fn_validateNonMbInputVal()) {
                            if (e.keyCode == 13) { $("#btnChkNonMbLogin").click(); }
                        } else {
                            if (e.keyCode == 13) { $("#ibxNonMbPwd").focus(); }
                        }
                    }
                }
            });
            $("#ibxNonMbTelno").focusout(function () {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));
                fn_validateNonMbInputVal();
            });

            /* 인증번호 숫자만 입력 여부 판단*/
            $("#mblpCharCertNo").on("keyup", function (e) {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));

                if ($("#mblpCharCertNo").val().length >= 4) {
                    $("#btnMblpCharCert").removeClass("disabled");
                    $("#btnMblpCharCert").attr("disabled", false);
                }
                else {
                    $("#btnMblpCharCert").attr("disabled", true);
                    $("#btnMblpCharCert").addClass("disabled");
                }

                if (e.keyCode == 13) { $("#btnMblpCharCert").click(); }
            });
            $("#mblpCharCertNo").focusout(function () {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));
                if ($("#mblpCharCertNo").val().length >= 4) {
                    $("#btnMblpCharCert").removeClass("disabled");
                    $("#btnMblpCharCert").attr("disabled", false);
                }
                else {
                    $("#btnMblpCharCert").attr("disabled", true);
                    $("#btnMblpCharCert").addClass("disabled");
                }
            });

            /* 비밀번호 숫자만 입력 여부판단 */
            $("#ibxNonMbPwd").on("keyup", function (e) {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));
                if (fn_validateNonMbInputVal()) {
                    if (e.keyCode == 13) { $("#btnChkNonMbLogin").click(); }
                } else {
                    if (e.keyCode == 13) { $("#ibxNonMbPwdConfirm").focus(); }
                }
            });
            $("#ibxNonMbPwd").focusout(function () {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));
                fn_validateNonMbInputVal();
            });

            /* 비밀번호 확인 숫자만 입력 여부판단 */
            $("#ibxNonMbPwdConfirm").on("keyup", function (e) {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));
                if (fn_validateNonMbInputVal()) {
                    if (e.keyCode == 13) { $("#btnChkNonMbLogin").click(); }
                }
            });
            $("#ibxNonMbPwdConfirm").focusout(function () {
                $(this).val($(this).val().replace(/[^0-9]/g, ""));
                fn_validateNonMbInputVal();
            });

            //체크박스 변경여부
            $("#chkNonMbBokdPersonInfoProcTrue").change(function () {
                if ($('#chkNonMbBokdPersonInfoProcTrue').is(":checked")) {
                    fn_validateNonMbInputVal();
                }
                else {
                    fn_validateNonMbInputVal();
                }
            });

            $("#chkNonMbBokdPersonInfoProcFalse").change(function () {
                if ($('#chkNonMbBokdPersonInfoProcFalse').is(":checked")) {
                    fn_validateNonMbInputVal();
                }
                else {
                    fn_validateNonMbInputVal();
                }
            });

            /*이벤트*/
            /* 인증번호 전송 버튼 클릭*/
            $("#nonMbCertNoSend").click(function () {
                if ($("#nonMbCertNoSend").hasClass("disabled")) {
                    return;
                }

                var sRedisKey = $('#loginForm input[name=nonMbCertRedisKey]').val();
                var sNonMbTelno = $('#ibxNonMbTelno').val();
                var paramData = {
                    redisKey: sRedisKey
                    , nonMbTelno: sNonMbTelno
                };

                $('#nonMbCert-error-text').text('');

                $.ajaxMegaBox({
                    url: "/on/oh/ohg/MbLogin/selectNonMbCertNoSend.rest",
                    type: "POST",
                    contentType: "application/json;charset=UTF-8",
                    dataType: "json",
                    data: JSON.stringify(paramData),
                    success: function (data, textStatus, jqXHR) {
                        $('input[name=nonMbCertRedisKey]').attr('value', data.resultMap.redisKey);

                        if (data.resultMap.successAt == "N") {
                            //비회원로그인-예매
                            var bokdLoginAt = $('#loginForm input[name=bokdLoginAt]').val();
                            if (bokdLoginAt == "Y") {
                                //예매로그인일경우
                                //인증시간이 만료된 경우
                                if (data.resultMap.msg == "ME061") {
                                    gfn_alertMsgBoxSize('인증시간이 만료되었습니다. 인증번호를 재전송 후 입력바랍니다.', 400, 250);	//인증시간이 만료되었습니다. 인증번호를 재전송 후 입력바랍니다.
                                }
                                //동일번호로 3회 이상 요청하는경우
                                else if (data.resultMap.msg == "ME062") {
                                    //오입력값을 체크한다.
                                    $('.before').hide();
                                    $('.after').show();
                                    $('#btnNonMbModalClose').trigger("click");
                                    $('#layer_login_select button.btn-modal-close').trigger("click");
                                    gfn_alertMsgBoxSize('동일번호로 연속적인 인증이 발생하여 창을 닫습니다.\n3분후 다시 시도해 주세요.', 400, 250);	//동일번호로 연속적인 인증이 발생하여 창을 닫습니다.\\n번호를 확인 한 후 처음부터 다시 진행바랍니다.
                                }

                            }
                            else {
                                //회원가입
                                var options = {};
                                options.msg = '동일번호로 연속적인 인증이 발생하여 창을 닫습니다.\n3분후 다시 시도해 주세요.';	//동일번호로 연속적인 인증이 발생하여 창을 닫습니다.\\n처음부터 다시 이용바랍니다.
                                options.callback = fn_mvMainPage;
                                options.minWidth = 400;
                                options.minHeight = 250;
                                gfn_alertMsgBox(options);
                            }
                            return;
                        }
                        else {
                            //nonMbCertRedisKey
                            //console.log("certNo", data.resultMap.certNo);
                            $('#nonMbCertNoSend').html("재전송");
                            $('#loginForm input[name=nonMbCertedMblpNo]').attr('value', sNonMbTelno);
                            gfn_alertMsgBoxSize('인증번호를 전송했습니다.\n인증번호가 도착하지 않았을 경우 재전송을 눌러 주세요.', 400, 250);

                            if (typeof AuthTimer != 'undefined') {
                                AuthTimer.fnStop();
                                $('#timer').html("3:00");
                            }
                            else {
                                AuthTimer = new $ComTimer();
                            }
                            AuthTimer.comSecond = 180;
                            AuthTimer.fnCallback = function () { alert("다시인증을 시도해주세요.") }
                            AuthTimer.timer = setInterval(function () { AuthTimer.fnTimer() }, 1000);
                            AuthTimer.domId = document.getElementById("timer");
                            //입력하신 휴대폰 번호로 인증번호가 발송되었습니다. 확인 후 인증번호를 입력해주세요!
                        }
                    },
                    error: function (xhr, status, error) {
                        var err = JSON.parse(xhr.responseText);
                        alert(xhr.status);
                        alert(err.message);
                    }
                });
            });


            //인증번호 확인 버튼 클릭
            $("#btnMblpCharCert").click(function () {
                if ($("#btnMblpCharCert").hasClass("disabled")) {
                    return;
                }

                var sRedisKey = $('#loginForm input[name=nonMbCertRedisKey]').val();
                var sMblpCharCertNo = $('#mblpCharCertNo').val();
                var sNonMbTelno = $('#ibxNonMbTelno').val();
                var paramData = {
                    redisKey: sRedisKey
                    , certNo: sMblpCharCertNo
                    , nonMbTelno: sNonMbTelno
                };

                $.ajaxMegaBox({
                    url: "/on/oh/ohg/MbLogin/selectNonMbCertNoCnfn.rest",
                    type: "POST",
                    contentType: "application/json;charset=UTF-8",
                    dataType: "json",
                    data: JSON.stringify(paramData),
                    success: function (data, textStatus, jqXHR) {
                        var successAt = data.resultMap.successAt;
                        var msg = data.resultMap.msg;
                        var redisKey = data.resultMap.redisKey;

                        if (successAt == "Y") {
                            sValidateMblpCertNoSuccess = "Y";
                            fn_validateNonMbInputVal();
                            $('#loginForm input[name=nonMbCertRedisKey]').attr('value', data.resultMap.redisKey);
                            $('#nonMbCert-error-text').text('');
                            $("#nonMbCertNoSend").attr("disabled", true);
                            $("#nonMbCertNoSend").addClass("disabled");
                            $("#nonMbCertRow").hide();
                            gfn_alertMsgBoxSize('휴대폰 인증을 완료했습니다.\n확인 버튼을 눌러주세요.', 400, 250);	//휴대폰 인증을 완료했습니다.
                            if (typeof fn_validateJoinInfoRegInputVal != "undefined") {
                                fn_validateJoinInfoRegInputVal()	//회원가입에서 검증함수 호출
                            }
                        }
                        else {
                            sValidateMblpCertNoSuccess = "N";
                            if (msg == "ME019") {
                                $('#nonMbCert-error-text').text('인증번호가 일치하지 않습니다.\n인증번호를 다시 입력해주세요.');	//msg.ch.ohg.ME019 인증번호를 다시 확인 후 입력해 주세요.
                            }
                            else if (msg == "ME040") {
                                $('#nonMbCert-error-text').text('인증시간이 만료되었습니다. 인증번호를 재전송 후 입력바랍니다.');	//msg.ch.ohg.ME040	유효시간이 지났습니다.  인증번호 재전송을 통해서 다시 인증해주세요.
                            }
                            else if (msg == "ME061") {
                                $('#nonMbCert-error-text').text('인증시간이 만료되었습니다. 인증번호를 재전송 후 입력바랍니다.');	//msg.ch.ohg.ME061	유효시간이 지났습니다.  인증번호 재전송을 통해서 다시 인증해주세요.
                                gfn_alertMsgBoxSize('인증시간이 만료되었습니다. 인증번호를 재전송 후 입력바랍니다.', 400, 250);	//입력정보를 확인해주세요.
                            }

                            $("#nonMbCertNoSend").removeClass("disabled");
                            $("#nonMbCertNoSend").attr("disabled", false);
                            $("#nonMbCertRow").show();
                        }
                    },
                    error: function (xhr, status, error) {
                        var err = JSON.parse(xhr.responseText);
                        alert(xhr.status);
                        alert(err.message);
                    }
                });
            });

            // 비회원 정보 확인 팝업 요청
            $("#btnChkNonMbLogin").click(function () {

                if (submitIng) return;

                if (typeof $("#ibxNonMbPwdConfirm").val() != 'undefined') {
                    if ($("#ibxNonMbPwd").val() != $("#ibxNonMbPwdConfirm").val()) {
                        gfn_alertMsgBoxSize('입력정보를 확인해주세요.', 400, 250);	//입력정보를 확인해주세요.
                        return;
                    }
                }

                //생년월일 날짜형태 확인
                // 		if(!fn_validateDateYn($("#ibxNonMbByymmdd").val())) {
                // 			alert("생년월일 입력이 잘못 되었습니다.");
                // 			$("#ibxNonMbByymmdd").focus();
                // 			return;
                // 		}
                $("#btnNonMbLogin").attr("disabled", false);
                fn_chkNonMbLogin();
            });

            // 비회원 로그인
            $("#btnNonMbLogin").click(function () {

                var paramData = {
                    nonMbNm: $("#ibxNonMbNm").val()
                    , nonMbByymmdd: $("#ibxNonMbByymmdd").val()
                    , nonMbTelno: $("#ibxNonMbTelno").val()
                    , nonMbPwd: $("#ibxNonMbPwd").val()
                    , bokdCnfmAt: bokdCnfmAt
                };

                $.ajaxMegaBox({
                    url: "/on/oh/ohg/NonMbLogin/selectNonMbLoginInfo.rest",
                    type: "POST",
                    contentType: "application/json;charset=UTF-8",
                    dataType: "json",
                    data: JSON.stringify(paramData),
                    success: function (data, textStatus, jqXHR) {

                        var menuId = data.menuId;
                        var mappingId = data.mappingId;
                        var statCd = data.result.statCd;


                        if (typeof loginPopupCallScn === "undefined") {
                            loginPopupCallScn = "";
                        }
                        //화면이동
                        if (menuId != "" && menuId != null) {    //화면으로 띄웠을떄
                            fn_mvPage(mappingId);
                            return;
                        }
                        else {
                            if (loginPopupCallScn != "" && loginPopupCallScn != null) {  //팝업으로 띄었을때 파라메타는 팝업 호출화면에 전역으로 정의
                                $(".btn-layer-close").trigger("click");
                                if (loginPopupCallScn == "SimpleBokdM") {
                                    $('.before').hide();
                                    $('.after').show();
                                    alert("콜백함수호출");
                                } else if (loginPopupCallScn == "StoreDtlV") {
                                    $('.before').hide();
                                    $('.after').show();
                                } else if (loginPopupCallScn == "MySbscDtlsL") {
                                    $('.before').hide();
                                    $('.after').show();
                                    location.href = '/on/oh/ohh/MySbscDtls/mySbscDtlsListPage.do?currPage=1&searchText=';
                                }
                            }
                            else {
                                var bokdLoginAt = $('#loginForm input[name=bokdLoginAt]').val();
                                if (bokdLoginAt == "Y") {
                                    //예매로그인일경우
                                    //오입력값을 체크한다.
                                    $('.before').hide();
                                    $('.after').show();
                                    $('#btnNonMbModalClose').trigger("click");
                                    $('#layer_login_select button.btn-modal-close').trigger("click");
                                    fn_validDataRevisn(JSON.parse($('#loginForm input[name=bokdLoginParam]').val()));
                                    return;
                                }

                                if (bokdCnfmAt == "Y") {
                                    $('#nonMbBokdCnfmForm input[name=nonMbNm]').attr('value', $('#ibxNonMbNm').val());
                                    $('#nonMbBokdCnfmForm input[name=nonMbTelno]').attr('value', $('#ibxNonMbTelno').val());
                                    $('#nonMbBokdCnfmForm input[name=nonMbPwd]').attr('value', $('#ibxNonMbPwd').val());
                                    $('#nonMbBokdCnfmForm input[name=nonMbByymmdd]').attr('value', $('#ibxNonMbByymmdd').val());

                                    /////////////////////////////////////////////////////////////////////
                                    // 예매정보가 없을 시 메세지 팝업처리 /////////////////////////////////
                                    /////////////////////////////////////////////////////////////////////
                                    if (statCd == 0) {
                                        fn_mvNonMbBokdCnfm("/non-member"); //비회원 예매 확인일때
                                    } else {
                                        alert("입력하신 정보와 일치하는 예매내역이 없습니다.");
                                    }
                                    /////////////////////////////////////////////////////////////////////
                                    /////////////////////////////////////////////////////////////////////

                                    //fn_mvNonMbBokdCnfm("/non-member"); //비회원 예매 확인일때
                                }
                                else {
                                    location.reload();
                                }

                            }
                        }
                        return;
                    },
                    error: function (xhr, status, error) {
                        var err = JSON.parse(xhr.responseText);
                        alert(xhr.status);
                        alert(err.message);
                    },
                    beforeSend: function () {
                        submitIng = true;
                    },
                    complete: function () {
                        submitIng = false;
                    }
                });

                //페이지 이동 submit
                function fn_mvNonMbBokdCnfm(page) {
                    // 	        console.log("fn_mvNonMbBokdCnfm : "+page);
                    $("#nonMbBokdCnfmForm").attr("method", "post");
                    $("#nonMbBokdCnfmForm").attr("action", page);
                    $("#nonMbBokdCnfmForm").submit();
                }

                //비회원 예매 확인 페이지 이동 submit
                function fn_mvPage(page) {
                    // 	        console.log("MbLoginScriptDV.fn_mvPage : "+page);
                    $("#loginForm").attr("method", "post");
                    $("#loginForm").attr("action", page);
                    $("#loginForm").submit();
                }
            });
        });

        function fn_adTracking(url) {
            $.ajax({
                type: "get"
                , url: url
                , data: ""
                , dataType: "json"
                , success: function (result) {

                }
                , error: function (err) {
                    console.log('fn_adEventCall error : ' + err.status);
                }
            });
        }

        /*호출 화면에 따른 분기처리*/
        function fn_viewLoginPopup(viewId, deviceType, bokdLoginAt, bokdLoginParam, reloadYn) {

            //로그인 폼 호출시 광고영역 노출
            if ($("#Rw6jtk0hQTuOBSzFbvGGlw").html() == "") {

                $("#Rw6jtk0hQTuOBSzFbvGGlw").append('<a href="" target="_blank"><img id="pageBannerRnbImage" src="/static/pc/images/common/bg/bg-noimage-main.png" /></a>');

                var header = { "typ": "JWT", "alg": "HS256" }
                var data = {
                    "device": { "devicetype": 2 },
                    "imp": [{ "native": { "ext": { "slots": 1 } } }],
                    "site": { "name": "megabox" },
                    "id": ""
                };
                var secret = "Rw6jtk0hQTuOBSzFbvGGlw";

                var stringifiedHeader = CryptoJS.enc.Utf8.parse(JSON.stringify(header));
                var encodedHeader = base64url(stringifiedHeader);
                var stringifiedData = CryptoJS.enc.Utf8.parse(JSON.stringify(data));
                var encodedData = base64url(stringifiedData);
                var signature = encodedHeader + "." + encodedData;
                signature = CryptoJS.HmacSHA256(signature, secret);
                signature = base64url(signature);
                var pram = encodedHeader + "." + encodedData + "." + signature;
                var adUrl = "https://cast.imp.joins.com/bid/" + secret + "/" + pram; //상용

                $.ajax({
                    type: "get"
                    , url: adUrl
                    , data: ""
                    , success: function (result) {
                        if (result) {
                            $("#pageBannerRnbImage").attr("src", result.image_file);
                            $("#pageBannerRnbImage").attr("alt", result.alternative_text);
                            $("#pageBannerRnbImage").attr("clickThrough", result.click_tracking);
                            $("#pageBannerRnbImage").parent().attr("href", result.click_through);



                            $("#pageBannerRnbImage").css("height", result.height);
                            $("#Rw6jtk0hQTuOBSzFbvGGlw").css("background-color", result.bgcolor);
                            fn_adTracking(result.impression_tracking);
                        }
                    }
                    , error: function (err) {
                        console.log('fn_getBannerAd error : ' + err.status);
                    }
                });

                //광고링크
                $("#pageBannerRnbImage").on("click", function () {
                    var clickThrough = $(this).attr("clickThrough");
                    if (clickThrough != undefined && clickThrough != '') {
                        fn_adTracking(clickThrough);
                    }
                });
            }

            //
            $(".alert").html("");
            if (sCookieVal == "") {	//아이디 저장 체크 안했을경우
                $(".login-input-area #ibxLoginId").val("");			//아이디
            }
            $(".login-input-area #ibxLoginPwd").val("");		//비밀번호
            $(".no-member-login-table #ibxNonMbNm").val("");	//비회원 이름
            $(".no-member-login-table #ibxNonMbByymmdd").val("");	//비회원 생년월일
            $(".no-member-login-table #ibxNonMbTelno").val("");		//비회원 휴대폰 번호
            $(".no-member-login-table #mblpCharCertNo").val("");	//비회원 휴대폰인증번호
            $(".no-member-login-table #ibxNonMbPwd").val("");		//비회원 비밀번호
            $(".no-member-login-table #ibxNonMbPwdConfirm").val("");	//비회원 비밀번호확인
            $("input[name=chkNonMbBokdPersonInfoProc]").prop("checked", false);	//비회원 라디오버튼 해제
            if (typeof AuthTimer != 'undefined') {
                AuthTimer.fnStop();
                $('#timer').html("3:00");
                $('#nonMbCertNoSend').html("인증요청");
                sValidateMblpCertNoSuccess = "N";
                $('#nonMbCertRow').show();
                $('#mblpCharCertNo').val("");
                $("#nonMbCertNoSend").removeClass("disabled");
                $("#nonMbCertNoSend").attr("disabled", false);
            }
            fn_validateNonMbInputVal();

            $('#loginForm input[name=bokdLoginAt]').val("");				//예매 로그인 여부
            $('#loginForm input[name=bokdLoginParam]').val("");				//예매 로그인 파라메타
            $('#loginForm input[name=validDataRevisnYn]').val("");				//데이터 보정 여부
            fn_validateInputVal();

            if ('pc' == deviceType) {

                if ('SimpleBokdM' == viewId) {
                    var sBokdLoginAt = typeof bokdLoginAt == 'undefined' ? "" : bokdLoginAt;//예매 로그인 여부
                    $('#layer_login_select .layer-con .tab-list').show();			//로그인 비회원로그인 선택창
                    $('#layer_login_select .layer-con .tab-cont-wrap .login-member').removeClass('pt00');	//레이어 사이즈 줄임
                    $("#loginPupupATag").attr("h-data", '556');	//높이값 변경
                    $("#loginPupupATag").trigger("click");	//레이어띄움
                    $('#loginForm input[name=bokdLoginAt]').attr('value', sBokdLoginAt);			//예매 로그인 여부 값 설정
                    $('#loginForm input[name=bokdLoginParam]').attr('value', bokdLoginParam);	//예매 로그인 파라메타
                    if (bokdLoginAt == "Y") {
                        $('#loginForm input[name=nonMbCertRedisKey]').val("");
                        $('#loginForm input[name=nonMbCertedMblpNo]').val("");
                    }

                }
                else if ('StoreDtlV' == viewId || 'MySbscDtlsL' == viewId) {
                    $("#loginPupupATag").trigger("click");	//레이어띄움
                    $("#mbPopLayer").show();		//회원 레이어
                    $("#nonMbLogoLayer").hide();	//비회원 로고
                    $("#nonMbPopLayer").hide();		//비회원 레이어
                    $("#mbMbChoiLayer").hide();	//회원 비회원 선택

                    $("#nonMbBokdCnfm").attr("style", "display:none");
                }
                else if ('BoutiqPrivateL' == viewId) {	//부티크
                    $('#layer_login_select .layer-con .tab-list li:eq(0) a').trigger("click");	//회원로그인만 클릭되도록
                    $('#layer_login_select .layer-con .tab-list').hide();						//로그인 비회원로그인 선택창
                    $('#layer_login_select .layer-con .tab-cont-wrap .login-member').addClass('pt00');	//레이어 사이즈 줄임
                    $("#loginPupupATag").attr("h-data", '484');	//높이값 변경
                    $("#loginPupupATag").trigger("click");	//레이어띄움

                    $('#loginForm input[name=reloadYn]').attr('value', reloadYn); // 화면 리로드 설정
                    $('#loginForm input[name=validDataRevisnYn]').val("Y");				//데이터 보정 여부
                }
                else {
                    var sReloadYn = typeof reloadYn == 'undefined' ? "" : reloadYn;// 화면 리로드 여부
                    $('#layer_login_select .layer-con .tab-list li:eq(0) a').trigger("click");	//회원로그인만 클릭되도록
                    $('#layer_login_select .layer-con .tab-list').hide();						//로그인 비회원로그인 선택창
                    $('#layer_login_select .layer-con .tab-cont-wrap .login-member').addClass('pt00');	//레이어 사이즈 줄임
                    $("#loginPupupATag").attr("h-data", '484');	//높이값 변경
                    $("#loginPupupATag").trigger("click");	//레이어띄움

                    $('#loginForm input[name=reloadYn]').attr('value', sReloadYn); // 화면 리로드 설정
                }
            }
        }

        //입력 문자 체크
        function fn_validateNonMbInputVal() {
            //이름
            if ($("#ibxNonMbNm").val() != "") {
                sValidateNonMbNmAt = 'Y';
            }
            else {
                sValidateNonMbNmAt = 'N';
            }

            //생년월일
            if ($("#ibxNonMbByymmdd").val() != "") {
                if (fn_validateDateYn($("#ibxNonMbByymmdd").val(), 6)) {
                    sValidateNonMbByymmddAt = 'Y';
                    //비회원예매확인
                    if (bokdCnfmAt == "Y") {
                        $('#ErrTextNonMbByymmdd').text('');
                    }
                    //비회원로그인
                    else {
                        $('#mblpInput-error-text').text('');
                    }
                }
                else {
                    sValidateNonMbByymmddAt = 'N';
                    //비회원예매확인
                    if (bokdCnfmAt == "Y") {
                        $('#ErrTextNonMbByymmdd').text('생년월일을 정확히 입력해주세요.');
                    }
                    //비회원로그인
                    else {
                        $('#mblpInput-error-text').text('생년월일을 정확히 입력해주세요.');
                    }
                    return false;
                }
            }
            else {
                sValidateNonMbByymmddAt = 'N';
                $('#mblpInput-error-text').text('');
            }

            //휴대폰 번호
            if ($("#ibxNonMbTelno").val() != "") {
                var frontNm = $("#ibxNonMbTelno").val().substr(0, 2);
                if (frontNm != '01') {
                    $('#mblpInput-error-text').text('휴대폰번호를 정확히 입력해주세요.');
                    ibxNonMbTelno = 'N';
                    return false;
                }
                else if ($("#ibxNonMbTelno").val().length < 10) {
                    $('#mblpInput-error-text').text('휴대폰번호를 정확히 입력해주세요.');
                    sValidateNonMbTelnoAt = 'N';
                    return false;
                }
                else {
                    sValidateNonMbTelnoAt = 'Y';
                    $('#mblpInput-error-text').text('');
                }
            }
            else {
                sValidateNonMbTelnoAt = 'N';
            }


            if ($("#ibxNonMbPwd").val().length == 4) {
                sValidateNonMbPwdAt = 'Y';
            }
            else {
                sValidateNonMbPwdAt = 'N';
            }
            if (bokdCnfmAt == "Y") {
                sValidateNonMbPwdConfirmAt = 'Y';
                sValidateNonMbPwdEqualAt = 'Y';
                sValidateNonMbBokdPersonInfoProc = 'Y';
                sValidateMblpCertNoSuccess = 'Y';
            }
            else {
                if ($("#ibxNonMbPwdConfirm").val().length == 4) {
                    sValidateNonMbPwdConfirmAt = 'Y';
                }
                else {
                    sValidateNonMbPwdConfirmAt = 'N';
                }

                if ($("#ibxNonMbPwd").val().length > 0 && $("#ibxNonMbPwdConfirm").val().length > 0 && $("#ibxNonMbPwd").val() == $("#ibxNonMbPwdConfirm").val()) {
                    sValidateNonMbPwdEqualAt = 'Y';
                    $('#nonMbPwdErrText').text('');
                }
                else if ($("#ibxNonMbPwd").val().length > 0 && $("#ibxNonMbPwdConfirm").val().length > 0 && $("#ibxNonMbPwd").val() != $("#ibxNonMbPwdConfirm").val()) {
                    sValidateNonMbPwdEqualAt = 'N';
                    $('#nonMbPwdErrText').text('비밀번호와 비밀번호 확인의 입력값이 일치하지 않습니다.');
                    return false;
                }

                if ($('#chkNonMbBokdPersonInfoProcTrue').prop("checked")) {
                    sValidateNonMbBokdPersonInfoProc = 'Y';
                }
                else {
                    sValidateNonMbBokdPersonInfoProc = 'N';
                }

                if ($('#chkNonMbBokdPersonInfoProcFalse').prop("checked")) {
                    sValidateNonMbBokdPersonInfoProc = 'N';
                }
            }

            // 	$('#error-text1').text
            // 	("sValidateNonMbNmAt:"             +sValidateNonMbNmAt              +("/")+$("#ibxNonMbNm").val().length        +("\n\n")+
            // 			"sValidateNonMbByymmddAt:"         +sValidateNonMbByymmddAt         +("/")+$("#ibxNonMbByymmdd").val().length   +("\n\n")+
            // 			"sValidateNonMbTelnoAt:"           +sValidateNonMbTelnoAt           +("/")+$("#ibxNonMbTelno").val().length     +("\n\n")+
            // 			"sValidateNonMbPwdAt:"             +sValidateNonMbPwdAt             +("/")+$("#ibxNonMbPwd").val().length       +("\n\n")+
            // 			"sValidateNonMbPwdConfirmAt:"      +sValidateNonMbPwdConfirmAt      +("/")+$("#ibxNonMbPwdConfirm").val().length+("\n\n")+
            // 			"sValidateNonMbPwdEqualAt:"        +sValidateNonMbPwdEqualAt        +("/\n\n")+
            // 			"sValidateNonMbBokdPersonInfoProc:"+sValidateNonMbBokdPersonInfoProc+("/\n\n")
            // 		+$("input:checkbox[id='chkNonMbBokdPersonInfoProc']").is(":checked"));

            if (bokdCnfmAt == "N"
                && sValidateNonMbNmAt == 'Y'
                && sValidateNonMbByymmddAt == 'Y'
                && sValidateNonMbTelnoAt == 'Y'
                && sValidateNonMbPwdAt == 'Y'
                && sValidateNonMbPwdConfirmAt == 'Y'
                && sValidateNonMbBokdPersonInfoProc == 'Y'
                && sValidateNonMbPwdEqualAt == 'Y'
                && sValidateMblpCertNoSuccess == 'Y') {
                $("#btnChkNonMbLogin").attr("disabled", false);
                return true;
            }
            else if (bokdCnfmAt == "Y"
                && sValidateNonMbNmAt == 'Y'
                && sValidateNonMbByymmddAt == 'Y'
                && sValidateNonMbTelnoAt == 'Y'
                && sValidateNonMbPwdAt == 'Y') {
                $("#btnNonMbLogin").attr("disabled", false);
                return true;
            }
            else {
                $("#btnChkNonMbLogin").attr("disabled", true);
                $("#btnNonMbLogin").attr("disabled", true);
                return false;
            }
        }

        /*날짜 형태 확인*/
        function fn_validateDateYn(param, length) {
            try {
                var year = 0;
                var month = 0;
                var day = 0;

                param = param.replace(/-/g, '');

                // 자리수가 맞지않을때
                if (isNaN(param) || param.length < Number(length) || param.length > Number(length)) {
                    return false;
                }

                if (param.length == 6) {
                    year = Number(param.substring(0, 2));
                    month = Number(param.substring(2, 4));
                    day = Number(param.substring(4, 6));
                }
                else if (param.length == 8) {
                    year = Number(param.substring(0, 4));
                    month = Number(param.substring(4, 6));
                    day = Number(param.substring(6, 8));

                    var sysYear = Number(new Date().getFullYear());
                    //년도입력이 현재 년도보다 클때.
                    if (sysYear < year) {
                        return false;
                    }
                }
                else {
                    return false;
                }


                var dd = day / 0;


                if (month < 1 || month > 12) {
                    return false;
                }

                var maxDaysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
                var maxDay = maxDaysInMonth[month - 1];

                // 윤년 체크
                if (month == 2 && (year % 4 == 0 && year % 100 != 0 || year % 400 == 0)) {
                    maxDay = 29;
                }

                if (day <= 0 || day > maxDay) {
                    return false;
                }
                return true;

            } catch (err) {
                return false;
            }
        }


        function $ComTimer() {
            //prototype extend
        }

        $ComTimer.prototype = {
            comSecond: ""
            , fnCallback: function () { }
            , timer: ""
            , domId: ""
            , fnTimer: function () {
                var m = Math.floor(this.comSecond / 60) + ":" + String((this.comSecond % 60)).lpad(2, "0");	// 남은 시간 계산
                this.comSecond--;					// 1초씩 감소
                this.domId.innerText = m;
                if (this.comSecond < 0) {			// 시간이 종료 되었으면..
                    clearInterval(this.timer);		// 타이머 해제
                    $('#nonMbCert-error-text').text('인증시간이 만료되었습니다. 인증번호를 재전송 후 입력바랍니다.');	//msg.ch.ohg.ME061	인증시간이 만료되었습니다. 인증번호를 재전송 후 입력바랍니다.
                    $("#btnMblpCharCert").attr("disabled", true);	//인증확인버튼 비활성
                    $("#btnMblpCharCert").addClass("disabled");		//인증확인버튼 비활성
                }
            }
            , fnStop: function () {
                clearInterval(this.timer);
            }
        }

    </script>
    <script type="text/javascript">
        var simpleLoginWithPopup;
        var simpleLoginWith = function (lnkgTy) {
            var url = "/on/oc/ocz/SimpleLogin/simpleLogin.do?lnkgTy=" + lnkgTy;
            if (simpleLoginWithPopup) {
                simpleLoginWithPopup.close();
            }
            if (lnkgTy != "FACEBOOK") {
                simpleLoginWithPopup = window.open(url, 'simpleLoginWithPopup', 'width=420, height=550');
            }
            else {
                simpleLoginWithPopup = window.open(url, 'simpleLoginWithPopup', 'width=650, height=600, scrollbars=yes');
            }
        }

        var fn_LoginPopUpCall = function (paramData) {
            if (lnkgInfoObj.attr("connTy") != undefined) {
                fn_ConnWithCallBack(paramData);
            } else {
                fn_LoginWithCallBack(paramData);
            }

        }
        var fn_LoginPopUpCallError = function (msg) {
            gfn_alertMsgBoxSize(msg, 400, 250);
        }

        //비회원 확인 팝업
        function fn_chkNonMbLogin() {

            var $td = $(document).find('#layer_no_member_chk td');

            var telTmp = $('#ibxNonMbTelno').val();

            switch (telTmp.length) {
                case 10: telTmp = telTmp.format('XXX-XXX-XXXX'); break;
                case 11: telTmp = telTmp.format('XXX-XXXX-XXXX'); break;
            }

            $td.eq(0).html($('#ibxNonMbNm').val());
            $td.eq(1).html($('#ibxNonMbByymmdd').val());
            $td.eq(2).html(telTmp);

            // 레이어 호출
            $(document).find('#aNonMbLogin').click();
        }
    </script>
    <script type="text/javascript">
        var fn_LoginWithCallBack = function (paramData) {
            $.ajaxMegaBox({
                url: "/on/oc/ocz/SimpleLogin/selectSimpleLogin.do",
                type: "POST",
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                data: JSON.stringify(paramData),
                success: function (data, textStatus, jqXHR) {
                    if (data.userMap == null) {
                        //var simpleLoginTyCd = data.userMap.simpleLoginTyCd;
                        gfn_alertMsgBoxSize('[' + paramData.simpleLoginTyCd + '] 계정으로 연동된 메가박스 계정이 없습니다.\n연동을 원하시면 나의메가박스 > 개인정보수정에서\n간편로그인 계정연동을 진행해 주세요.', 400, 250);
                    } else {
                        var loginId = data.userMap.loginId;
                        var mbNo = data.userMap.mbNo;
                        fn_selectMbLogin(loginId, "simpleLogin", "Y", paramData.redisKey);
                    }
                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(xhr.status);
                    alert(err.message);
                }
            });
        }
        var lnkgInfoObj;
        $(function () {
            $("div.sns-login > a").off("click").on("click", function () {
                lnkgInfoObj = $(this);
                simpleLoginWith($(this).attr("lnkgTy"));
            });
        });
    </script>
    <script type="text/javascript">
        $(function () {


            $('#header .right-link .before').show();
            $('#header .right-link .after').hide();
            //session 관련 처리를 위한 부분
            $.ajaxMegaBox({
                url: '/sessionChk.do',
                success: function (data) {
                    var loginYn = data.loginYn;
                    if (loginYn == 'Y') {
                        $('.right-link .before').hide();
                        $('.right-link .after').show();
                    } else {
                        $('.right-link .before').show();
                        $('.right-link .after').hide();
                    }
                }
            });




            // 웹에서만 실행 -> facebook을 로드하지 않는 템플릿에서 반복적인 오류 발생으로 hreader로 이전
            if (!MegaboxUtil.Common.isMobile() && !MegaboxUtil.Common.isApp())
                MegaboxUtil.Share.init();
        });

        //로그인 버튼
        $(document).on('click', '#moveLogin', function () {

            fn_viewLoginPopup('default', 'pc');

        });

        var sysCd = 'ON';

        //넷퍼넬 스킨 타입 지정
        NetfunnelChk.setting(sysCd, MegaboxUtil.Common.isApp());

    </script>
    <script type="text/javascript">
        var localeCode = "kr";			//한영 구분 코드
        var sellChnlCd = '';	//파라메타로 전달된 판매 체널 코드
        var riaParamIsMember = '';	//회원여부
        var riaParamName = '';		//고객명
        var riaParamMobileNo = '';	//고객전화번호
        var riaParamBirthday = '';	//고객생년월일
        var riaParamMemberCard = '';	//카드번호
        var riaParamPassword = '';	//암호
        var riaParamIPinCi = '';		//아이핀 CI값
        var riaParamReciveTime = '';	//ARS시각
        var riaParamMovieCode = '';	//특정영화코드
        var riaMemberYn = '';	//메가박스 회원여부
        var riaLoginAt = '';		//메가박스 로그인여부
        var riaLoginId = '';		//메가박스 로그인여부
        var usrId = '';		//메가박스 로그인여부
        var msgStr = '';
        var bokdMPlayDe = ''; // 상영일자


        $(window).load(function () {
            var frameBokdMBookingBodyObj = $('#frameBokdMBooking').get(0).contentWindow.document.body;	//빠른예매 프레임 바디 오브젝트
            var frameBokdMBookingContentObj = $('#frameBokdMBooking').get(0).contentWindow;
            var frameBokdMSeatBodyObj = $('#frameBokdMSeat').get(0).contentWindow.document.body;	//좌석도 프레임 바디 오브젝트
            var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
            var framePayBookingBodyObj = $('#framePayBooking').get(0).contentWindow.document.body;	//결제화면 프레임 바디 오브젝트
            var framePayBookingContentObj = $('#framePayBooking').get(0).contentWindow;

            var bokdMPlaySchdlNo = '';	//파라메타로 전달된 상영스케줄 번호
            var bokdMRpstMovieNo = '';	//파라메타로 전달된 대표영화번호
            var bokdMTheabKindCode1 = ''; // 특별관 area
            var bokdMBrchNo1 = ''; // 지점코드

            //상영스케줄 번호가 없는경우 빠른예매 화면을 표시한다.
            if ("" == bokdMPlaySchdlNo) {
                //상단네비게이션바 RIA의 경우
                if (sellChnlCd != "") {

                    $('.page-util').hide();	//상단 네비게이션바를 숨김 처리한다.

                    if (riaMemberYn == "Y") {
                        msgStr = riaParamName + "(" + riaLoginId + ") 고객님의 회원 정보가 적용되었습니다."
                    }
                    else if (riaMemberYn == "N") {
                        msgStr = "해당 회원 정보가 없습니다. 비회원으로 예매를 진행합니다.";
                    }
                }
                else {
                    $('.page-util').show();	//상단 네비게이션바를 숨김 처리한다.
                }

                $('#bokdMSeat').hide();	//좌석도 숨김
                $('#bokdMPayBooking').hide();	//결제 숨김

                //$('#frameBokdMBooking').attr('src','/on/oh/ohb/SimpleBooking/simpleBookingPage.do?rpstMovieNo='+bokdMRpstMovieNo);	//영화를 통해 진입한경우 영화 파라메타를 함께 전달
                $('#frameBokdMBooking').attr('src', '/on/oh/ohb/SimpleBooking/simpleBookingPage.do?rpstMovieNo=' + bokdMRpstMovieNo + '&theabKindCode1=' + bokdMTheabKindCode1 + '&brchNo1=' + bokdMBrchNo1 + '&sellChnlCd=' + sellChnlCd + '&playDe=' + bokdMPlayDe); //영화를 통해 진입한경우 영화 파라메타를 함께 전달
                $('#frameBokdMBooking').load(function () {	//빠른예매 화면이 로딩이 완료되면
                    $('#frameBokdMSeat').attr('src', '/on/oh/ohz/PcntSeatChoi/selectPcntSeatChoi.do');	//좌석도 화면로딩
                    $('#framePayBooking').attr('src', '/on/oh/ohz/PayBooking/completeSeat.do');			//결제 화면 로딩
                });
                NetfunnelChk.script("BOOK_STEP1", function () {	//넷퍼넬 적용
                    $('#bokdMBooking').show();	//빠른예매 화면 표시
                });
            }
            else {
                NetfunnelChk.script("BOOK_STEP2", function () {	//넷퍼넬 적용
                    // 		$('#bokdMBooking').hide();	//빠른예매 숨김
                    // 		$('#bokdMPayBooking').hide();	//결제 숨김
                    $('#frameBokdMSeat').attr('src', '/on/oh/ohz/PcntSeatChoi/selectPcntSeatChoi.do');
                    $('#frameBokdMSeat').load(function () {
                        frameBokdMSeatBodyObj = $('#frameBokdMSeat').get(0).contentWindow.document.body;	//좌석도 프레임 바디 오브젝트
                        frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
                        $('#framePayBooking').attr('src', '/on/oh/ohz/PayBooking/completeSeat.do');
                        $(frameBokdMSeatBodyObj).find('#playSchdlNo').val(bokdMPlaySchdlNo);
                        frameBokdMSeatContentObj.fn_search();
                    });
                    $('#bokdMSeat').show();
                });
            }

            //RIA용 화면 패딩 제거
            if ("" != sellChnlCd) {
                $('.container').addClass("mg00");
                $('.container').addClass("pd00");
            }
        });

        //좌석도로 파라메타 전달
        function fn_setSmapParam(obj) {
            NetfunnelChk.script("BOOK_STEP2", function () {	//넷퍼넬 적용
                var frameBokdMSeatBodyObj = $('#frameBokdMSeat').get(0).contentWindow.document.body;	//좌석도 프레임 바디 오브젝트
                var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;

                $('#bokdMSeat').show();	//좌석도 표시
                $(frameBokdMSeatBodyObj).find('#playSchdlNo').val(obj.attr("play-schdl-no"));
                frameBokdMSeatContentObj.fn_search();

                // 	$('#frameBokdMSeat').attr('src','/on/oh/ohz/PcntSeatChoi/selectPcntSeatChoi.do?playSchdlNo='+obj.attr("play-schdl-no"));
                // 	$('#frameBokdMSeat').attr('src','/main');

                $('#bokdMBooking').hide();	//빠른예매 숨김
                $('#bokdMPayBooking').hide();	//결제 숨김
            });
        }

        //좌석도에서 이전 버튼 클릭
        function fn_goPrePagePcntSeatChoi(msg) {
            var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
            $('#bokdMPayBooking').hide();	//결제 숨김
            $('#bokdMSeat').hide();	//좌석도 숨김
            $('#bokdMBooking').show();	//빠른예매 표시

            if (msg != null && msg != "") {
                gfn_alertMsgBox("결제가능 시간이 초과되어<br/> 좌석선택부터 다시 진행바랍니다.");
            }

            //결제에서 예매이동 처리 추가
            $('#frameBokdMSeat').attr("src", "/on/oh/ohz/PcntSeatChoi/selectPcntSeatChoi.do"); //좌석도 화면초기화
            $('#framePayBooking').attr("src", "/on/oh/ohz/PayBooking/completeSeat.do"); //결제화면 초기화
        }

        //상영시간표에서 다음 버튼 클릭
        function fn_goNextPagePcntSeatChoi(param) {
            //선점좌석 체크
            fn_validOccupSeat(param);
            //로그인 여부 체크
            //데이터 보정 체크
            //fn_validLoginAt();
            //오입력 체크
            //블랙리스트 체크
            //결제로이동
        }


        //결제화면으로로 파라메타 전달 및 화면 이동
        function fn_setBookingParamMove(options) {
            NetfunnelChk.script("BOOK_STEP3", function () {	//넷퍼넬 적용
                var framePayBookingBodyObj = $('#framePayBooking').get(0).contentWindow.document.body;	//결제화면 프레임 바디 오브젝트
                var framePayBookingContentObj = $('#framePayBooking').get(0).contentWindow;

                //좌석도에서 세팅한 param 값
                var playSchdlNo = options.playSchdlNo;	//상영스케쥴
                var seatOccupText = options.seatOccupText;	//좌석/티켓 상세정보
                var totalAmt = options.totalAmt;		//총금액

                $(framePayBookingBodyObj).find('#playSchdlNo').val(playSchdlNo);
                $(framePayBookingBodyObj).find('#seatOccupText').val(seatOccupText);
                $(framePayBookingBodyObj).find('#totalAmt').val(totalAmt);

                framePayBookingContentObj.completeSeat();
                $('#bokdMPayBooking').show();
                //프레임 높이 자동 조정
                calcFrameHeight($('#bokdMPayBooking'), $('#framePayBooking'));

                $('#bokdMSeat').hide();  //좌석도 숨김
            });
        }

        //결제화면에서 이전 버튼 클릭
        function fn_goPrePagePayBooking() {
            var framePayBookingContentObj = $('#framePayBooking').get(0).contentWindow;
            var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
            $('#bokdMPayBooking').hide();
            $('#framePayBooking').attr("src", "/on/oh/ohz/PayBooking/completeSeat.do"); //결제화면 초기화
            $('#bokdMSeat').show();	//좌석도 표시
            $("html,body").scrollTop(0);

            frameBokdMSeatContentObj.fn_display_init();
        }

        function fn_seatDispInit() {
            var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
            frameBokdMSeatContentObj.fn_display_init();
            frameBokdMSeatContentObj.fn_search('N');
        }

        //결제화면에서 이전 버튼 클릭 및 블랙리스트 팝업
        function fn_altBlackgoPrePagePayBooking(blackListParam) {
            var framePayBookingContentObj = $('#framePayBooking').get(0).contentWindow;
            var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
            $('#bokdMPayBooking').hide();
            $('#framePayBooking').attr("src", "/on/oh/ohz/PayBooking/completeSeat.do"); //결제화면 초기화
            $('#bokdMSeat').show();	//좌석도 표시
            $("html,body").scrollTop(0);

            frameBokdMSeatContentObj.fn_display_init();

            frameBokdMSeatContentObj.shwoBlackListPopup(blackListParam);
        }

        //결제화면에서 오류 발생시 좌석도로 이동(기선점 존재, 시간 초과 등)
        function fn_goPrePageInitSeat(msg) {
            var framePayBookingContentObj = $('#framePayBooking').get(0).contentWindow;
            $('#bokdMPayBooking').hide();
            $('#framePayBooking').attr("src", "/on/oh/ohz/PayBooking/completeSeat.do"); //결제화면 초기화

            //좌석도 초기화
            var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
            frameBokdMSeatContentObj.fn_search('N');  //새로 조회 및 최초진입 팝업 띄우지 않음
            $('#bokdMSeat').show();	//좌석도 표시
            $("html,body").scrollTop(0);

            if (msg != null && msg != "") {
                gfn_alertMsgBox("결제가능 시간이 초과되어<br/> 좌석선택부터 다시 진행바랍니다.");
            }

            frameBokdMSeatContentObj.fn_display_init();
            frameBokdMSeatContentObj.fn_search('N');
        }

        //프레임 height 자동조정 : 결제만 적용가능
        function calcFrameHeight(divObj, frameObj) { //div obj, frame obj
            var frameBodyObj = $(frameObj).get(0).contentWindow.document.body;	//프레임 바디 오브젝트
            var height = $(frameObj).contents().find('.inner-wrap').outerHeight();
            $(divObj).height(height + 35);
            $(frameObj).height(height + 25);
        }

        //선점좌석 체크
        function fn_validOccupSeat(param) {
            $.ajaxMegaBox({
                url: "/on/oh/ohb/BokdMain/selectOccupSeat.do",
                data: JSON.stringify(param),
                success: function (result) {
                    var occupSeatAt = result.resultMap.occupSeatAt;	//좌석선점여부

                    //비 좌석선점 상태 로그인 체크 하러 감.
                    if (occupSeatAt == "N") {
                        fn_validLoginAt(param);	//로그인 체크
                    }
                    //좌석 선점 상태
                    else {
                        gfn_alertMsgBoxSize('선택하신 좌석은 이미 판매가 진행중입니다．\n다른 좌석을 선택해주세요.', 400, 250);	//선택하신　좌석은　이미　판매가　진행중입니다．\\n다른　좌석을　선택해주세요.
                        return;
                    }
                }
            });

        }


        //로그인여부 체크
        function fn_validLoginAt(param) {
            $.ajaxMegaBox({
                url: "/on/oh/ohg/MbLogin/selectLoginSession.do",
                //data   : JSON.stringify(paramData),
                success: function (result) {
                    var loginAt = result.resultMap.result;	//로그인 여부

                    //비로그인 상태
                    if (loginAt == "N" && sellChnlCd == "") {
                        //로그인 팝업 표시
                        fn_viewLoginPopup('SimpleBokdM', 'pc', 'Y', JSON.stringify(param));
                    }
                    //비로그인상태 RIA
                    else if (loginAt == "N" && sellChnlCd != "") {
                        gfn_alertMsgBoxSize('로그인이 필요한 서비스 입니다.', 400, 250);	//로그인이 필요한 서비스 입니다.
                        fn_riaLoginInputToggle(false);
                    }
                    //로그인 상태
                    else {
                        //데이터 보정 체크
                        fn_validDataRevisn(param);
                    }
                }
            });
        }


        //로그인여부 체크
        function fn_testLoginAt() {
            $.ajaxMegaBox({
                url: "/on/oh/ohg/MbLogin/selectLoginSession.do",
                //data   : JSON.stringify(paramData),
                success: function (result) {
                    var loginAt = result.resultMap.result;	//로그인 여부
                    alert(loginAt);
                }
            });
        }


        //RIA 로그인 토글
        function fn_setRiaLoginToggle(riaLoginAtArrayParam) {	//0 : 로그인여부, 1:riaName, 2:riaBirthday, 3:riaMobileNo
            var ajaxUrl = "";
            var paramData = "";
            var riaLoginAt = riaLoginAtArrayParam[0];
            var riaName = "";
            var riaBirthday = "";
            var riaMobileNo = "";

            if ("Y" == riaLoginAt) {
                //로그아웃
                ajaxUrl = "/on/oh/ohg/MbLogin/riaLogOut.do";
            }
            else {
                //로그인
                ajaxUrl = "/on/oh/ohg/MbLogin/selectRiaLoginInfo.rest";

                //파라메타 생성
                riaName = riaLoginAtArrayParam[1];
                riaBirthday = riaLoginAtArrayParam[2];
                riaMobileNo = riaLoginAtArrayParam[3];

                paramData = { name: riaName, birthday: riaBirthday, mobileNo: riaMobileNo, sellChnlCd: sellChnlCd };
            }
            //로그인 또는 로그아웃
            $.ajaxMegaBox({
                url: ajaxUrl,
                data: JSON.stringify(paramData),
                success: function (result) {
                    //전역변수 토글
                    //로그인 여부 변경
                    if (typeof result.resultMap != 'undefined' && result.resultMap.memberYn != null && result.resultMap.memberYn != "") {
                        riaLoginAtArrayParam[0] = "Y";							//로그인여부
                        riaLoginAtArrayParam[1] = result.resultMap.name;		//이름
                        riaLoginAtArrayParam.push(result.resultMap.memberYn);	//회원여부
                        riaLoginAtArrayParam.push(result.resultMap.riaLoginId);	//로그인ID
                    }
                    else {
                        riaLoginAtArrayParam[0] = "N";	//로그인여부
                        riaLoginAtArrayParam.push("N");	//회원여부
                        if ("N" == riaLoginAt)
                            gfn_alertMsgBoxSize('이름은  필수 입력 항목 입니다.', 400, 250);	//{0} 필수 입력 항목 입니다.
                    }

                    fn_riaLoginGVToggle(riaLoginAtArrayParam);

                    //RIA 로그인 입력창 토글
                    fn_riaLoginInputToggle("N" == riaLoginAtArrayParam[0] ? false : true);
                }
            });
        }

        //RIA 전역변수 토글
        function fn_riaLoginGVToggle(arrayParam) {
            //로그인 상태에서 로그아웃 상태로 갈때
            if ("N" == arrayParam[0]) {
                riaLoginAt = 'N'; //메가박스 로그인여부
                riaParamName = arrayParam[1];  //고객명
                riaParamBirthday = arrayParam[2];  //고객생년월일
                riaParamMobileNo = arrayParam[3];  //고객전화번호
                riaMemberYn = typeof arrayParam == undefined || arrayParam == "" || arrayParam == null ? "N" : arrayParam[5]; //메가박스 회원여부
                riaLoginId = '';  //로그인ID

            }
            else {
                riaLoginAt = arrayParam[0];  //메가박스 로그인여부
                riaParamName = arrayParam[1];  //고객명
                riaParamBirthday = arrayParam[2];  //고객생년월일
                riaParamMobileNo = arrayParam[3];  //고객전화번호
                riaMemberYn = arrayParam[4];  //메가박스 회원여부
                riaLoginId = arrayParam[5];  //로그인ID
            }
        }

        //RIA 로그인 입력창 토글
        function fn_riaLoginInputToggle(inputAbleAt) {
            var frameBokdMBookingBodyObj = $('#frameBokdMBooking').get(0).contentWindow.document.body;	//빠른예매 프레임 바디 오브젝트
            var frameBokdMBookingContentObj = $('#frameBokdMBooking').get(0).contentWindow;
            var frameBokdMSeatBodyObj = $('#frameBokdMSeat').get(0).contentWindow.document.body;	//좌석도 프레임 바디 오브젝트
            var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
            var framePayBookingBodyObj = $('#framePayBooking').get(0).contentWindow.document.body;	//결제화면 프레임 바디 오브젝트
            var framePayBookingContentObj = $('#framePayBooking').get(0).contentWindow;
            var riaMemberInputText = "";
            var riaMemberButtonText = "";

            //로그인 버튼 텍스트 생성
            //로그인 되어 있는경우
            if ("Y" == riaLoginAt) {
                //
                if ("Y" == riaMemberYn) {
                    riaMemberInputText = "회원";
                    riaMemberButtonText = "재인증";
                    msgStr = riaParamName + "(" + riaLoginId + ") 고객님의 회원 정보가 적용되었습니다.";
                }
                else {
                    riaMemberInputText = "비회원";
                    riaMemberButtonText = "재인증";
                    msgStr = "해당 회원 정보가 없습니다. 비회원으로 예매를 진행합니다.";
                }
            }
            //로그인 되어 있지 않은경우
            else {
                msgStr = "";
                riaMemberButtonText = "인증요청";
            }


            $(frameBokdMBookingBodyObj).find('.cti-area input[name=riaName]').val(riaParamName);	//고객명
            $(frameBokdMBookingBodyObj).find('.cti-area input[name=riaMobileNo]').val(riaParamMobileNo);	//고객전화번호
            $(frameBokdMBookingBodyObj).find('.cti-area input[name=riaBirthday]').val(riaParamBirthday);	//고객생년월일
            $(frameBokdMBookingBodyObj).find('.cti-area input[name=riaMemberYn]').val(riaMemberInputText);	//회원여부

            $(frameBokdMBookingBodyObj).find('.cti-area input[name=riaName]').attr("readonly", inputAbleAt);		//고객명
            $(frameBokdMBookingBodyObj).find('.cti-area input[name=riaMobileNo]').attr("readonly", inputAbleAt);	//고객전화번호
            $(frameBokdMBookingBodyObj).find('.cti-area input[name=riaBirthday]').attr("readonly", inputAbleAt);	//고객생년월일
            $(frameBokdMBookingBodyObj).find('.cti-area button').attr('login-at', riaLoginAt);	//회원여부
            $(frameBokdMBookingBodyObj).find('.cti-area button').html(riaMemberButtonText);

            //좌석도
            $(frameBokdMSeatBodyObj).find('.cti-area input[name=riaName]').val(riaParamName);	//고객명
            $(frameBokdMSeatBodyObj).find('.cti-area input[name=riaMobileNo]').val(riaParamMobileNo);	//고객전화번호
            $(frameBokdMSeatBodyObj).find('.cti-area input[name=riaBirthday]').val(riaParamBirthday);	//고객생년월일
            $(frameBokdMSeatBodyObj).find('.cti-area input[name=riaMemberYn]').val(riaMemberInputText);	//회원여부

            $(frameBokdMSeatBodyObj).find('.cti-area input[name=riaName]').attr("readonly", inputAbleAt);		//고객명
            $(frameBokdMSeatBodyObj).find('.cti-area input[name=riaMobileNo]').attr("readonly", inputAbleAt);	//고객전화번호
            $(frameBokdMSeatBodyObj).find('.cti-area input[name=riaBirthday]').attr("readonly", inputAbleAt);	//고객생년월일
            $(frameBokdMSeatBodyObj).find('.cti-area button').attr('login-at', riaLoginAt);	//회원여부
            $(frameBokdMSeatBodyObj).find('.cti-area button').html(riaMemberButtonText);

            //결제
            $(framePayBookingBodyObj).find('.cti-area input[name=riaName]').val(riaParamName);	//고객명
            $(framePayBookingBodyObj).find('.cti-area input[name=riaMobileNo]').val(riaParamMobileNo);	//고객전화번호
            $(framePayBookingBodyObj).find('.cti-area input[name=riaBirthday]').val(riaParamBirthday);	//고객생년월일
            $(framePayBookingBodyObj).find('.cti-area input[name=riaMemberYn]').val(riaMemberInputText);	//회원여부

            $(framePayBookingBodyObj).find('.cti-area input[name=riaName]').attr("readonly", inputAbleAt);		//고객명
            $(framePayBookingBodyObj).find('.cti-area input[name=riaMobileNo]').attr("readonly", inputAbleAt);	//고객전화번호
            $(framePayBookingBodyObj).find('.cti-area input[name=riaBirthday]').attr("readonly", inputAbleAt);	//고객생년월일
            $(framePayBookingBodyObj).find('.cti-area button').attr('login-at', riaLoginAt);	//회원여부

            fn_getMsgStrToAlert();

        }


        function fn_getMsgStrToAlert() {
            if (sellChnlCd == "TELLER" && msgStr != "") {
                gfn_alertMsgBox(msgStr);
            }
        }


        //데이터 보정 체크 데이터 보정 체크 안함 김민영과장 2019-12-02
        function fn_validDataRevisn(param) {
            fn_vlaidBlackList(param);

            // 	$.ajaxMegaBox({
            //         url    : "/on/oh/ohg/MbLogin/selectDataRevisn.do",
            //         //data   : JSON.stringify(paramData),
            //         success: function(result){
            //         	var dataRevisnAt = result.resultMap.result;	//로그인 여부

            //         	//자료보정대상
            // 			if(dataRevisnAt  == "Y" && sellChnlCd == ""){
            // 				//자료 보정 안내 메세지 표시
            // 				var arguments=result.resultMap.birthDe+' / '+result.resultMap.mblpTelno;
            // 				var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;	//좌석도 프레임 컨텐츠 오브젝트
            // 				frameBokdMSeatContentObj.shwoDataRevisnPopup(arguments,param);
            //  			}
            //  			//자료보정대상아님
            //  			else {
            //  				//블랙리스트 체크
            // 				fn_vlaidBlackList(param);
            //  			}
            //         }
            //     });
        }

        //블랙리스트 체크
        function fn_vlaidBlackList(param) {
            var paramData = {
                BokdCnt: param.bokdCnt
                , BokdBrch: param.brchNo
            };
            // 	//좌석수 param
            $.ajaxMegaBox({
                url: "/on/oh/ohg/MbLogin/selectBlackList.do",
                data: JSON.stringify(paramData),
                success: function (result) {
                    var dataBlackListAt = result.resultMap.result;
                    //블랙리스트 대상
                    //dataBlackListAt = "N";	//주희연 통테 테스트용 블랙리스트 체크 제외 로직 삽입. 20191118
                    if (dataBlackListAt == "Y") {
                        //블랙리스트 안내 메세지 표시
                        var frameBokdMSeatContentObj = $('#frameBokdMSeat').get(0).contentWindow;
                        var blackListParam = {
                            bokdAbleBrch: result.resultMap.bokdAbleBrch
                            , bokdAbleCnt: result.resultMap.bokdAbleCnt
                            , bokdAbleQty: result.resultMap.bokdAbleQty
                        }
                        frameBokdMSeatContentObj.shwoBlackListPopup(blackListParam);
                    }
                    //블랙리스트 비 대상
                    else {
                        //결제로 이동
                        fn_setBookingParamMove(param);
                    }
                }
            });
        }

        //페이지 이동
        function fn_mvPage(page) {
            $("#bokdMForm").attr("method", "post");
            $("#bokdMForm").attr("action", page);
            $("#bokdMForm").submit();
        }


        //언어변환
        function setLangChg() {
            if (localeCode == "en") {
                location.href = "/booking?megaboxLanguage=kr";
            }
            else {
                location.href = "/booking?megaboxLanguage=en";
            }
        }

        //페이지 리로드
        function fn_bokdReload(page) {
            $("#bokdMForm").attr("method", "post");
            $("#bokdMForm").attr("action", page);
            $("#bokdMForm").submit();
        }


        $(window).on("beforeunload", function () {

            //결제 페이지 이동시
            if ($("#framePayBooking").contents().find("#completeYn").val() != 'Y' &&
                $("#framePayBooking").contents().find("#prepareYn").val() == 'Y') {

                $.ajaxMegaBox({
                    url: '/on/oh/ohg/MbLogin/nonMbLogout.do',
                    success: function (result) {

                        //console.log("result : "+result);
                    },
                    complete: function () {

                        //console.log("?");
                    }
                });
            }

        });


    </script>
    <script src="js/jquery-3.5.1.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/jquery-ui.1.12.1.js"></script>
    <script src="js/gsap.min.js"></script>
    <script src="js/jquery.mCustomScrollbar.concat.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/bootstrap-custom.js"></script>
    <script src="js/bootstrap-select.js"></script>
    <script type="text/javascript" src="js/netfunnel.js" charset="UTF-8"></script>
    <script type="text/javascript" src="js/netfunnel_skin.js" charset="UTF-8"></script>
    <script type="text/javascript" src="js/netfunnel_frm.js" charset="UTF-8"></script>
    <script src="js/megaboxCom.js"></script>
    <script src="js/mega.prototype.js"></script>
    <script src="js/lozad.min.js"></script>
    <script src="js/commons.js"></script>
    <script src="js/swiper-bundle.min.js"></script>
    <script src="js/masonry.pkgd.min.js"></script>
    <script type="text/javascript">
        var _init = {
            cache: Date.now(),
            path: '/static/pc/js/'
        };
        document.write(
            '<script src="' + _init.path + 'ui.common.js?v=' + _init.cache + '"><\/script>' +
            '<script src="' + _init.path + 'front.js?v=' + _init.cache + '"><\/script>'
        );

        //링크 구분에 따라 url 이동을 한다.
        function fn_goMoveLink(link_gbn, link_url) {
            alert("준비중 입니다");
            return;
        }
    </script>
    <script src="js/ui.common.js"></script>
    <script src="js/front.js"></script>
    <script type="text/javascript">
        var debug = "N";
        var fn_debugger = function () { if (debug == "") { debugger; } }
        var localeCode = 'kr';


        var seat = {};
        seat.classCodeT = {

            "GERN_CLS": ["common", "일반석", "(영)일반석", "clsGernAmt", 1, 1, 'A0', "Y", 'N', 'N', [1, 2, 3, 4, 5, 6, 7, 8], "N,N,N,N"],
            "DISABLED_CLS": ["disabled", "장애인/휠체어석", "(영)장애인/휠체어석", "clsDisabledAmt", 2, 1, 'A0', "N", 'Y', 'Y', [1, 2, 3, 4, 5, 6, 7, 8], "N,N,N,N"],
            "KIDS_CLS": ["kids", "키즈석", "(영)키즈석", "clsKidsAmt", 3, 1, 'A0', "N", 'N', 'Y', [1, 2, 3, 4, 5, 6, 7, 8], "A,Y,N,S"],
            "TABLE_CLS": ["table", "테이블석", "(영)테이블석", "clsTableAmt", 4, 1, 'D1', "N", 'N', 'Y', [1, 2, 3, 4, 5, 6, 7, 8], "N,N,N,N"],
            "2P_CLS": ["sofa2", "2인소파석", "(영)2인소파석", "cls2pAmt", 5, 2, 'E1', "N", 'Y', 'Y', [1, 2], "N,Y,C,S"],
            "4P_CLS": ["sofa4", "4인소파석", "(영)4인소파석", "cls4pAmt", 6, 4, 'F1', "N", 'Y', 'Y', [1, 2, 3, 4], "N,Y,C,S"],
            "BALCONY_CLS": ["balcony", "발코니석", "(영)발코니석", "clsBalconyAmt", 7, 4, 'G1', "N", 'Y', 'Y', [1, 2, 3, 4], "N,Y,C,S"],
            "BALCONY2_CLS": ["balcony-d", "발코디럭스석", "(영)발코디럭스석", "clsBalcony2Amt", 8, 4, 'H1', "N", 'Y', 'Y', [1, 2, 3, 4], "N,Y,C,S"],
            "ROYAL_CLS": ["royal", "로얄석", "(영)로얄석", "clsRoyalAmt", 9, 1, 'I1', "N", 'N', 'Y', [1, 2, 3, 4, 5, 6, 7, 8], "N,N,N,N"],
            "SPECIAL_CLS": ["special", "스페셜석", "(영)스페셜석", "clsSpecialAmt", 10, 1, 'J1', "N", 'N', 'Y', [1, 2, 3, 4, 5, 6, 7, 8], "N,N,N,N"],
            "SWEET_CLS": ["sweet", "스위트석", "(영)스위트석", "clsSweetAmt", 11, 1, 'K1', "N", 'N', 'Y', [1, 2, 3, 4, 5, 6, 7, 8], "N,N,N,N"],
            "COUPLE_CLS": ["couple", "커플석", "(영)커플석", "clsCoupleAmt", 12, 1, 'L1', "N", 'N', 'Y', [2, 4, 6, 8], "N,N,C,N"]
        };
        seat.classCode = {};

        seat.classCode.field = {};
        seat.classCode.field.css = 0;
        seat.classCode.field.nameKr = 1;
        seat.classCode.field.nameUs = 2;
        seat.classCode.field.amtName = 3;
        seat.classCode.field.orderNo = 4;
        seat.classCode.field.seatToCnt = 5;
        seat.classCode.field.crsChoi = 6;
        seat.classCode.field.zoneAdoptAt = 7;
        seat.classCode.field.connExcp = 8;
        seat.classCode.field.deadExcp = 9;
        seat.classCode.field.choiAbleCnt = 10;
        seat.classCode.field.notTicketAbleAt = 11;
        seat.classCode.field.name = (localeCode == 'kr' ? seat.classCode.field.nameKr : seat.classCode.field.nameUs);



        seat.classCode.deadExcp = "";
        seat.classCode.connExcp = "";
        seat.classCode.choiAbleList = [];
        seat.classCode.crsChoiMap = {};
        seat.choiAbleCntArray = {};
        seat.classCode.getCdList = function (index, ynAt) {
            ynAt = ynAt || "Y";
            return $(Object.entries(seat.classCode)).map(function (i, o) { if (o[1][index] == ynAt) { return o[0] } else { return null; } });
        }

        seat.zoneCd = {
            "GERN_ZONE": ["standard", "스탠다드", 0, "Y",],
            "ECON_ZONE": ["economy", "이코노미", 1, "Y",],
            "PRIM_ZONE": ["premium", "프리미엄", 2, "Y",]
        };
        seat.choiZoneMap = {};
        seat.zoneList = [];
        seat.zoneList_init = function () {
            seat.zoneList = [];
            seat.zoneList = $(Object.entries(seat.zoneCd)).sort(function (b, a) { return a[1][2] - b[1][2]; }).map(function (i, o) {
                if (o[1][3] == "Y") {
                    var rtnMap = {};
                    rtnMap.zoneCd = o[0];
                    rtnMap.orderNo = o[1][2];
                    rtnMap.totCount = 0;
                    return rtnMap;
                } else {
                    return null;
                }
            });
        }


        seat.sellTyCode = {
            "GERN_SELL": ["", "판매가능"],
            "SPARE_SELL": ["finish", "예약완료"],
            "STOP_SELL": ["impossible", "선택불가"]
        };


        seat.gateTyCd = {
            "GTL": ["/static/pc/images/reserve/img-door-left.png", "좌측", "(영)좌측"],
            "GTR": ["/static/pc/images/reserve/img-door-right.png", "우측", "(영)우측"],
            "GTU": ["/static/pc/images/reserve/img-door-top.png", "상단측", "(영)상단측"],
            "GTD": ["/static/pc/images/reserve/img-door-bottom.png", "하단측", "(영)하단측"],
            "GTLR": ["/static/pc/images/reserve/img-door-left-right.png", "좌우측", "(영)좌우측"],
            "GTUD": ["/static/pc/images/reserve/img-door-top-bottom.png", "상하단측", "(영)상하단측"],
            _initDoorClass: "mCS_img_loaded"
        };


        seat.init = function () {
            seat.classCode.deadExcp = seat.classCode.getCdList(seat.classCode.field.deadExcp).get().join(":");
            seat.classCode.connExcp = seat.classCode.getCdList(seat.classCode.field.connExcp).get().join(":");
            seat.classCode.choiAbleList = [];
            seat.choiAbleCntArray = {};
            seat.zoneList_init();
            seat.choiZoneMap = {};
        }

        var ticket = {};
        ticket.amtType = "";
        ticket.GERN_ZONE = [2, "zoneGernAmt", 2];
        ticket.ECON_ZONE = [3, "zoneEconAmt", 1];
        ticket.PRIM_ZONE = [4, "zonePrimAmt", 3];
        ticket.grpPayList = [];
        ticket.grpPayList_setTotCount = function () {
            ticket.grpPayList.each(function (i, map) {
                map.totCount = parseInt($("div.number > button[ticketGrpCd='" + map.grpCd + "']").text());
            });
        }

        ticket.payQueue = [];


        ticket.init = function () {
            ticket.payQueue = [];
        }


        var seatInitVal = {
            _initLeft: 110,
            _initTop: 30,
            _width: 20,
            _height: 20,
            _stepWidth: 20,
            _stepHeight: 20,
            _reWidth: 0,
            _colSize: 0,
            _initClass: "jq-tooltip seat-condition"
        };

        var seatInitRowNm = {
            _left: 85,
            _top: 32,
            _stepHeight: seatInitVal._stepHeight
        };


        var seatMapInfo = {
            MAX_PERSON: 8,
            totCount: 0,
            selectedCount: 0,
            selectedMap: {},
            fn_init: function () {
                this.totCount = 0;
                this.selectedCount = 0;
                this.selectedMap = {};
            },
            get activeCount() {
                return this.totCount - this.selectedCount;
            }
        }


        var playTimesDivPopupMsg = "";



        var seatTicketCdPopupMsg = [];


        var movieAdmisClassCd = "";


        var fn_seatPolicy = function (List) {
            var policy = List.SeatPolicyList;
            for (var i = 0; i < policy.length; i++) {
                policyInfo = policy[i];
                if (policyInfo) {
                    //seat.classCode[policyInfo.classCode] = [policyInfo.class,    policyInfo.nameKor,     policyInfo.nameEng,        policyInfo.amtName, policyInfo.orderNo,    policyInfo.seatToCnt,   policyInfo.crsChoi,    policyInfo.zoneAdoptAt, policyInfo.connExcp,    policyInfo.deadExcp,    eval(policyInfo.choiAbleCnt),     policyInfo.notTicketAbleAt];
                    seat.classCode[policyInfo.seatClassCd] = [policyInfo.classVal, policyInfo.seatClassNm, policyInfo.seatClassEngNm, policyInfo.pcNm, policyInfo.sortOrdVal, policyInfo.seatPcntCnt, policyInfo.choiGrpVal, policyInfo.zoneAdoptAt, policyInfo.connExcpVal, policyInfo.choiExcpVal, eval(policyInfo.choiAbleSeatCnt), policyInfo.bnduntChoiAt];
                }
            }
        }

        var fn_seatMapDisplay = function (result) {
            seat.init();
            ticket.init();
            seatMapInfo.fn_init();
            fn_setSeatAmt(result["seatTicketAmtList"], result["seatClassCdList"]);
            fn_ticketDisplay();
            fn_seatDisplaySD01(result["seatListSD01"], result["seatInfoSD01"]);
            fn_seatEvent();
            fn_seatDisplaySD05(result["seatListSD05"]);

            // 임시 안심띄어앉기석 이 존재하면 범례추가를 위해
            var pos = false;
            for (var i = 0; i < result.seatListSD01.length; i++) {
                if (result.seatListSD01[i].seatStatCd == "STOP_SELL") {
                    pos = true;
                    break;
                }
            }

            fn_choiAbleListDisplay(pos);
            fn_myseat();
            fn_choiZoneListDisplay();
            fn_movieDtlInfoDisplay(result["movieDtlInfo"], result["playSeqList"]);
            result.popUp.movieDtlInfo = result["movieDtlInfo"];
            fn_popUp(result.popUp);
        }

        var fn_popUp = function (popUp) {

            if (popUp.playTimesDivPopup != null) {
                msg = localeCode == "en" ? popUp.playTimesDivPopup.popupEngMsg : popUp.playTimesDivPopup.popupKorMsg;
                if (msg != null) {
                    playTimesDivPopupMsg = msg;
                }
            }

            if (popUp.seatClassCdPopUpMap != null) {
                var seatClassPopupList = Object.entries(popUp.seatClassCdPopUpMap).map(function (o, i) { return { seatClassCd: o[0], popupWebKorMsg: localeCode == 'kr' ? o[1].popupWebKorMsg : o[1].popupWebEngMsg }; });
                if (seatClassPopupList.length == 0) {
                    if (!$("div.seat-area").hasClass("has-alert")) $("div.seat-area").removeClass("has-alert");
                } else {
                    if (!$("div.seat-area").hasClass("has-alert")) $("div.seat-area").addClass("has-alert");
                    $("div.seat-layout > div.alert").html("");
                    var alertHtml = "";
                    seatClassPopupList.forEach(function (o) {
                        alertHtml += " <div class='box-alert'> <strong>[알림]</strong>";
                        alertHtml += " <span>" + gfn_charToHtml(o.popupWebKorMsg) + "</span>";
                        alertHtml += " <button type='button' class='btn-close-small'>삭제</button>";
                        alertHtml += " </div>";
                    });
                    $("div.seat-layout > div.alert").html(alertHtml);
                    $("div.seat-layout > div.alert").show();
                }
            }

            if (popUp.seatTicketCdPopupMap != null) {

                Object.entries(popUp.seatTicketCdPopupMap).forEach(function (o, i) {
                    msg = localeCode == "en" ? o[1].popupEngMsg : o[1].popupKorMsg;

                    seatTicketCdPopupMsg.push({ ticketCd: o[1].ticketCd, Msg: msg })
                });

            }

            if (popUp.rfndDivPopup != null) {
                msg = localeCode == "en" ? popUp.rfndDivPopup.popupEngMsg : popUp.rfndDivPopup.popupKorMsg;
                if (msg != null) {
                    var options = {};
                    options.msg = gfn_charToHtml(msg);
                    options.minWidth = 500;
                    options.minHeight = 250;
                    gfn_alertMsgBox(options);
                }
                //$("div.wrap > div.layer-con").children("p").addClass("scroll");
                $("div.wrap > div.layer-con").children("p.txt-common").addClass("scroll");

            }

            if (popUp.movieAdmisClassPopup != null) {
                var alertAgeLayerHtml = "";
                var classNum = popUp.movieDtlInfo.admisClassCd ? ["all", "12", "15", "19", "", ""][["AD01", "AD02", "AD03", "AD04", "AD05", "AD06"].indexOf(popUp.movieDtlInfo.admisClassCd)] : "";
                var classNm = classNum;

                if (classNum != "") {
                    if (classNum == "all") classNm = "All";

                    alertAgeLayerHtml += " <div class='alert-age-layer " + "age" + classNum + "'>";
                    alertAgeLayerHtml += " <div class='age-box " + "age-" + classNum + "'>";
                    alertAgeLayerHtml += " <div class='left'>";
                    alertAgeLayerHtml += " <p class='circle'>" + classNm + "</p>";
                    alertAgeLayerHtml += " </div>";
                    alertAgeLayerHtml += " <div class='right'>";
                    alertAgeLayerHtml += " <p class='tit'>" + popUp.movieDtlInfo.admisClassName + "</p>";
                    alertAgeLayerHtml += " <p class='txt'></p>";
                    alertAgeLayerHtml += " </div>";
                    alertAgeLayerHtml += " </div>";
                    alertAgeLayerHtml += " </div>";
                    $("section#layer_age_alert > div.wrap > div.layer-con").html(alertAgeLayerHtml);
                    $("section#layer_age_alert > div.wrap > div.layer-con > div.alert-age-layer > div.age-box > div.right > p.txt").html($.parseHTML(localeCode == 'kr' ? popUp.movieAdmisClassPopup.popupWebKorMsg : popUp.movieAdmisClassPopup.popupWebEngMsg)[0].textContent);
                    $("section#layer_age_alert").attr("style", "z-index: 900");
                    $modal('layer_age_alert');
                }
            }
        }



        var fn_setSeatAmt = function (seatTicketAmtList, seatClassCdList) {
            var amtName = "";
            ticket.grpPayList = [];
            ticket.grpPayList = $(seatTicketAmtList.map(function (o, i) {
                var rtnMap = {};
                rtnMap.grpCd = o.ticketKindCd;
                rtnMap.ticketOrder = o.ticketOrder;
                rtnMap.grpNm = (localeCode == 'kr' ? o.ticketTypeName : o.ticketTypeNameEng);
                rtnMap.totCount = 0;
                rtnMap[ticket.ECON_ZONE[1]] = o[ticket.ECON_ZONE[1]];
                rtnMap[ticket.GERN_ZONE[1]] = o[ticket.GERN_ZONE[1]];
                rtnMap[ticket.PRIM_ZONE[1]] = o[ticket.PRIM_ZONE[1]];
                seatClassCdList.forEach(function (p, i) {

                    amtName = seat.classCode[p.seatClassCd][seat.classCode.field.amtName];
                    rtnMap[amtName] = o[amtName];
                });
                return rtnMap;
            }));
        }


        var fn_ticketDisplay = function () {
            $("div.seat-count").html("");
            var ticketLayoutHtml = "";
            for (var i = 0; i < ticket.grpPayList.length; i++) {
                var map = ticket.grpPayList[i];
                ticketLayoutHtml += "<div class='cell'>";
                ticketLayoutHtml += "<p class='txt'>" + map.grpNm + "</p>";
                ticketLayoutHtml += "<div class='count'>";
                ticketLayoutHtml += "<button type='button' class='down' title='" + map.grpNm + " 좌석 선택 감소'>-</button>";
                ticketLayoutHtml += "<div class='number'>";
                ticketLayoutHtml += "<button type='button' class='now' title='" + map.grpNm + " 현재 좌석 선택 수' ticketGrpCd='" + map.grpCd + "'>0</button>";
                ticketLayoutHtml += "<ul class='num-choice'>";
                ticketLayoutHtml += $(Array(seatMapInfo.MAX_PERSON + 1)).map(function (i) { return "<li><button type='button' class='btn" + (i == 0 ? " on" : "") + "'>" + i + "</button></li>"; }).get().join(" ")
                ticketLayoutHtml += "</ul>";
                ticketLayoutHtml += "</div>";
                ticketLayoutHtml += "<button type='button' class='up' title='" + map.grpNm + " 좌석 선택 증가'>+</button>";
                ticketLayoutHtml += "</div>";
                ticketLayoutHtml += "</div>";
            }
            $("div.seat-count").html(ticketLayoutHtml);
            fn_ticketEvent();
        }


        var fn_seatDisplaySD01 = function (seatList, info) {
            var cellInfo;
            seatInitVal._colSize = info.colNoMax - info.colNoMin + 1;
            seatInitVal._reWidth = parseInt(($("div#seatLayout").width() - (seatInitVal._colSize * seatInitVal._width)) / 2) - 0;
            seatInitVal._initLeft = seatInitVal._reWidth;
            seatInitRowNm._left = seatInitVal._reWidth - 25;

            var layoutHight = info.rowNoMax * seatInitVal._stepHeight + seatInitVal._initTop + 20;
            //                            + seatInitVal._initTop ;

            var _title = "";
            var _class = "";
            var _left = 0;
            var _top = 0;
            var _width = 0;
            var _attr = "";
            var _stylePosition = "";
            var _stylePositionRowNm = "";
            var sd01Seat = [];
            var choiAblefilterList = [];
            var seatToCnt = 0;
            seatList.forEach(function (cellInfo, i) {
                if (cellInfo) {
                    try {

                        seatToCnt = seat.classCode[cellInfo.seatClassCd][seat.classCode.field.seatToCnt];


                        choiAblefilterList = seat.classCode.choiAbleList.filter(function (o, i) { return o.seatClassCd == cellInfo.seatClassCd; });
                        if (choiAblefilterList.length < 1) {

                            seat.classCode.choiAbleList.push({ seatClassCd: cellInfo.seatClassCd, count: seatToCnt, selectCount: 0, crsChoiGroup: seat.classCode[cellInfo.seatClassCd][seat.classCode.field.crsChoi] });
                        } else {

                            choiAblefilterList[0].count += seatToCnt;
                        }

                        if (seat.choiZoneMap[cellInfo.seatZoneCd]) {
                            seat.choiZoneMap[cellInfo.seatZoneCd].count += seatToCnt;
                        } else {

                            seat.choiZoneMap[cellInfo.seatZoneCd] = {};
                            seat.choiZoneMap[cellInfo.seatZoneCd].count = seatToCnt;
                        }

                        _class = seatInitVal._initClass + " ";
                        _class += seat.zoneCd[cellInfo.seatZoneCd][0] + " ";

                        if (cellInfo.seatStatCd == "GERN_SELL") {
                            _class += seat.classCode[cellInfo.seatClassCd][seat.classCode.field.css];
                        } else if (cellInfo.seatStatCd == "STOP_SELL") {
                            _class += "finish pos";
                        } else {
                            _class += "finish";
                        }
                        _left = seatInitVal._initLeft + (seatInitVal._stepWidth * (cellInfo.horzCoorVal));
                        _top = seatInitVal._initTop + (seatInitVal._stepHeight * (cellInfo.vertCoorVal));
                        _width = seatInitVal._width * parseInt(cellInfo.horzSizeRt);
                        if (seatToCnt > 1) {
                            _width = seatInitVal._width * parseInt(seatToCnt);
                            if (cellInfo.seatChoiGrpSeq > 1) {
                                return true;
                            }
                        }

                        _stylePosition = "' style='position:absolute; left:" + _left + "px; top:" + _top + "px; width:" + _width + "px;' ";

                        _left = seatInitRowNm._left;
                        _top = ((seatInitRowNm._stepHeight * cellInfo.vertCoorVal) + seatInitRowNm._top);
                        _stylePositionRowNm = "' style='position:absolute; left:" + _left + "px; top:" + _top + "px;'";
                        _attr = Object.entries(seat.classCode).filter(function (o, i) { return o[1][seat.classCode.field.seatToCnt] > 1 && o[0] == cellInfo.seatClassCd; }).length > 0 ? seat.classCode[cellInfo.seatClassCd][seat.classCode.field.css] + "_seatGrpNo_" + cellInfo.seatGrpNo : "";
                        _attr = (_attr == "") ? "" : " seatGrpNo=" + _attr;
                        _attr += " seatClassCd='" + cellInfo.seatClassCd + "'";
                        _attr += " seatZoneCd='" + cellInfo.seatZoneCd + "'";
                        _attr += " seatUniqNo='" + cellInfo.seatUniqNo + "'";
                        _attr += " rowNm='" + cellInfo.rowNm + "'";
                        _attr += " seatNo='" + cellInfo.seatNo + "'";
                        _attr += " seatChoiDircVal='" + cellInfo.seatChoiDircVal + "'";
                        _attr += " seatChoiGrpNo='" + cellInfo.seatChoiGrpNo + "'";
                        _attr += " seatChoiGrpNm='" + cellInfo.seatChoiGrpNm + "'";
                        _attr += " seatChoiRowCnt='" + cellInfo.seatChoiRowCnt + "'";
                        _attr += " seatChoiGrpSeq='" + cellInfo.seatChoiGrpSeq + "'";
                        _attr += " seatToCnt='" + seatToCnt + "'";
                        _attr += (cellInfo.seatNotiMsg != "" && cellInfo.seatNotiMsg != null ? " seatNotiMsg='" + cellInfo.seatNotiMsg + "'" : "");


                        _title = cellInfo.rowNm + "" + cellInfo.seatNo + " (" + seat.zoneCd[cellInfo.seatZoneCd][1] + "/" + seat.classCode[cellInfo.seatClassCd][seat.classCode.field.name] + ")";

                        if (!sd01Seat[cellInfo.rowNo]) sd01Seat[cellInfo.rowNo] = " <button type='button' class='btn-seat-row' title='" + cellInfo.rowNm + " 행" + _stylePositionRowNm + ">" + cellInfo.rowNm + "</button>"

                        sd01Seat[cellInfo.rowNo] += "<button type='button' title='" + _title + "' class='" + _class + _stylePosition + _attr + ">";
                        sd01Seat[cellInfo.rowNo] += "<span class='num'>" + cellInfo.seatNo + "</span>";
                        sd01Seat[cellInfo.rowNo] += "<span class='kind'>" + seat.zoneCd[cellInfo.seatZoneCd][1] + "</span>";
                        sd01Seat[cellInfo.rowNo] += "<span class='condition'>" + seat.sellTyCode[cellInfo.seatSellTyCd][1] + "</span>";
                        sd01Seat[cellInfo.rowNo] += "<span class='rank'>" + seat.classCode[cellInfo.seatClassCd][seat.classCode.field.name] + "</span>";
                        sd01Seat[cellInfo.rowNo] += "</button>";
                    } catch (e) {
                        console.log(e);
                    }
                }
            });

            seat.classCode.choiAbleList.sort(function (a, b) {
                return seat.classCode[a.seatClassCd][seat.classCode.field.orderNo] - seat.classCode[b.seatClassCd][seat.classCode.field.orderNo];
            });

            //$("div#seatLayout").css("height" , "600px");
            $("div#seatLayout").css("height", layoutHight + "px");
            $(".seat-select-section .seat-section .seat-area .seat-layout .scroll .mCSB_container").css("height", layoutHight + "px");
            $("div#seatLayout").children().not("[alt='screen']").remove();
            $("div#seatLayout").append("<div class'row'>" + sd01Seat.join(" ") + "</div>");
            $("div#seatLayout").show();

            $('.m-scroll').mCustomScrollbar('update');

        };

        var fn_seatDisplaySD05 = function (list) {
            var cellInfo;
            var _alt = " 출입구";
            var _src = "";
            var _left = 0;
            var _top = 0;
            var _width = 0;
            var stylePosition = "";
            var doorLayoutHtml = "";
            for (var i = 0; i < list.length; i++) {
                cellInfo = list[i];
                if (cellInfo) {
                    _alt = seat.gateTyCd[cellInfo.gateTyCd][1] + _alt;
                    _src = seat.gateTyCd[cellInfo.gateTyCd][0];

                    _left = seatInitVal._initLeft + (seatInitVal._stepWidth * (cellInfo.horzCoorVal + cellInfo.horzPosiRt));
                    _top = seatInitVal._initTop + (seatInitVal._stepHeight * (cellInfo.vertCoorVal + cellInfo.vertPosiRt));
                    _width = seatInitVal._width * parseInt(cellInfo.horzSizeRt);
                    stylePosition = "' style='position:absolute; left:" + _left + "px; top:" + _top + "px; width:16px; height: 16px;'";
                    doorLayoutHtml += " <img src='" + _src + "' alt='" + _alt + stylePosition + "/>";
                }
            }
            $("div#seatLayout").append(doorLayoutHtml);
        };


        var fn_choiAbleListDisplay = function (pos) {
            var choiAbleHtml = "";
            $("div.choice-seat-area div.legend ul.list").html(choiAbleHtml);
            choiAbleHtml += " <li><div class='seat-condition choice'     title='선택한 좌석'></div> <em>선택</em></li>";
            choiAbleHtml += " <li><div class='seat-condition finish'     title='예매 완료'  ></div> <em>예매완료</em></li>";
            choiAbleHtml += " <li><div class='seat-condition impossible' title='선택 불가'  ></div> <em>선택불가</em></li>";
            if (pos) {
                choiAbleHtml += "<li><div class='seat-condition pos' title='띄어앉기석'></div> <em>띄어앉기석</em></li>";
            }
            choiAbleHtml += seat.classCode.choiAbleList.map(function (o, i) { return " <li><div class='seat-condition " + seat.classCode[o.seatClassCd][seat.classCode.field.css] + "' title='" + seat.classCode[o.seatClassCd][seat.classCode.field.name] + "'></div> <em> " + seat.classCode[o.seatClassCd][seat.classCode.field.name] + "</em></li>" }).join(" ");
            $("div.choice-seat-area div.legend ul.list").html(choiAbleHtml);
        }

        var fn_movieDtlInfoDisplay = function (moveInfo, playSeqList) {
            var brchNo = moveInfo.brchNo;
            $('#brchNo').val(brchNo);	//블랙리스트 체크를 위한 파라메타

            var classID = moveInfo.admisClassCd ? ["age-all", "age-12", "age-15", "age-19", "age-no", "age-no"][["AD01", "AD02", "AD03", "AD04", "AD05", "AD06"].indexOf(moveInfo.admisClassCd)] : "age-no";
            var admisClassName, movieNm, playKindName, brchNm, theabNm, movieEventTyName, areaName, playDowNm;

            //전역 변수 (영화관람등급 Setting)
            movieAdmisClassCd = moveInfo.admisClassCd;


            if (localeCode == 'kr') {
                admisClassName = moveInfo.admisClassName;
                movieNm = moveInfo.movieNm;
                childMovieNm = moveInfo.childMovieNm;
                playKindName = moveInfo.playKindName;
                brchNm = moveInfo.brchNm;
                theabNm = moveInfo.theabExpoNm;
                movieEventTyName = moveInfo.movieEventTyName;
                areaName = moveInfo.areaName;
                playDowNm = moveInfo.playDowNm;
            } else {
                admisClassName = moveInfo.admisClassNameEng;
                movieNm = moveInfo.movieNmEng;
                playKindName = moveInfo.playKindNameEng;
                brchNm = moveInfo.brchEngNm;
                theabNm = moveInfo.theabNmEng;
                movieEventTyName = moveInfo.movieEventTyNameEng;
                areaName = moveInfo.areaNameEng;
                playDowNm = moveInfo.playDowNmEng;
            }

            $("div.tit-area  > span.movie-grade").addClass(classID).text(admisClassName);
            $("div.tit-area  > p.tit").html(childMovieNm);
            $("div.tit-area  > p.cate").text((localeCode == 'kr' ? gfn_charToHtml(moveInfo.playKindName) : gfn_charToHtml(moveInfo.playKindNameEng)) + (moveInfo.movieEventTyCd != null ? "/" + movieEventTyName : ""));
            $("div.info-area > p.theater").text(gfn_charToHtml(brchNm));
            $("div.info-area > p.special").text(gfn_charToHtml(theabNm));
            $("div.info-area > p.date").html("<span>" + moveInfo.playDe.maskDate() + "</span>" + "<em>(" + playDowNm + ")</em>");
            $("div.info-area > div.other-time > button.now").html(moveInfo.playStartTime.maskTime() + "~" + moveInfo.playEndTime.maskTime() + "<i class='arr'></i>");
            $("div.info-area > div.other-time > ul.other").html(playSeqList.reduce(function (a, o) {
                a += "<li><button type='button' choiCnt='" + o.choiCnt + "' playSchdlNo='" + o.playSchdlNo + "' class='btn" + (o.playSchdlNo == moveInfo.playSchdlNo ? " on" : "") + " '>" + o.playStartTime.maskTime() + "~" + o.playEndTime.maskTime() + "</button></li>";
                return a;
            }, ""));
            $("div.seat-result p.poster img").attr({ 'src': nvl(moveInfo.imgPath).posterFormat('_150'), 'alt': childMovieNm });

            /*
                for ( var i = 0 ; i < $('.seat-select-section .seat-section .seat-area .seat-count').children().length ; i ++) {
                    var ticketGrpCd     = $(".seat-select-section .seat-section .seat-area .seat-count > div.cell:eq(" + i + ") > div.count > div.number").children("button").attr("ticketGrpCd");
                    var ticketGrpCnt    = parseInt($(".seat-select-section .seat-section .seat-area .seat-count > div.cell:eq(" + i + ") > div.count > div.number").children("button").text());
                    if (movieAdmisClassCd == 'AD04' && (ticketGrpCd=='TKY' || ticketGrpCd=='TKC') ){
                        $(".seat-select-section .seat-section .seat-area .seat-count > div.cell:eq(" + i + ") > div.count").children("button").attr("disabled","disabled");
                        $(".seat-select-section .seat-section .seat-area .seat-count > div.cell:eq(" + i + ") > div.count > div.number").children("button").attr("disabled","disabled");
                    }
                }
            */

            $("div.info-area > div.other-time > ul.other > li > button.btn").unbind("click").bind("click", function () {
                $("#playSchdlNo").val($(this).attr("playSchdlNo"));
                if (parseInt($(this).attr("choiCnt")) < seatMapInfo.totCount) {
                    gfn_alertMsgBox("해당 회차의 잔여 좌석수가 부족합니다.");
                } else {
                    $("div.info-area > div.other-time > ul.other > li > button.btn").removeClass("on");
                    $("div.info-area > div.other-time > button.now").html(" " + $(this).text() + "<i class='arr'></i>");
                    $("div.info-area > div.other-time > button.now > i.arr").click();
                    $(this).addClass("on");
                    fn_search();
                }
            });
        }


        var fn_choiZoneListDisplay = function () {
            var choiZoneHtml = "";
            $("div.zone-legend").hide();
            $("div.zone-legend").html(choiZoneHtml);
            if (Object.entries(seat.choiZoneMap).length <= 1) {
                if (!$("div.seat-area").hasClass("has-zone-legend")) $("div.seat-area").removeClass("has-zone-legend");
                return;
            } else {
                choiZoneHtml += Object.entries(seat.choiZoneMap).sort(function (a, b) { return seat.zoneCd[a[0]][2] - seat.zoneCd[b[0]][2]; }).map(function (o, i) { return "<div class='label " + seat.zoneCd[o[0]][0] + "'>" + seat.zoneCd[o[0]][1] + "</div>" }).join(" ");
                $("div.zone-legend").html(choiZoneHtml);
                if (!$("div.seat-area").hasClass("has-zone-legend")) $("div.seat-area").addClass("has-zone-legend");
                $("div.zone-legend").show();
                $('.m-scroll').mCustomScrollbar('update');
            }
        }


        var fn_seatEvent = function () {

            $('button.seat-condition').unbind('mouseenter focus').bind('mouseenter focus', function () {
                if (seatMapInfo.totCount == 0 || seatMapInfo.activeCount == 0) return false;
                var seatClassCd = $(this).attr("seatClassCd");
                if (typeof (seat.choiAbleCntArray[seatClassCd]) == "undefined") {
                    seat.choiAbleCntArray[seatClassCd] = seat.classCode[seatClassCd][seat.classCode.field.choiAbleCnt];
                }
                var choiAbleCnt = seat.choiAbleCntArray[seatClassCd];

                if (choiAbleCnt.indexOf(seatMapInfo.activeCount) < 0) return false;

                if (!$(this).hasClass('finish') && !$(this).hasClass('impossible')) {
                    $(this).addClass('on');
                    if (seatMapInfo.activeCount > 1) {
                        if ($(this).is("[nextOrd]")) {
                            var nextObj = fn_nextObject($(this));
                            if (nextObj) {
                                nextObj.addClass('on');
                            }
                        }
                    }
                }
            });

            $('button.seat-condition').unbind('mouseleave blur').bind('mouseleave blur', function () {
                if (!$(this).hasClass('choice')) {
                    $(this).removeClass('on');
                    if ($(this).is("[seatNextUniqNo]")) {
                        var nextObj = fn_nextObject($(this), $(this).attr("seatNextUniqNo"));
                        if (nextObj) {
                            nextObj.removeClass('on');
                            nextObj.removeAttr("seatNextUniqNo");
                            $(this).removeAttr("seatNextUniqNo");
                        }
                    }
                }
            });

            $('button.seat-condition').unbind('click').bind('click', 'button.seat-condition', function () {
                var _grpCount = 1;
                var _selectSeatList = [];

                var _seatNo = $(this).attr("seatNo");
                var _rowNm = $(this).attr("rowNm");
                var _seatZoneCd = $(this).attr("seatZoneCd");
                var _seatClassCd = $(this).attr("seatClassCd");
                var _seatUniqNo = $(this).attr("seatUniqNo");
                var _seatToCnt = parseInt($(this).attr("seatToCnt"));
                var _sumTotCnt = 0;
                var _title = "";
                if ($(this).hasClass('choice')) {

                    $(this).removeClass('choice');

                    _title = _rowNm + "" + _seatNo + "(" + seat.zoneCd[_seatZoneCd][1] + "/" + seat.classCode[_seatClassCd][seat.classCode.field.name] + ")";

                    $(this).attr("title", _title).children("span.condition").text("판매가능");
                    /*  */
                    $(this).removeAttr("selected");
                    _selectSeatList = [{ seat: [_rowNm + _seatNo, _seatClassCd, _seatZoneCd, _seatUniqNo, _seatToCnt] }];

                    if ($(this).is("[seatNextUniqNo]")) {
                        var nextObj = fn_nextObject($(this), $(this).attr("seatNextUniqNo"));
                        if (nextObj) {
                            nextObj.removeClass('choice');
                            nextObj.removeAttr("selected");
                            _selectSeatList.push({ seat: [nextObj.attr("rowNm") + nextObj.attr("seatNo"), nextObj.attr("seatClassCd"), nextObj.attr("seatZoneCd"), nextObj.attr("seatUniqNo"), nextObj.attr("seatToCnt")] });
                        }
                    }

                    _sumTotCnt = _selectSeatList.reduce(function (a, o) { return a += Number(o.seat[4]); }, 0);

                    seat.zoneList.filter(function (i, o) { return o.zoneCd == _seatZoneCd; })[0].totCount -= _sumTotCnt;

                    seat.classCode.choiAbleList.filter(function (o) { return o.seatClassCd == _seatClassCd; })[0].selectCount -= _sumTotCnt;

                    //seatMapInfo.selectedCount -= _selectSeatList.length;
                    seatMapInfo.selectedCount -= _sumTotCnt;


                    for (var i = 0; i < _selectSeatList.length; i++) {
                        delete seatMapInfo.selectedMap[_selectSeatList[i].seat[0]];
                    }
                } else {
                    /* 좌석 선택 */
                    // 좌석 선택시 체크 항목
                    // 1. 선택불가및 예매완료 종료
                    if ($(this).hasClass('finish') || $(this).hasClass('impossible')) return false;
                    // 2. 구매가능좌석수가 0 인 경우 종료
                    if (seatMapInfo.totCount == 0) {
                        gfn_alertMsgBox("관람하실 인원을 먼저 선택해주세요.");
                        return false;
                    }
                    // 3. 선택 가능 건수가 0 인 경우 종료
                    if (seatMapInfo.activeCount == 0) {
                        gfn_alertMsgBox("좌석 선택이 완료되었습니다. ");
                        return false;
                    }

                    var _grpCount = 1;
                    // 4. 2인,4인 소파석 일때 초과되는 경우 종료
                    if (seatMapInfo.activeCount < _grpCount) {
                        gfn_alertMsgBox("선택가능한 좌석수가 초과되었습니다. ");
                        return false;
                    }

                    // 99. 선택된 좌석의 메세지가 있을경우 보여 준다.
                    if ($(this).is('[seatNotiMsg]')) {
                        var msg = $(this).attr("seatNotiMsg");
                        gfn_alertMsgBox(msg);
                    }
                    $(this).addClass('choice');
                    _title = _rowNm + "" + _seatNo + "(" + seat.zoneCd[_seatZoneCd][1] + "/" + "선택됨" + ")";
                    $(this).attr("title", _title).children("span.condition").text("선택됨");
                    $(this).attr("selected", "Y");
                    _selectSeatList = [{ seat: [_rowNm + _seatNo, _seatClassCd, _seatZoneCd, _seatUniqNo, _seatToCnt] }];
                    if (seatMapInfo.activeCount > 1) {   // 2건 이상
                        var nextObj = fn_nextObject($(this));
                        if (nextObj) {
                            nextObj.addClass('choice');
                            nextObj.attr("selected", "Y");

                            nextObj.attr("title", nextObj.attr("rowNm") + "" + nextObj.attr("seatNo") + "(" + seat.zoneCd[nextObj.attr("seatZoneCd")][1] + "/" + "선택됨" + ")").children("span.condition").text("선택됨");
                            _selectSeatList.push({ seat: [nextObj.attr("rowNm") + nextObj.attr("seatNo"), nextObj.attr("seatClassCd"), nextObj.attr("seatZoneCd"), nextObj.attr("seatUniqNo"), nextObj.attr("seatToCnt")] });
                        }
                    }

                    _sumTotCnt = _selectSeatList.reduce(function (a, o) { return a += Number(o.seat[4]); }, 0);

                    seat.zoneList.filter(function (i, o) { return o.zoneCd == _seatZoneCd; })[0].totCount += _sumTotCnt;

                    seat.classCode.choiAbleList.filter(function (o) { return o.seatClassCd == _seatClassCd; })[0].selectCount += _sumTotCnt;

                    //seatMapInfo.selectedCount += _selectSeatList.length;
                    seatMapInfo.selectedCount += _sumTotCnt;


                    for (var i = 0; i < _selectSeatList.length; i++) {
                        seatMapInfo.selectedMap[_selectSeatList[i].seat[0]] = [_selectSeatList[i].seat[1], _selectSeatList[i].seat[2], _selectSeatList[i].seat[3], _selectSeatList[i].seat[4], seat.classCode[_seatClassCd][seat.classCode.field.crsChoi]];
                    }
                }

                seat.classCode.crsChoiMap = seat.classCode.choiAbleList.filter(function (o) { return o.seatClassCd == _seatClassCd; })[0];

                fn_reSeatProc();
                fn_seatCountDivCheck();
                fn_myseat();
            });
        };


        var fn_ticketEvent = function () {
            $('.seat-select-section .seat-section .seat-area .seat-count .cell .count .number .now').on('click', function () {
                $(this).closest('.number').find('.num-choice').toggleClass('on');

            });
            $('div.cell > div.count').on('mouseleave blur', function () {
                $(this).find(".num-choice").removeClass('on');
            });


            $("ul.num-choice > li > button").unbind("click").bind("click", function () {
                var value = parseInt($(this).text());
                var _oldValue = parseInt($(this).parents("div.number").children("button").text());
                var curGrpCd = $(this).parents("div.number").children("button").attr("ticketGrpCd");

                //권종 팝업
                if (_oldValue == 0) {
                    for (var i = 0; i < seatTicketCdPopupMsg.length; i++) {
                        map = seatTicketCdPopupMsg[i];
                        if (curGrpCd == map.ticketCd) {
                            /////////////////////////////////////////////
                            ///  전체관람가인 경우 어린이 권종팝업 생략 ///
                            /////////////////////////////////////////////
                            /*
                            console.log("curGrpCd : " + curGrpCd + ", admisClassCd : " + movieAdmisClassCd);
                            */
                            // 어린이 권종 선택은 전체관람가 영화가 아닌경우만 팝업
                            if (((curGrpCd == "TKC") && (movieAdmisClassCd != "AD01")) || (curGrpCd == "TKA") || (curGrpCd == "TKY") || (curGrpCd == "TKS")) {
                                //alert("권종:"+$(this).parent().parent().children("p").text()+", ticketCd:"+map.ticketCd+", Msg:"+map.Msg);
                                var options = {};
                                options.msg = gfn_charToHtml(map.Msg);
                                options.minWidth = 400;
                                options.minHeight = 250;
                                gfn_alertMsgBox(options);
                            }
                        }
                    }
                }


                var rtnVal = fn_ticketCheck(value - _oldValue);
                if (rtnVal == -1) return false;
                if (rtnVal == -2) {
                    $(this).parents("div.number").children("ul").removeClass('on').find("button").removeClass('on');
                    $(this).parents("div.number").children("ul").find("button:contains('" + _oldValue + "')").addClass("on");
                    return false;
                }
                seatMapInfo.totCount += (value - _oldValue);
                $(this).parents("ul.num-choice").find("li > button").removeClass('on');
                $(this).addClass("on");
                $(this).parents("div.number").children("button").text(value);
                $(".seat-count-before").click();
                fn_reSeatProc();

                fn_activeCountAndSeatCntValid(curGrpCd);

                fn_myseat();

            });

            $("div.cell > div.count").children("button.up , button.down ").unbind("click").bind("click", function () {
                var inDe = ($(this).text() == "+") ? 1 : -1;
                var value = parseInt($(this).parent().children("div.number").children("button").text()) + inDe;

                if (value < 0) return false;

                //권종 팝업
                var _oldValue = parseInt($(this).parent().children("div.number").children("button").text());
                var curGrpCd = $(this).parent().children("div.number").children("button").attr("ticketGrpCd");

                if (_oldValue == 0) {
                    for (var i = 0; i < seatTicketCdPopupMsg.length; i++) {
                        map = seatTicketCdPopupMsg[i];
                        if (curGrpCd == map.ticketCd) {
                            /////////////////////////////////////////////
                            ///  전체관람가인 경우 어린이 권종팝업 생략 ///
                            /////////////////////////////////////////////
                            /*
                            console.log("curGrpCd : " + curGrpCd + ", admisClassCd : " + movieAdmisClassCd);
                            */
                            // 어린이 권종 선택은 전체관람가 영화가 아닌경우만 팝업
                            if (((curGrpCd == "TKC") && (movieAdmisClassCd != "AD01")) || (curGrpCd == "TKA") || (curGrpCd == "TKY") || (curGrpCd == "TKS")) {
                                var options = {};
                                options.msg = gfn_charToHtml(map.Msg);
                                options.minWidth = 400;
                                options.minHeight = 250;
                                gfn_alertMsgBox(options);
                            }
                        }
                    }
                }


                if (fn_ticketCheck(inDe) < 0) return false;
                seatMapInfo.totCount += inDe;

                if (value < 0 || value > seatMapInfo.MAX_PERSON) return false;
                $(this).parent().children("div.number").children("button").text(value);
                $(this).parent().children("div.number").children("ul").find("button").removeClass('on');
                $(this).parent().children("div.number").children("ul").find("button:contains('" + value + "')").addClass("on");
                $(".seat-count-before").click();

                fn_reSeatProc();
                fn_activeCountAndSeatCntValid(curGrpCd);;
                fn_myseat();
            });
            $(".seat-count-before").on("click", function () {
                $(".seat-count-before").addClass("off");
            });
        }


        var fn_activeCountAndSeatCntValid = function (grpCd) {
            var grpCdNm = ticket.grpPayList.filter(function (i, o) { return o.grpCd == grpCd; })[0].grpNm;

            var activeSeatCnt = $("button.seat-condition:not(.impossible):not(.finish):not(.choice)").size();

            if (activeSeatCnt < seatMapInfo.activeCount) {
                gfn_alertMsgBox(grpCdNm + "으로 선택가능한 좌석이 존재하지 않아 좌석도를 초기화 합니다.");
                fn_display_init();
                return;
            }
        }


        var fn_ticketCheck = function (inDe) {

            if (seatMapInfo.totCount + (inDe) < seatMapInfo.selectedCount) {
                gfn_confirmMsgBoxSize("선택하신 좌석을 모두 취소하고 다시 선택하시겠습니까?", 400, 200, fn_display_init);
                return -1;
            }

            var checkMap = Object.entries(seat.classCode.choiAbleList.reduce(function (a, o) {
                if (!a[o.crsChoiGroup]) a[o.crsChoiGroup] = {}, a[o.crsChoiGroup].count = o.count, a[o.crsChoiGroup].selectCount = o.selectCount;
                else a[o.crsChoiGroup].count += o.count, a[o.crsChoiGroup].selectCount += o.selectCount; return a;
            }, {}));
            if (checkMap.filter(function (o, i) { return o[1].selectCount > 0 && o[1].selectCount == o[1].count }).length +
                checkMap.filter(function (o, i) { return o[1].selectCount > 0 && o[1].count < seatMapInfo.totCount + (inDe) }).length > 0) {
                gfn_confirmMsgBoxSize("선택하신 좌석을 모두 취소하고 다시 선택하시겠습니까?", 400, 200, fn_display_init);
                return -1;
            }

            if (seatMapInfo.totCount + inDe > seatMapInfo.MAX_PERSON) {
                gfn_alertMsgBox("인원선택은 총 `MAX_PERSON`명까지 가능합니다.".replaceAll("`MAX_PERSON`", seatMapInfo.MAX_PERSON));
                return -2;
            }
            return 0;
        }

        var keyListCaseArray = [];

        var fn_myseat_doPermutation = function (arr, startIdx) {
            var length = arr.length;
            for (var i = startIdx; i < length; i++) {
                var temp = arr[startIdx];
                arr[startIdx] = arr[i];
                arr[i] = temp;
                if (startIdx + 1 == length - 1) {
                    var rArray = arr.slice();
                    keyListCaseArray.push(rArray);
                } else {
                    fn_myseat_doPermutation(arr, startIdx + 1);
                }
                temp = arr[startIdx];
                arr[startIdx] = arr[i];
                arr[i] = temp;
            }
        }

        var fn_keyListCaseArray_reset = function () {
            keyListCaseArray = [];
        }


        var fn_myseat = function () {

            // 권종별 티켓 배열의 각 요소별 선택 권종건수 셋팅(totCount)
            ticket.grpPayList_setTotCount();
            ticket.payQueue = [];

            var zoneCd = "";
            var totCount = 0;
            var pay = 0;
            // 선택된 좌석번호 리스트 (ex: [N17, N15])
            var keyList = Object.keys(seatMapInfo.selectedMap);
            var seatUniqNo = "";
            var seatClassCd = "";
            var seatToCnt = "";
            var zoneList = null;
            var classList = null;
            var gernZoneClassList = null;
            // 정책 리스트에서 zone 적용 여부가 Y인 리스트를 가져온다.
            var zoneAdoptClassList = seat.classCode.getCdList(seat.classCode.field.zoneAdoptAt);

            // 선택된 좌석들중에 존 적용여부가 Y인 좌석이 존재하는지 확인
            var zoneAmtAt = Math.sign(ticket.grpPayList.filter(function (i, o) { return (o[ticket.ECON_ZONE[1]] > 0 || o[ticket.PRIM_ZONE[1]] > 0) }).length);


            keyList.sort(function (a, b) {
                for (var i = 0; i < ticket.grpPayList.length; i++) {
                    var aAmtName = "";
                    var bAmtName = "";
                    if (seatMapInfo.selectedMap[a][1] != "GERN_ZONE") aAmtName = ticket[seatMapInfo.selectedMap[a][1]][1];
                    else aAmtName = seat.classCode[seatMapInfo.selectedMap[a][0]][seat.classCode.field.amtName];

                    if (seatMapInfo.selectedMap[b][1] != "GERN_ZONE") bAmtName = ticket[seatMapInfo.selectedMap[b][1]][1];
                    else bAmtName = seat.classCode[seatMapInfo.selectedMap[b][0]][seat.classCode.field.amtName];

                    if (ticket.grpPayList[i][bAmtName] != ticket.grpPayList[i][aAmtName] || (ticket.grpPayList[i][bAmtName] == ticket.grpPayList[i][aAmtName] && aAmtName == aAmtName)) {
                        return ticket.grpPayList[i][bAmtName] - ticket.grpPayList[i][aAmtName];
                    }
                }
            });
            //    var keyListParam = keyList.slice();
            //console.log("before call" + keyListParam);
            //fn_myseat_doPermutation(keyListParam, 0);
            //console.log("after call" + keyListCaseArray);
            //fn_keyListCaseArray_reset();

            for (var i = 0; i < keyList.length; i++) {
                seatClassCd = seatMapInfo.selectedMap[keyList[i]][0];
                zoneCd = seatMapInfo.selectedMap[keyList[i]][1];
                seatUniqNo = seatMapInfo.selectedMap[keyList[i]][2];
                seatToCnt = seatMapInfo.selectedMap[keyList[i]][3];
                zoneList = $.unique(Object.entries(seatMapInfo.selectedMap).filter(function (o, i) { return o[1][3] > 0 && o[1][1] != "GERN_ZONE"; }).map(function (o, i) { return o[1][1]; }).sort(function (a, b) { return ticket[b][2] - ticket[a][2]; }));
                classList = $.unique(Object.entries(seatMapInfo.selectedMap).filter(function (o, i) { return o[1][3] > 0; }).map(function (o, i) { return o[1][0]; }).sort(function (a, b) { return ticket.grpPayList[0][seat.classCode[a][seat.classCode.field.amtName]] - ticket.grpPayList[0][seat.classCode[b][seat.classCode.field.amtName]] }));
                gernZoneClassList = $.unique(Object.entries(seatMapInfo.selectedMap).filter(function (o, i) { return (o[1][3] > 0 && o[1][1] == "GERN_ZONE"); }).map(function (o, i) { return o[1][0]; }).sort(function (a, b) { return ticket.grpPayList[0][seat.classCode[a][seat.classCode.field.amtName]] - ticket.grpPayList[0][seat.classCode[b][seat.classCode.field.amtName]] }));
                if (gernZoneClassList.length > 0) zoneList = zoneList.concat(gernZoneClassList);
                if (zoneAmtAt > 0) {
                    var payList = ticket.grpPayList.filter(function (i, o) { return o.totCount > 0; }).map(function (i, map) {
                        for (var i = 0; i < zoneList.length; i++) {
                            if (zoneList[i].match("ZONE$")) {
                                map[ticket[zoneList[i]][1] + "List"] = [];
                            } else {
                                map[seat.classCode[zoneList[i]][seat.classCode.field.amtName] + "List"] = [];
                            }


                            for (var j = 0; j < zoneList.length; j++) {
                                var iVal = 0;
                                var jVal = 0;
                                var iAmtName = "";
                                var jAmtName = "";
                                if (zoneList[i].match("ZONE$")) {
                                    iVal = map[ticket[zoneList[i]][1]];
                                    iAmtName = ticket[zoneList[i]][1];
                                }
                                else {
                                    iVal = map[seat.classCode[zoneList[i]][seat.classCode.field.amtName]];
                                    iAmtName = seat.classCode[zoneList[i]][seat.classCode.field.amtName];
                                }
                                if (zoneList[j].match("ZONE$")) {
                                    jVal = map[ticket[zoneList[j]][1]];
                                    jAmtName = ticket[zoneList[j]][1];
                                }
                                else {
                                    jVal = map[seat.classCode[zoneList[j]][seat.classCode.field.amtName]];
                                    jAmtName = seat.classCode[zoneList[j]][seat.classCode.field.amtName];
                                }

                                if (iVal - jVal >= 0) map[iAmtName + "List"].push([jAmtName, map[iAmtName] - map[jAmtName]]);
                            }

                            map[iAmtName + "Sort"] = map[iAmtName + "List"].sort(function (a, b) { return b[1] - a[1]; })[0];
                        }
                        return map;
                    }).get();

                    var amtName = "";
                    if (zoneCd != "GERN_ZONE") amtName = ticket[zoneCd][1];
                    else amtName = seat.classCode[seatClassCd][seat.classCode.field.amtName];
                    if (payList.length > 1) {
                        payList.sort(function (a, b) {

                            if (a[amtName + "Sort"][1] == b[amtName + "Sort"][1]) {
                                if (a[amtName] == b[amtName]) {
                                    // 성인, 청소년, 이런이, 우대 순
                                    return a["ticketOrder"] - b["ticketOrder"];
                                } else {
                                    return b[amtName] - a[amtName];
                                }
                            } else {
                                return a[amtName + "Sort"][1] - b[amtName + "Sort"][1];
                            }
                        });
                    }
                    if (payList.length > 0) {
                        var payMap = payList.shift();
                        if (payMap.totCount > 0) {
                            payMap.totCount--;
                            pay = payMap[amtName];

                            ticket.payQueue.push({ pcGrpDivCd: "MBX", zoneCd: zoneCd, grpCd: payMap.grpCd, grpNm: payMap.grpNm, pay: pay, seatUniqNo: seatUniqNo, seatClassCd: seatClassCd, seatRowNm: keyList[i] });
                        }
                    }
                } else {

                    var payList = ticket.grpPayList.filter(function (i, o) { return o.totCount > 0; }).map(function (i, map) {
                        for (var i = 0; i < classList.length; i++) {

                            map[seat.classCode[classList[i]][seat.classCode.field.amtName] + "List"] = [];
                            for (var j = 0; j < classList.length; j++) {
                                if (map[seat.classCode[classList[i]][seat.classCode.field.amtName]] - map[seat.classCode[classList[j]][seat.classCode.field.amtName]] >= 0) {
                                    map[seat.classCode[classList[i]][seat.classCode.field.amtName] + "List"].push([seat.classCode[classList[j]][seat.classCode.field.amtName], map[seat.classCode[classList[i]][seat.classCode.field.amtName]] - map[seat.classCode[classList[j]][seat.classCode.field.amtName]]]);
                                }
                            }

                            map[seat.classCode[classList[i]][seat.classCode.field.amtName] + "Sort"] = map[seat.classCode[classList[i]][seat.classCode.field.amtName] + "List"].sort(function (a, b) { return b[1] - a[1]; })[0];
                        }
                        return map;
                    }).get();
                    if (payList.length > 1) {
                        payList.sort(function (a, b) {

                            if (a[seat.classCode[seatClassCd][seat.classCode.field.amtName] + "Sort"][1] == b[seat.classCode[seatClassCd][seat.classCode.field.amtName] + "Sort"][1]) {
                                if (a[seat.classCode[seatClassCd][seat.classCode.field.amtName]] == b[seat.classCode[seatClassCd][seat.classCode.field.amtName]]) {
                                    // 성인, 청소년, 이런이, 우대 순
                                    return a["ticketOrder"] - b["ticketOrder"];
                                } else {
                                    return b[seat.classCode[seatClassCd][seat.classCode.field.amtName]] - a[seat.classCode[seatClassCd][seat.classCode.field.amtName]];
                                }
                            } else {
                                return a[seat.classCode[seatClassCd][seat.classCode.field.amtName] + "Sort"][1] - b[seat.classCode[seatClassCd][seat.classCode.field.amtName] + "Sort"][1];
                            }
                        });
                    }

                    if (payList.length > 0) {
                        var payMap = payList.shift();
                        if (payMap.totCount > 0) {
                            var paySeatToCnt = 0;
                            if (seatToCnt > payMap.totCount) {
                                paySeatToCnt = payMap.totCount;
                                payMap.totCount = 0;
                            }
                            else {
                                paySeatToCnt = seatToCnt;
                                payMap.totCount -= seatToCnt;
                            }

                            pay = payMap[seat.classCode[seatClassCd][seat.classCode.field.amtName]];

                            ticket.payQueue.push({ pcGrpDivCd: "MBX", zoneCd: zoneCd, grpCd: payMap.grpCd, grpNm: payMap.grpNm, pay: pay, seatUniqNo: seatUniqNo, seatClassCd: seatClassCd, seatRowNm: keyList[i], paySeatToCnt: paySeatToCnt });
                        }
                    }
                }

                seatMapInfo.selectedMap[keyList[i]][3] = 0;
            }

            ticket.grpPayList_setTotCount();

            keyList.sort(function (a, b) { return (a.substring(0, 1) + a.substring(1).lpad(2, '0')).localeCompare(b.substring(0, 1) + b.substring(1).lpad(2, '0')) });
            $("div.my-seat > div.seat").removeClass("possible").removeClass("choice").addClass("all").text("-").attr("title", "구매가능 좌석");
            $("div.my-seat > div.seat:lt(" + seatMapInfo.totCount + ")").removeClass("all").addClass("possible").attr("title", "선택할 수 있는 좌석");
            for (var i = 0; i < keyList.length; i++) {
                seatMapInfo.selectedMap[keyList[i]][3] = seat.classCode[seatMapInfo.selectedMap[keyList[i]][0]][seat.classCode.field.seatToCnt];
                $("div.my-seat > div.seat:eq(" + i + ")").removeClass("possible").addClass("choice").text(keyList[i]).attr("title", "선택한 좌석");
            }


            var payCountLayoutHtml = "";
            var cntPay = 0;
            var totPay = 0;
            for (var i = 0; i < ticket.grpPayList.length; i++) {
                map = ticket.grpPayList[i];
                cntPay = 0;
                $(ticket.payQueue).each(function (i, o) {
                    if (o.grpCd == map.grpCd) {
                        cntPay += parseInt(o.paySeatToCnt);
                        totPay += parseInt(o.pay);
                    }
                });
                if (cntPay > 0) {
                    payCountLayoutHtml += "<span>" + map.grpNm + " <em>" + cntPay + "</em></span>";
                }
            }

            ticket.payQueue.totalPay = totPay;
            $("div.pay-area > p.count").html(payCountLayoutHtml);
            $("div.pay-area > div.pay > div.money > em").html(totPay.format());


            //if ( seatMapInfo.totCount > 0 && seatMapInfo.activeCount == 0 ){
            if (seatMapInfo.totCount > 0 && seatMapInfo.activeCount <= 0) {

                $("a#pageNext").bind("click", function () {

                    var tkaCnt, tkyCnt, tkcCnt, tksCnt = 0;
                    for (var i = 0; i < $('.seat-select-section .seat-section .seat-area .seat-count').children().length; i++) {
                        var ticketGrpCd = $(".seat-select-section .seat-section .seat-area .seat-count > div.cell:eq(" + i + ") > div.count > div.number").children("button").attr("ticketGrpCd");
                        var ticketGrpCnt = parseInt($(".seat-select-section .seat-section .seat-area .seat-count > div.cell:eq(" + i + ") > div.count > div.number").children("button").text());
                        switch (ticketGrpCd) {
                            case 'TKA': tkaCnt = ticketGrpCnt; break;
                            case 'TKY': tkyCnt = ticketGrpCnt; break;
                            case 'TKC': tkcCnt = ticketGrpCnt; break;
                            case 'TKS': tksCnt = ticketGrpCnt; break;
                        }
                    }

                    if (movieAdmisClassCd != 'AD01' && tkcCnt > 0 && tkaCnt <= 0) {
                        gfn_alertMsgBoxSize(gfn_charToHtml("본 영화는 &#039;12/15세 관람가&#039;로 어린이는 보호자 없이 관람이 불가능하며, &lt;br&gt; 어린이 요금과 성인 요금을 같이 선택하셔야 진행이 가능합니다."), 480, 250);
                        return;
                    }


                    if (playTimesDivPopupMsg != null && playTimesDivPopupMsg != '') {
                        var options = {};
                        options.msg = gfn_charToHtml(playTimesDivPopupMsg);
                        options.confirmFn = setBookingParam;
                        options.cancelFn = '';
                        options.okBtnTxt = "확인";
                        options.cancelBtnTxt = "취소";
                        options.param = { confirm: ticket.payQueue, cancel: "" };
                        options.minWidth = 400;
                        options.minHeight = 250;
                        gfn_confirmMsgBox(options);
                    }
                    else {
                        var payUrl = "/on/oh/ohz/PayBooking/completeSeat.do";
                        //console.log(ticket.payQueue);
                        setBookingParam(ticket.payQueue);
                    }
                    //parent.fn_goNextPagePcntSeatChoi(ticket.payQueue);
                });
                $("a#pageNext").removeClass("disabled").addClass("active");
            } else {
                $("a#pageNext").unbind("click");
                $("a#pageNext").removeClass("active").addClass("disabled");
            }
        }


        //예매 param 세팅
        function setBookingParam(paramList) {
            var paramText = "";
            for (var i = 0; i < paramList.length; i++) {
                if (i > 0) {
                    paramText += ";";
                }
                paramText += paramList[i].seatUniqNo + "," + paramList[i].grpCd + "," + paramList[i].pay;
                paramText += "," + paramList[i].pcGrpDivCd + "," + paramList[i].zoneCd + "," + paramList[i].seatClassCd + "," + paramList[i].paySeatToCnt;
            }

            var options = {};
            options.playSchdlNo = $("#playSchdlNo").val();
            options.brchNo = $("#brchNo").val();
            options.bokdCnt = paramList.length;
            options.seatOccupText = paramText;
            options.totalAmt = paramList.totalPay;

            //parent.fn_setBookingParam(options);
            parent.fn_goNextPagePcntSeatChoi(options);
        }



        var fn_reSeatProc = function () {

            var rowNmArray = $.unique($("button.seat-condition").map(function () { return $(this).attr("rowNm"); }));
            var seatRowArray = null;
            var seatArray = null;
            $("button.seat-condition").removeClass("impossible");

            $.each(rowNmArray, function (i, rowNm) {
                var seatChoiGrpNmArray = $.unique($("button.seat-condition[rowNm='" + rowNm + "']").map(function () { return $(this).attr("seatChoiGrpNm"); }));
                $.each(seatChoiGrpNmArray, function (i, seatChoiGrpNm) {
                    seatRowArray = $("button.seat-condition[rowNm='" + rowNm + "'][seatChoiGrpNm='" + seatChoiGrpNm + "']");

                    var selectorArray = ["choice", "finish"];
                    seatArray = fn_seatGroupSplit(seatRowArray, selectorArray);

                    $.each(seatArray[1], function () { $(this).removeAttr("nextOrd"); });

                    $(seatArray[0]).each(function (n, seat) {
                        var seatLength = seat.length;
                        seat.each(function (i, o) {
                            fn_seatDeadCheck(o, i + 1, seatLength);
                            fn_setConnSeat(o, i + 1, seatLength);
                        });
                    });
                });
            });
        }

        var fn_seatGroupSplit = function (array, selectorArray) {
            var splitSeat = [];
            var splitEtcSeat = [];

            var idxArray = array.map(function (i, o) {
                var rtVal = null;
                for (var selector in selectorArray) {
                    if ($(o).hasClass(selectorArray[selector])) {
                        rtVal = i + 1;
                        break;
                    }
                }
                return rtVal;
            }).add(array.length + 1);

            var idx = 0;
            var idxPrev = 0;
            for (var i = 0; i < idxArray.length; i++) {
                idx = idxArray[i];
                splitSeat.push(array.slice(idxPrev, idx - 1));
                splitEtcSeat.push(array.slice(idx - 1, idx));
                idxPrev = idx;
            }
            return [splitSeat, splitEtcSeat];
        }

        var fn_setConnSeat = function (cell, seatChoiGrpSeq, seatChoiRowCnt) {
            var seatChoiDircVal = parseInt($(cell).attr("seatChoiDircVal"));
            if (seat.classCode.connExcp.indexOf($(cell).attr("seatClassCd")) < 0 && seatChoiRowCnt > 1) {
                if (seatMapInfo.activeCount > 1) {

                    var finishObj;
                    if (seatChoiGrpSeq % 2 == 1) {
                        finishObj = $(cell).next().hasClass("finish");

                        if (finishObj == true) {
                            console.log($(cell).next().attr("rowNm") + $(cell).next().attr("seatNo") + "이미 예약됨");
                            $(cell).attr("nextOrd", "P");
                        } else {
                            $(cell).attr("nextOrd", "N");
                        }
                        //$(cell).attr("nextOrd","N");
                    } else {
                        finishObj = $(cell).prev().hasClass("finish");

                        if (finishObj == true) {
                            console.log($(cell).prev().attr("rowNm") + $(cell).prev().attr("seatNo") + "이미 예약됨");
                            $(cell).attr("nextOrd", "N");
                        } else {
                            $(cell).attr("nextOrd", "P");
                        }
                        //$(cell).attr("nextOrd","P");
                    }

                    if (seatChoiRowCnt == seatChoiGrpSeq && $(cell).attr("nextOrd") == "N") {
                        $(cell).attr("nextOrd", "P");
                    }

                    /////////////////////////////////////////////////////
                    /////////////////////////////////////////////////////
                    /////////////////////////////////////////////////////
                    if (seatChoiGrpSeq == 1 && $(cell).attr("nextOrd") == "P") {
                        $(cell).attr("nextOrd", "N");
                    }
                    /////////////////////////////////////////////////////
                    /////////////////////////////////////////////////////
                    /////////////////////////////////////////////////////

                } else {

                    $(cell).removeAttr("nextOrd");
                }
            }
        }


        var fn_seatDeadCheck = function (cell, seatChoiGrpSeq, seatChoiRowCnt) {

            var seatChoiDircVal = parseInt($(cell).attr("seatChoiDircVal"));
            var seatClassCd = $(cell).attr("seatClassCd");

            var seatCheckFlg = true;
            var seatCrsChoiGrpFlg = true;
            var seatToCnt = $(cell).attr("seatToCnt");
            //if ( $(cell).attr("seatUniqNo")   == '00901401') fn_debugger();


            if (typeof (seat.choiAbleCntArray[seatClassCd]) == "undefined") {
                seat.choiAbleCntArray[seatClassCd] = seat.classCode[seatClassCd][seat.classCode.field.choiAbleCnt];
            }
            var choiAbleCnt = seat.choiAbleCntArray[seatClassCd];

            var isSelectable = true;
            /*if ( choiAbleCnt.indexOf(seatMapInfo.totCount) < 0 && seatMapInfo.totCount > 0) {
                isSelectable = false;
                seatCheckFlg = false;
            }*/

            if (choiAbleCnt.indexOf(seatMapInfo.activeCount) < 0 && (seatMapInfo.activeCount) > 0) {
                isSelectable = false;
                seatCheckFlg = false;
            }


            var crsChoiGroupNm = seat.classCode[seatClassCd][seat.classCode.field.crsChoi];
            var keyList = Object.keys(seatMapInfo.selectedMap);
            if (keyList.length > 0) {
                if (keyList.filter(function (key, i) {
                    return seatMapInfo.selectedMap[key][4] == seat.classCode[seatClassCd][seat.classCode.field.crsChoi];
                }).length <= 0) {
                    isSelectable = false;
                    seatCheckFlg = false;
                }
            }


            if (Object.entries(seat.classCode.choiAbleList.reduce(function (a, o) {
                if (!a[o.crsChoiGroup]) a[o.crsChoiGroup] = {}, a[o.crsChoiGroup].count = o.count, a[o.crsChoiGroup].selectCount = o.selectCount;
                else a[o.crsChoiGroup].count += o.count, a[o.crsChoiGroup].selectCount += o.selectCount;
                return a;
            }, {})).filter(function (o, i) { return o[1].count >= seatMapInfo.totCount && o[0] == crsChoiGroupNm }).length == 0) {
                isSelectable = false;
                seatCheckFlg = false;
            }

            var notTicketAbleAtList = seat.classCode[seatClassCd][seat.classCode.field.notTicketAbleAt].split(",").filter(function (o, i) { return o != 'N'; });
            if (notTicketAbleAtList.length > 0) {
                ticket.grpPayList_setTotCount();
                // 인원수가 올라가있는 권종 리스트 중 해당 셀의 좌석등급에 해당 권종은 앉을수 없다는게 한건이라도 확인되면 비활성화 처리
                if (ticket.grpPayList.filter(function (i, o) { return o.totCount > 0; }).filter(function (i, o) { return notTicketAbleAtList.filter(function (b, j) { return o.grpCd == "TK" + b; }).length > 0; }).length > 0) {
                    isSelectable = false;
                    seatCheckFlg = false;
                }
            }
            if (seatCheckFlg) {
                if (seatMapInfo.activeCount == 1) {
                    isSelectable = false;
                    if (seatChoiDircVal == 0) {
                        if (seatChoiGrpSeq % 2 == 1) {
                            isSelectable = true;
                        }
                    } else {
                        if (seatChoiRowCnt % 2 == 0) {
                            if (seatChoiGrpSeq % 2 == 0) {
                                isSelectable = true;
                            }
                        } else {
                            if (seatChoiGrpSeq % 2 == 1) {
                                isSelectable = true;
                            }
                        }
                    }
                    if (seatChoiRowCnt <= 2) {
                        isSelectable = true;
                    } else {
                        if (seatChoiGrpSeq == 2 || seatChoiGrpSeq == seatChoiRowCnt - 1) {
                            isSelectable = false;
                        }
                        if (seatChoiGrpSeq == 1 || seatChoiGrpSeq == seatChoiRowCnt) {
                            isSelectable = true;
                        }
                    }

                    if (seat.classCode.deadExcp.indexOf($(cell).attr("seatClassCd")) >= 0) {
                        isSelectable = true;
                    }
                }
            }
            if (!isSelectable) {
                /////////////////////////////////////////////
                // TODO 소스원본
                // if( !$(cell).hasClass('finish') ){
                /////////////////////////////////////////////
                if ($(cell).hasClass('finish') == false && $(cell).hasClass('choice') == false) {
                    /*
                    if($(cell).attr("rowNm") == "G"  && $(cell).attr("seatNo") == "16"){
                        alert($(cell).attr("class"));
                        alert("G16 impossible view 추가");
                    }
                    */
                    $(cell).addClass("impossible view");
                }
                $(cell).css("width", 20 * seatToCnt);
            }
        }


        var fn_seatCountDivCheck = function () {

            fn_seatCountDivInit();


            var seatClassCdArray = $.unique($("button.seat-condition:not(.impossible):not(.finish):not(.choice)").map(function () { return $(this).attr("seatclasscd"); }).sort(function (a, b) { return seat.classCode[a][policyInfo.sortOrdVal] - seat.classCode[b][policyInfo.sortOrdVal]; }));
            var nTKACnt = 0, nTKYCnt = 0, nTKCCnt = 0, nTKSCnt = 0;
            for (var i = 0; i < seatClassCdArray.length; i++) {
                var notTicketAbleAtList = seat.classCode[seatClassCdArray[i]][seat.classCode.field.notTicketAbleAt].split(",").filter(function (o, i) { return o != 'N'; });
                for (var j = 0; j < notTicketAbleAtList.length; j++) {
                    if (notTicketAbleAtList[j] == "A") nTKACnt++;
                    else if (notTicketAbleAtList[j] == "Y") nTKYCnt++;
                    else if (notTicketAbleAtList[j] == "C") nTKCCnt++;
                    else if (notTicketAbleAtList[j] == "S") nTKSCnt++;
                }
            }
            ticket.grpPayList.each(function (i, map) {
                if (eval("n" + map.grpCd + "Cnt") == seatClassCdArray.length && Number($("div.seat-count p:contains('" + map.grpNm + "')").siblings("div.count").find("button.now").text()) == 0) {
                    $("div.seat-count p:contains('" + map.grpNm + "')").siblings("div.count").find("button").prop("disabled", true);
                }
            });
        }


        var fn_seatCountDivInit = function () {
            $("div.seat-count").find("button").prop("disabled", false);
        }




        var fn_nextObject = function (obj, seatNextUniqNo) {
            var seatChoiGrpNm = obj.attr("seatChoiGrpNm");
            if (!obj.is("[seatUniqNo]")) {
                return null;
            }
            if (seat.classCode.connExcp.indexOf(obj.attr("seatClassCd")) > -1) {
                return null;
            }

            if (seatNextUniqNo) {
                return $('button.seat-condition[seatUniqNo="' + seatNextUniqNo + '"]');
            }
            var nextOrd = obj.attr("nextOrd");

            var nextObj;
            if (!nextOrd) {
                return null;
            } else if (nextOrd == "N") {
                nextObj = obj.next("[seatChoiGrpNm='" + seatChoiGrpNm + "']");
            } else {
                nextObj = obj.prev("[seatChoiGrpNm='" + seatChoiGrpNm + "']");
            }
            if (nextObj.is(".choice")) {
                return null;
            }
            if (nextObj.is(".finish")) {
                return null;
            }
            obj.attr("seatNextUniqNo", nextObj.attr("seatUniqNo"));
            nextObj.attr("seatNextUniqNo", obj.attr("seatUniqNo"));
            return nextObj;
        }


        var fn_search = function (popYn) {
            if (typeof $("#playSchdlNo").val() == 'undefined' || $("#playSchdlNo").val() == '') {
                return;
            }
            var paramData = {
                playSchdlNo: $("#playSchdlNo").val()
            }
            $.ajaxMegaBox({
                url: "/on/oh/ohz/PcntSeatChoi/selectSeatList.do",
                data: JSON.stringify(paramData),
                success: function (result) {
                    if (result.seatListSD01.length > 0) {
                        if (popYn == 'N') {
                            //popYn 전달시 최초진입 팝업 삭제(결제화면에서 좌석선점 등으로 이동시 팝업띄우지 않음)
                            if (result.popUp.rfndDivPopup != null) {
                                result.popUp.rfndDivPopup = null;
                            }
                            if (result.popUp.movieAdmisClassPopup != null) {
                                result.popUp.movieAdmisClassPopup = null;
                            }
                        }
                        fn_seatPolicy(result.seatPolicyList);

                        fn_seatMapDisplay(result);
                    } else {
                        gfn_alertMsgBox("상영정보가 없습니다.");
                        $("a#pagePrevious").click();
                    }
                },
                complete: function () {
                    parent.$('.bg-loading').hide();
                }
            });
        }


        var fn_display_init = function () {
            $("div.number").children("ul").removeClass('on').find("button").removeClass('on');
            $("div.number").children("ul").find("button:contains('" + 0 + "')").addClass("on");
            $("div.number").children("button").text(0);
            seatMapInfo.fn_init();
            $("button.seat-condition.choice").removeClass("choice on");
            seat.classCode.choiAbleList.forEach(function (o) { o.selectCount = 0; });
            seat.zoneList_init();
            seat.zone
            ticket.init();
            fn_reSeatProc();
            fn_seatCountDivInit();
            fn_myseat();
        }


        function shwoBlackListPopup(param) {
            //gfn_alertMsgBoxSize('원활한 극장 운영을 위하여 개인별 예매 수량 및 예매 가능 지점 수에 대해 부분적인 제한(1일 '+param.bokdAbleBrch+'회, 최대 '+param.bokdAbleCnt+'매까지, 최대 '+param.bokdAbleQty+'개 지점)을 실시하고 있습니다.\n\n또한, 이틀 연속 예매 가능매수를 초과 하실 경우 익일엔 예매가 불가능하오니 참고 부탁드립니다.\n\n단체 관람을 위해 예매 하시는 경우 드림센터 또는 관람 예정 지점 문의를 통해 단체 할인을 받으실 수 있사오니 별도 문의 부탁 드리겠습니다.\n\n고객님의 양해 부탁 드리며 관련 문의는 1544-0070으로 부탁 드립니다.',400,250);	//원활한 극장 운영을 위하여 개인별 예매 수량 및 예매 가능 지점 수에 대해 부분적인 제한(1일 {0}회, 최대 {1}매까지, 최대 {2}개 지점)을 실시하고 있습니다. 또한, 이틀 연속 예매 가능매수를 초과 하실 경우 익일엔 예매가 불가능하오니 참고 부탁드립니다. 단체 관람을 위해 예매 하시는 경우 드림센터 또는 관람 예정 지점 문의를 통해 단체 할인을 받으실 수 있사오니 별도 문의 부탁 드리겠습니다. 고객님의 양해 부탁 드리며 관련 문의는 1544-0070으로 부탁 드립니다.
            gfn_alertMsgBoxSize('원활한 극장 운영을 위하여 개인별 예매 수량 및 예매 가능 지점 수에 대해 부분적인 제한(1일 ' + param.bokdAbleCnt + '회, 최대 ' + param.bokdAbleQty + '매까지, 최대 ' + param.bokdAbleBrch + '개 지점)을 실시하고 있습니다.\n\n또한, 이틀 연속 예매 가능매수를 초과 하실 경우 익일엔 예매가 불가능하오니 참고 부탁드립니다.\n\n단체 관람을 위해 예매 하시는 경우 드림센터 또는 관람 예정 지점 문의를 통해 단체 할인을 받으실 수 있사오니 별도 문의 부탁 드리겠습니다.\n\n고객님의 양해 부탁 드리며 관련 문의는 1544-0070으로 부탁 드립니다.', 400, 250);
            //$modal('layer_member_grade');
        }


        function shwoDataRevisnPopup(arguments, param) {
            var options = {};
            options.msg = '고객님의 생년월일, 전화번호가 정상적으로 등록되지 않았습니다.\n해당정보는 현장에서 예매정보 확인시 필요한 정보이므로 업데이트 바랍니다.\n(' + arguments + ')\n\n예매를 계속 진행하시겠습니까?\n';
            options.confirmFn = parent.fn_mvPage;
            options.cancelFn = parent.fn_vlaidBlackList;
            options.okBtnTxt = "지금변경";
            options.cancelBtnTxt = "계속진행";
            options.minWidth = 400;
            options.minHeight = 300;
            options.param = { confirm: "/on/oh/ohh/Mypage/mainPage.do", cancel: param };
            gfn_confirmMsgBox(options);
        }



        $(function () {

            $("button#seatMemberCntInit").off("click").on("click", function () {
                //$("button#seatMemberCntInit").hide();
                $("button#seatMemberCntInit").attr("disabled", true);
                fn_search('N');
                Timers.call(5, "s", null, function (param) {
                    //$("button#seatMemberCntInit").show();
                    $("button#seatMemberCntInit").attr("disabled", false);
                });
            });

            $("a#pagePrevious").off("click").on("click", function () {
                //window.history.back();
                parent.fn_goPrePagePcntSeatChoi();
            });
            fn_search();
        });
    </script>
    <script src="js/megabox.api.min.js"></script>
    <script src="js/gabox.js"></script>
    <script src="js/megabox.common.min.js"></script>
    <script src="js/booking.js"></script>
    <script src="js/selectPcntSeatChoi.js"></script>
    <script>
        //document.body.scrollIntoView(true);
    
        ////////////////////////////////////////////////////////////////////////////
        /////////////////////////// IFRAME 외부로 호출영역///////////////////////////
        ////////////////////////////////////////////////////////////////////////////
    
        $("#frameBokdMBooking").load(function(){
            if (self != top) {
                var height = $(document).height();
                var allowOrigin = "http://ria.megabox.co.kr";
                window.parent.postMessage(height, allowOrigin);
            }
        });
    
        ////////////////////////////////////////////////////////////////////////////
        ////////////////////////////////////////////////////////////////////////////
        ////////////////////////////////////////////////////////////////////////////
    
    </script>
    <script type="text/javascript">
		(function(w, d, a){
		    w.__beusablerumclient__ = {
		        load : function(src){
		            var b = d.createElement("script");
		            b.src = src; b.async=true; b.type = "text/javascript";
		            d.getElementsByTagName("head")[0].appendChild(b);
		        }
		    };w.__beusablerumclient__.load(a);
		})(window, document, "//rum.beusable.net/script/b200617e104748u388/bc4af2fa1e");
	</script>
</body>

</html>